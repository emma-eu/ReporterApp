{"version":3,"file":"static/js/14095.390a633b.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js","../node_modules/@arcgis/core/views/3d/layers/i3s/I3SUtil.js","../node_modules/@arcgis/core/geometry/projection/projectVectorToVector.js","../node_modules/@arcgis/core/layers/graphics/dehydratedPoint.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Matrix4BindUniform.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DDrawUniform.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Matrix3DrawUniform.js","../node_modules/@arcgis/core/views/3d/webgl-engine/effects/geometry/olidUtils.js","../node_modules/@arcgis/core/geometry/projection/projectPointToVector.js","../node_modules/@arcgis/core/views/webgl/BindType.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Matrix3PassUniform.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3DrawUniform.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js","../node_modules/@arcgis/core/views/webgl/Uniform.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/DoublePrecision.glsl.js","../node_modules/@arcgis/core/views/support/layerViewUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{BindType as r}from\"../../../../webgl/BindType.js\";import{Uniform as s}from\"../../../../webgl/Uniform.js\";class e extends s{constructor(s,e){super(s,\"vec3\",r.Pass,((r,o,t)=>r.setUniform3fv(s,e(o,t))))}}export{e as Float3PassUniform};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../../../request.js\";import{binaryIndexOf as t,splitIntoChunks as r}from\"../../../../core/arrayUtils.js\";import o from\"../../../../core/Error.js\";import has from\"../../../../core/has.js\";import{isInt16Array as n,isInt32Array as s}from\"../../../../core/typedArrayUtil.js\";import{invert as a}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as i}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{i as l,t as c,c as u}from\"../../../../chunks/vec32.js\";import{create as f}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{canProjectWithoutEngine as p}from\"../../../../geometry/projection.js\";import m from\"../../../../geometry/SpatialReference.js\";import{projectVectorToVector as d}from\"../../../../geometry/projection/projectVectorToVector.js\";import{create as y,empty as h,expandPointInPlace as g,intersects as S}from\"../../../../geometry/support/aaBoundingRect.js\";import{a as b}from\"../../../../chunks/sphere.js\";import w from\"../../../../rest/support/Query.js\";import{readBinaryAttribute as I}from\"./I3SBinaryReader.js\";import{computeGlobalTransformation as T}from\"./I3SProjectionUtil.js\";import{createSolidEdgeMaterial as E,createMaterialFromEdges as R}from\"../support/edgeUtils.js\";import{parseColorMixMode as x,ColorMixModeEnum as v}from\"../support/symbolColorUtils.js\";import{Obb as M,compute as j}from\"../../support/orientedBoundingBox.js\";import{spatialReferenceIncompatibleError as C}from\"../../../support/layerViewUtils.js\";function U(e){return e?parseInt(e.slice(e.lastIndexOf(\"/\")+1),10):void 0}function k(e){if(has(\"disable-feature:i3s-draco\")||!e)return!1;for(const t of e)for(const e of t.geometryBuffers)if(\"draco\"===e.compressedAttributes?.encoding)return!0;return!1}function N(e,t,r,o){r.traverse(t,(t=>{const r=t.serviceMbsInIndexSR;return(null!=r&&F(e,r))!==q.OUTSIDE&&(o(t),!0)}))}function D(e,t,r){let o=0,n=0;for(let s=0;s<t.length&&o<e.length;s++)e[o]===t[s]&&(r(s)&&(e[n]=e[o],n++),o++);e.length=n}function W(e,r,o){let n=0,s=0;for(;n<o.length;){t(e,o[n])>=0===r&&(o[s]=o[n],s++),n++}o.length=s}function _(e,t){if(0===t.rotationScale[1]&&0===t.rotationScale[2]&&0===t.rotationScale[3]&&0===t.rotationScale[5]&&0===t.rotationScale[6]&&0===t.rotationScale[7])return O[0]=(e[0]-t.position[0])/t.rotationScale[0],O[1]=(e[1]-t.position[1])/t.rotationScale[4],O[2]=(e[2]-t.position[0])/t.rotationScale[0],O[3]=(e[3]-t.position[1])/t.rotationScale[4],O}const O=y();var q;function F(e,t){const r=t[0],o=t[1],n=t[3],s=e[0]-r,a=r-e[2],i=e[1]-o,l=o-e[3],c=Math.max(s,a,0),u=Math.max(i,l,0),f=c*c+u*u;if(f>n*n)return q.OUTSIDE;if(f>0)return q.INTERSECTS_CENTER_OUTSIDE;return-Math.max(s,a,i,l)>n?q.INSIDE:q.INTERSECTS_CENTER_INSIDE}function L(e,t,r){const o=[],n=r?.missingFields,s=r?.originalFields;for(const a of e){const e=a.toLowerCase();let r=!1;for(const n of t)if(e===n.name.toLowerCase()){o.push(n.name),r=!0,s&&s.push(a);break}!r&&n&&n.push(a)}return o}async function A(e,t,r,n,s,a){if(0===t.length)return[];const i=e.attributeStorageInfo;if(null!=e.associatedLayer)try{return await P(e.associatedLayer,t,r,n,a)}catch(l){if(e.associatedLayer.loaded)throw l}if(i){const l=K(t,r,s);if(null==l)throw new o(\"scenelayer:features-not-loaded\",\"Tried to query attributes for unloaded features\");const c=e.parsedUrl.path;return(await Promise.all(l.map((t=>G(c,i,t.node,t.indices,n,e.apiKey,e.customParameters,a).then((e=>{for(let r=0;r<t.graphics.length;r++){const o=t.graphics[r],n=e[r];if(o.attributes)for(const e in o.attributes)e in n||(n[e]=o.attributes[e]);o.attributes=n}return t.graphics})))))).flat()}throw new o(\"scenelayer:no-attribute-source\",\"This scene layer does not have a source for attributes available\")}function K(e,t,r){const o=new Map,n=[],s=r();for(const a of e){const e=a.attributes[t];for(let t=0;t<s.length;t++){const r=s[t],i=r.featureIds.indexOf(e);if(i>=0){let e=o.get(r.node);e||(e={node:r.node,indices:[],graphics:[]},n.push(e),o.set(r.node,e)),e.indices.push(i),e.graphics.push(a);for(let r=t;r>0;r--)s[r]=s[r-1];s[0]=r;break}}}return n}async function P(e,t,r,o,n){t.sort(((e,t)=>e.attributes[r]-t.attributes[r]));const s=t.map((e=>e.attributes[r])),a=[],i=L(o,e.fields,{originalFields:a}),l=await B(e,s,i,n);for(let c=0;c<t.length;c++){const e=t[c],r=l[c],o={};if(e.attributes)for(const t in e.attributes)o[t]=e.attributes[t];for(let t=0;t<a.length;t++)o[a[t]]=r[i[t]];e.attributes=o}return t}function B(e,t,n,s){const a=e.capabilities.query.maxRecordCount;if(null!=a&&t.length>a){const o=r(t,a);return Promise.all(o.map((t=>B(e,t,n,s)))).then((e=>e.flat()))}const i=new w({objectIds:t,outFields:n,orderByFields:[e.objectIdField]});return e.queryFeatures(i,s).then((e=>{if(e&&e.features&&e.features.length===t.length)return e.features.map((e=>e.attributes));throw new o(\"scenelayer:feature-not-in-associated-layer\",\"Feature not found in associated feature layer\")}))}function G(e,t,r,o,n,s,a,i){return V(e,t,r.resources.attributes,o,n,s,a,i)}async function V(t,r,o,n,s,a,i,l){const c=[];for(const e of r)if(e&&s.includes(e.name)){const r=`${t}/nodes/${o}/attributes/${e.key}/0`;c.push({url:r,storageInfo:e})}const u=await Promise.allSettled(c.map((t=>e(t.url,{responseType:\"array-buffer\",query:{...i,token:a},signal:l?.signal}).then((e=>I(t.storageInfo,e.data)))))),f=[];for(const e of n){const t={};for(let r=0;r<u.length;r++){const o=u[r];if(\"fulfilled\"===o.status){const n=o.value;t[c[r].storageInfo.name]=Q(n,e)}}f.push(t)}return f}!function(e){e[e.OUTSIDE=0]=\"OUTSIDE\",e[e.INTERSECTS_CENTER_OUTSIDE=1]=\"INTERSECTS_CENTER_OUTSIDE\",e[e.INTERSECTS_CENTER_INSIDE=2]=\"INTERSECTS_CENTER_INSIDE\",e[e.INSIDE=3]=\"INSIDE\"}(q||(q={}));const $=-32768,z=-2147483648;function Q(e,t){if(!e)return null;const r=e[t];if(n(e))return r===$?null:r;if(s(e))return r===z?null:r;return r!=r?null:r}function Z(e){const t=e.store,r=t.indexCRS||t.geographicCRS,n=void 0===r?t.indexWKT:void 0;if(n){if(!e.spatialReference)throw new o(\"layerview:no-store-spatial-reference-wkt-index-and-no-layer-spatial-reference\",\"Found indexWKT in the scene layer store but no layer spatial reference\",{});if(n!==e.spatialReference.wkt)throw new o(\"layerview:store-spatial-reference-wkt-index-incompatible\",\"The indexWKT of the scene layer store does not match the WKT of the layer spatial reference\",{})}const s=r?new m(U(r)):e.spatialReference;return s.equals(e.spatialReference)?e.spatialReference:s}function H(e){const t=e.store,r=t.vertexCRS||t.projectedCRS,n=void 0===r?t.vertexWKT:void 0;if(n){if(!e.spatialReference)throw new o(\"layerview:no-store-spatial-reference-wkt-vertex-and-no-layer-spatial-reference\",\"Found vertexWKT in the scene layer store but no layer spatial reference\",{});if(n!==e.spatialReference.wkt)throw new o(\"layerview:store-spatial-reference-wkt-vertex-incompatible\",\"The vertexWKT of the scene layer store does not match the WKT of the layer spatial reference\",{})}const s=r?new m(U(r)):e.spatialReference;return s.equals(e.spatialReference)?e.spatialReference:s}function J(e,t,r){if(!p(e,t))throw C(\"scene layer\",e?.wkid,t?.wkid);if(\"local\"===r&&!Y(e,t))throw C(\"scene layer\",e?.wkid,t?.wkid)}function X(e,t,r){if(e.serviceUpdateTimeStamp?.lastUpdate!==t.serviceUpdateTimeStamp?.lastUpdate||!r.isEmpty||e.associatedLayer?.url!==t.associatedLayer?.url)throw new o(\"layerview:recycle-failed\")}function Y(e,t){return e.equals(t)||e.isWGS84&&t.isWebMercator||e.isWebMercator&&t.isWGS84}function ee(e,t,r){const o=Z(e),n=H(e);J(o,t,r),J(n,t,r)}function te(e){return(null==e.geometryType||\"triangles\"===e.geometryType)&&((null==e.topology||\"PerAttributeArray\"===e.topology)&&null!=e.vertexAttributes?.position)}function re(e){if(null==e.store?.defaultGeometrySchema||!te(e.store.defaultGeometrySchema))throw new o(\"scenelayer:unsupported-geometry-schema\",\"The geometry schema of this scene layer is not supported.\",{url:e.parsedUrl.path})}function oe(e,t){ee(e,t.spatialReference,t.viewingMode)}function ne(e){return null!=e.geometryType&&\"points\"===e.geometryType&&((null==e.topology||\"PerAttributeArray\"===e.topology)&&((null==e.encoding||\"\"===e.encoding||\"lepcc-xyz\"===e.encoding)&&null!=e.vertexAttributes?.position))}function se(e){if(null==e.store?.defaultGeometrySchema||!ne(e.store.defaultGeometrySchema))throw new o(\"pointcloud:unsupported-geometry-schema\",\"The geometry schema of this point cloud scene layer is not supported.\",{})}function ae(e,t){J(e.spatialReference,t.spatialReference,t.viewingMode)}function ie(e){return\"simple\"===e.type||\"class-breaks\"===e.type||\"unique-value\"===e.type}function le(e){return\"mesh-3d\"===e.type}function ce(e){if(null==e||!ie(e))return!0;if((\"unique-value\"===e.type||\"class-breaks\"===e.type)&&null==e.defaultSymbol)return!0;const t=e.symbols;if(0===t.length)return!0;for(const r of t){if(!le(r)||0===r.symbolLayers.length)return!0;for(const e of r.symbolLayers.items)if(\"fill\"!==e.type||null==e.material?.color||\"replace\"!==e.material.colorMixMode)return!0}return!1}const ue=E({color:[0,0,0,0],opacity:0});class fe{constructor(){this.edgeMaterial=null,this.material=null,this.castShadows=!0}}function pe(e){const t=new fe;let r=!1,o=!1;for(const n of e.symbolLayers.items)if(\"fill\"===n.type&&n.enabled){const e=n.material,s=n.edges;if(null!=e&&!r){const o=e.color,s=x(e.colorMixMode);t.material=null!=o?{color:[o.r/255,o.g/255,o.b/255],alpha:o.a,colorMixMode:s}:{color:[1,1,1],alpha:1,colorMixMode:v.Multiply},t.castShadows=n.castShadows,r=!0}null==s||o||(t.edgeMaterial=R(s,{}),o=!0)}return t.material||(t.material={color:[1,1,1],alpha:1,colorMixMode:v.Multiply}),t}function me(e,t){return(0|e)+(0|t)|0}function de(e,t,r,o,n,s,i){if(!s||0===s.length||null==t||!e.serviceMbsInIndexSR)return null;const f=T(e.serviceMbsInIndexSR,n,\"none\",r,t);a(Ee,f);let p=null;const m=()=>{if(!p)if(p=ge,h(be),null!=e.serviceObbInIndexSR){e.serviceObbInIndexSR.transform(we,r,t,n,i),we.getCorners(p);for(const e of p)c(e,e,Ee),g(be,e)}else{const o=e.serviceMbsInIndexSR;if(!o)return;const s=o[3];d(b(o),r,Ie,t),c(Ie,Ie,Ee),Ie[2]+=n;for(let e=0;e<8;++e){const t=1&e?s:-s,r=2&e?s:-s,o=4&e?s:-s,n=p[e];u(n,[Ie[0]+t,Ie[1]+r,Ie[2]+o]),g(be,n)}}};let y=1/0,w=-1/0;const I=e=>{if(\"replace\"!==e.type)return;const r=e.geometry;if(!r?.hasZ)return;h(Se);const n=r.spatialReference||o,s=r.rings.reduce(((e,r)=>r.reduce(((e,r)=>(l(Ie,r[0],r[1],r[2]),d(Ie,n,Ie,t),c(Ie,Ie,Ee),g(Se,Ie),Math.min(Ie[2],e))),e)),1/0);m(),S(be,Se)&&(y=Math.min(y,s),w=Math.max(w,s))};if(s.forEach((e=>I(e))),y===1/0)return null;const E=(e,t,r)=>{c(Ie,r,f),e[t]=Ie[0],e[t+1]=Ie[1],e[t+2]=Ie[2],t+=24,r[2]=y,c(Ie,r,f),e[t]=Ie[0],e[t+1]=Ie[1],e[t+2]=Ie[2],t+=24,r[2]=w,c(Ie,r,f),e[t]=Ie[0],e[t+1]=Ie[1],e[t+2]=Ie[2]};for(let a=0;a<8;++a)E(Te.data,3*a,p[a]);return j(Te)}function ye(e){return e[3]>=0}function he(e){null!=e&&(e[3]=-1)}const ge=[f(),f(),f(),f(),f(),f(),f(),f()],Se=y(),be=y(),we=new M,Ie=f(),Te={data:new Array(72),size:3,exclusive:!0,stride:3},Ee=i();export{q as MbsIntersectResult,fe as SymbolInfo,me as addWraparound,ae as checkPointCloudLayerCompatibleWithView,se as checkPointCloudLayerValid,X as checkRecyclable,oe as checkSceneLayerCompatibleWithView,re as checkSceneLayerValid,J as checkSpatialReference,ee as checkSpatialReferences,de as computeVisibilityObb,k as containsDraco,U as extractWkid,D as filterInPlace,L as findFieldsCaseInsensitive,N as findIntersectingNodes,Q as getCachedAttributeValue,_ as getClipRect,Z as getIndexCrs,pe as getSymbolInfo,H as getVertexCrs,F as intersectBoundingRectWithMbs,he as invalidateMbs,Y as isSupportedLocalModeProjection,ye as isValidMbs,W as objectIdFilter,V as queryAttributesFromCachedAttributesId,ce as rendererNeedsTextures,ue as transparentEdgeMaterial,A as whenGraphicAttributes};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{initializeProjection as r}from\"../projection.js\";import t from\"../SpatialReference.js\";import{projectPointToVector as o}from\"./projectPointToVector.js\";import{makeDehydratedPoint as e}from\"../../layers/graphics/dehydratedPoint.js\";function n(r,t,e,n,i){return!(null==t||null==n||r.length<2)&&(a.x=r[0],a.y=r[1],a.z=r[2],a.spatialReference=t,o(a,e,n,i))}async function i(t,o,e,i,a,c){return await r(o,i,null,c),n(t,o,e,i,a)}const a=e(0,0,0,t.WGS84);export{n as projectVectorToVector,i as projectVectorToVectorAsync};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nfunction e(e,n,t,a){return{x:e,y:n,z:t,hasZ:null!=t,hasM:!1,spatialReference:a,type:\"point\"}}function n(e,n,t,a,l){e.x=n,e.y=t,e.z=a,e.hasZ=null!=a,e.spatialReference=l}export{e as makeDehydratedPoint,n as setDehydratedPoint};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{BindType as r}from\"../../../../webgl/BindType.js\";import{Uniform as o}from\"../../../../webgl/Uniform.js\";class t extends o{constructor(o,t){super(o,\"mat4\",r.Bind,((r,e)=>r.setUniformMatrix4fv(o,t(e))))}}export{t as Matrix4BindUniform};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{BindType as r}from\"../../../../webgl/BindType.js\";import{Uniform as e}from\"../../../../webgl/Uniform.js\";class o extends e{constructor(e,o){super(e,\"sampler2D\",r.Draw,((r,s,t)=>r.bindTexture(e,o(s,t))))}}export{o as Texture2DDrawUniform};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nvar n;function o(o){return o===n.Shadow||o===n.ShadowHighlight||o===n.ShadowExcludeHighlight||o===n.ViewshedShadow}function r(o){return w(o)||o===n.Normal}function t(o){return C(o)||o===n.Normal}function i(o){return o===n.Highlight||o===n.ObjectAndLayerIdColor}function e(n){return h(n)||i(n)}function h(o){return o===n.Color}function u(n){return h(n)||H(n)}function d(o){return h(o)||o===n.ObjectAndLayerIdColor}function l(o){return u(o)||o===n.ObjectAndLayerIdColor}function c(o){return h(o)||o===n.Highlight}function a(n){return c(n)||S(n)}function g(n){return h(n)||i(n)}function f(n){return u(n)||i(n)}function w(n){return g(n)||S(n)}function C(n){return f(n)||S(n)}function S(o){return o===n.Depth}function H(o){return o===n.ColorEmission}!function(n){n[n.Color=0]=\"Color\",n[n.ColorEmission=1]=\"ColorEmission\",n[n.Depth=2]=\"Depth\",n[n.Normal=3]=\"Normal\",n[n.Shadow=4]=\"Shadow\",n[n.ShadowHighlight=5]=\"ShadowHighlight\",n[n.ShadowExcludeHighlight=6]=\"ShadowExcludeHighlight\",n[n.ViewshedShadow=7]=\"ViewshedShadow\",n[n.Highlight=8]=\"Highlight\",n[n.ObjectAndLayerIdColor=9]=\"ObjectAndLayerIdColor\",n[n.COUNT=10]=\"COUNT\"}(n||(n={}));export{n as ShaderOutput,e as is2DGeometryOutput,r as is3DGeometryOutput,t as is3DGeometryOutputMRT,h as isColor,H as isColorEmission,C as isColorEmissionHighlightOIDOrDepth,f as isColorEmissionHighlightOrOID,w as isColorHighlightOIDOrDepth,a as isColorHighlightOrDepth,g as isColorHighlightOrOID,u as isColorOrColorEmission,l as isColorOrColorEmissionOrOID,c as isColorOrHighlight,d as isColorOrOID,S as isDepth,i as isHighlightOrOID,o as isShadowRelatedOutput};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{BindType as r}from\"../../../../webgl/BindType.js\";import{Uniform as o}from\"../../../../webgl/Uniform.js\";class t extends o{constructor(o,t){super(o,\"mat3\",r.Draw,((r,e,s)=>r.setUniformMatrix3fv(o,t(e,s))))}}export{t as Matrix3DrawUniform};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport has from\"../../../../../core/has.js\";function e(){return!!has(\"enable-feature:objectAndLayerId-rendering\")}export{e as olidEnabled};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{create as e}from\"../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{canProjectWithoutEngine as r,tryProjectWithZConversion as t,initializeProjection as o}from\"../projection.js\";import{projectBuffer as n}from\"./projectBuffer.js\";function c(e,o,c,i){if(r(e.spatialReference,c)){f[0]=e.x,f[1]=e.y;const r=e.z;return f[2]=r??i??0,n(f,e.spatialReference,0,o,c,0)}const s=t(e,c);return!!s&&(o[0]=s?.x,o[1]=s?.y,o[2]=s?.z??i??0,!0)}async function i(e,r,t,n,i){return await o(e.spatialReference,t,null,i),c(e,r,t,n)}const f=e();export{c as projectPointToVector,i as projectPointToVectorAsync};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nvar a;!function(a){a[a.Bind=0]=\"Bind\",a[a.Pass=1]=\"Pass\",a[a.Draw=2]=\"Draw\"}(a||(a={}));export{a as BindType};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{BindType as r}from\"../../../../webgl/BindType.js\";import{Uniform as s}from\"../../../../webgl/Uniform.js\";class o extends s{constructor(s,o){super(s,\"mat3\",r.Pass,((r,t,e)=>r.setUniformMatrix3fv(s,o(t,e))))}}export{o as Matrix3PassUniform};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{BindType as r}from\"../../../../webgl/BindType.js\";import{Uniform as e}from\"../../../../webgl/Uniform.js\";class o extends e{constructor(e,o){super(e,\"vec3\",r.Draw,((r,s,t,m)=>r.setUniform3fv(e,o(s,t,m))))}}export{o as Float3DrawUniform};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nfunction n(n,...t){let r=\"\";for(let o=0;o<t.length;o++)r+=n[o]+t[o];return r+=n[n.length-1],r}function t(n,t,r=\"\"){return n?t:r}!function(n){function t(n){return Math.round(n).toString()}function r(n){return n.toPrecision(8)}n.int=t,n.float=r}(n);export{t as If,n as glsl};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport\"../../core/has.js\";import{BindType as s}from\"./BindType.js\";class i{constructor(i,a,e,r,t=null){if(this.name=i,this.type=a,this.arraySize=t,this.bind={[s.Bind]:null,[s.Pass]:null,[s.Draw]:null},r)switch(e){case void 0:break;case s.Bind:this.bind[s.Bind]=r;break;case s.Pass:this.bind[s.Pass]=r;break;case s.Draw:this.bind[s.Draw]=r}}equals(s){return this.type===s.type&&this.name===s.name&&this.arraySize===s.arraySize}}export{i as Uniform};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../../shaderModules/glsl.js\";function c({code:c},i){i.doublePrecisionRequiresObfuscation?c.add(e`vec3 dpPlusFrc(vec3 a, vec3 b) {\nreturn mix(a, a + b, vec3(notEqual(b, vec3(0))));\n}\nvec3 dpMinusFrc(vec3 a, vec3 b) {\nreturn mix(vec3(0), a - b, vec3(notEqual(a, b)));\n}\nvec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\nvec3 t1 = dpPlusFrc(hiA, hiB);\nvec3 e = dpMinusFrc(t1, hiA);\nvec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\nreturn t1 + t2;\n}`):c.add(e`vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\nvec3 t1 = hiA + hiB;\nvec3 e = t1 - hiA;\nvec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\nreturn t1 + t2;\n}`)}export{c as DoublePrecision};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";function n(e){return e&&\"function\"==typeof e.highlight}function t(e){return e&&\"function\"==typeof e.maskOccludee}function i(e,n,t){return null==e||e>=t&&(0===n||e<=n)}function r(e,n){if(n&&e){const{minScale:t,maxScale:r}=e;if(c(t,r))return i(n,t,r)}return!0}function c(e,n){return null!=e&&e>0||null!=n&&n>0}function u(e){return!e?.minScale||!e.maxScale||e.minScale>=e.maxScale}function o(e){return null!=e&&\"object\"==typeof e&&\"createQuery\"in e&&\"queryFeatures\"in e&&\"layer\"in e&&\"view\"in e}function l(n,t,i){return new e(\"layerview:spatial-reference-incompatible\",`The spatial reference of this ${n}${t?`(wkid:${t})`:\"\"} is incompatible with the spatial reference of the view${i?`(wkid:${i})`:\"\"}.`,{})}export{n as highlightsSupported,r as isInEffectiveScaleRange,c as isScaleRangeActive,o as isSelectableLayerView2D,t as occludeesSupported,i as scaleBoundsPredicate,l as spatialReferenceIncompatibleError,u as validateScaleRange};\n"],"names":["e","s","constructor","super","r","Pass","o","t","setUniform3fv","y","q","async","V","n","a","i","l","c","includes","name","key","push","url","storageInfo","u","Promise","allSettled","map","responseType","query","token","signal","then","I","data","f","length","status","value","Q","OUTSIDE","INTERSECTS_CENTER_OUTSIDE","INTERSECTS_CENTER_INSIDE","INSIDE","$","z","E","color","opacity","he","M","Array","x","spatialReference","WGS84","hasZ","hasM","type","Bind","setUniformMatrix4fv","Draw","bindTexture","Shadow","ShadowHighlight","ShadowExcludeHighlight","ViewshedShadow","g","S","w","Normal","C","Highlight","ObjectAndLayerIdColor","h","Color","H","d","Depth","ColorEmission","COUNT","setUniformMatrix3fv","has","m","arguments","undefined","int","Math","round","toString","float","toPrecision","this","arraySize","bind","equals","_ref","code","doublePrecisionRequiresObfuscation","add","highlight","minScale","maxScale"],"sourceRoot":""}