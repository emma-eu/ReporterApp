"use strict";(self.webpackChunkfeedback_map=self.webpackChunkfeedback_map||[]).push([[59453,79057],{1322:(e,t,i)=>{i.r(t),i.d(t,{default:()=>lr});var n=i(35143),o=i(46053),s=i(81806),a=i(76460),r=(i(47249),i(85842)),l=i(16036),h=i(94643),c=i(73763),d=i(50076),p=i(30726),u=i(68134),g=i(16783),m=i(21403),f=i(40565),_=i(65215),y=i(9624),v=i(88235),w=i(11373);const M={widthBreakpoint:{getValue(e){const t=e.viewSize[0],i=e.breakpoints,n=this.values;return t<=i.xsmall?n.xsmall:t<=i.small?n.small:t<=i.medium?n.medium:t<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const t=e.viewSize[1],i=e.breakpoints,n=this.values;return t<=i.xsmall?n.xsmall:t<=i.small?n.small:t<=i.medium?n.medium:t<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const t=e.viewSize,i=t[0],n=t[1],o=this.values;return n>=i?o.portrait:o.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},b={xsmall:544,small:768,medium:992,large:1200};function x(e,t){return t?M[e].valueToClassName[t].split(" "):[]}const T=e=>{let t=class extends e{constructor(){super(...arguments),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=b}initialize(){this.addHandles((0,u.wB)((()=>[this.breakpoints,this.size]),(()=>this._updateClassNames()),u.Vh))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(e){if(e!==this._get("breakpoints")){if(!function(e){const t=e;return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}(e)){const t=JSON.stringify(b,null,2);console.warn("provided breakpoints are not valid, using defaults:"+t),e=b}this._set("breakpoints",{...e})}}_updateClassNames(){if(!this.container)return;const e=w.A.acquire(),t=w.A.acquire();let i,n=!1;for(i in M){const o=this[i],s=M[i].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==s&&(n=!0,this[i]=s,x(i,o).forEach((e=>t.push(e))),x(i,s).forEach((t=>e.push(t))))}n&&(this._applyClassNameChanges(e,t),w.A.release(e),w.A.release(t))}_applyClassNameChanges(e,t){const i=this.container;i&&(t.forEach((e=>i.classList.remove(e))),e.forEach((e=>i.classList.add(e))))}_removeActiveClassNames(){const e=this.container;if(!e)return;let t;for(t in M)x(t,this[t]).forEach((t=>e.classList.remove(t)))}};return(0,n._)([(0,o.MZ)()],t.prototype,"breakpoints",null),(0,n._)([(0,o.MZ)()],t.prototype,"orientation",void 0),(0,n._)([(0,o.MZ)()],t.prototype,"widthBreakpoint",void 0),(0,n._)([(0,o.MZ)()],t.prototype,"heightBreakpoint",void 0),t=(0,n._)([(0,r.$)("esri.views.BreakpointsOwner")],t),t};var S=i(30113),A=i(79053),k=i(54901),P=i(52394),Z=i(91967),C=i(19451),R=(i(27347),i(48396));let E=class extends Z.A{constructor(){super(...arguments),this.items=new h.A,this._watchUpdatingTracking=new C.U,this._callbacks=new Map,this._projector=(0,R.F)(),this._hiddenProjector=(0,R.F)()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((()=>this.items),(e=>{for(const t of e.added){const e=()=>t.render();this._callbacks.set(t,e),this._projector.append(this.surface,e)}for(const t of e.removed){const e=this._projector.detach(this._callbacks.get(t));this.surface.removeChild(e.domNode),this._callbacks.delete(t)}}))}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach((e=>this._projector.detach(e))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,i=this._hiddenProjector;let n;const o=()=>(n=e.render(),n);i.append(t,o),i.renderNow();const s={left:0,top:0,right:0,bottom:0};if(n?.domNode){const e=n.domNode.getBoundingClientRect();s.left=e.left,s.top=e.top,s.right=e.right,s.bottom=e.bottom}for(i.detach(o);t.firstChild;)t.removeChild(t.firstChild);return s}overlaps(e,t){const i=this.computeBoundingRect(e),n=this.computeBoundingRect(t);return Math.max(i.left,n.left)<=Math.min(i.right,n.right)&&Math.max(i.top,n.top)<=Math.min(i.bottom,n.bottom)}get hasVisibleItems(){return this.items.some((e=>e.visible))}async prepare(){await document.fonts.load(this._fontString()).catch((()=>{}))}renderCanvas(e,t){const i=!!t?.disableDecorations;if(!this.items.some((e=>e.visible&&!(i&&e.isDecoration))))return;const n=e.getContext("2d");n.save(),n.font=this._fontString(),this.items.forEach((e=>{i&&e.isDecoration||(n.save(),e.renderCanvas(n),n.restore())})),n.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};(0,n._)([(0,o.MZ)({readOnly:!0})],E.prototype,"surface",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],E.prototype,"items",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],E.prototype,"needsRender",null),(0,n._)([(0,o.MZ)({readOnly:!0})],E.prototype,"_watchUpdatingTracking",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],E.prototype,"updating",null),E=(0,n._)([(0,r.$)("esri.views.overlay.ViewOverlay")],E);const I=E,V=[0,0];function D(e){const t=(e.ownerDocument||window.document).defaultView,i=e.getBoundingClientRect();return V[0]=i.left+(t?.pageXOffset??0),V[1]=i.top+(t?.pageYOffset??0),V}function L(e){e&&(e.textContent="",e.parentNode&&e.parentNode.removeChild(e))}const O=16,z=750,F=e=>{let t=class extends e{constructor(){super(...arguments),this._freqInfo={freq:O,time:z},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([(0,u.wB)((()=>this.cursor),(e=>{const{surface:t}=this;t&&t.setAttribute("data-cursor",e)})),(0,u.wB)((()=>this.navigating),(e=>{const{surface:t}=this;t&&t.setAttribute("data-navigating",e.toString())}))])}initialize(){this.addHandles([(0,u.wB)((()=>this.ui),((e,t)=>this._handleUIChange(e,t)),u.Vh),this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(e){const t=this._get("container"),i=(0,S.$)(e);if(i||"string"!=typeof e||a.A.getLogger(this).error("#container",`element with id '${e}' not found`),t===i)return;if(this._stopMeasuring(),t&&(t.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(L(this.root),this._set("root",null)),this.userContent&&((0,S.y)(this.userContent,t),L(this.userContent),this._set("userContent",null))),!i)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);i.classList.add("esri-view");const n=document.createElement("div");n.className="esri-view-user-storage",(0,S.y)(i,n),i.appendChild(n),this._set("userContent",n);const o=document.createElement("div");o.className="esri-view-root",i.insertBefore(o,i.firstChild),this._set("root",o);const s=document.createElement("div");s.className="esri-view-surface",s.setAttribute("role","application"),s.tabIndex=0,o.appendChild(s),this._set("surface",s);const r=new I;o.appendChild(r.surface),this._set("overlay",r),this.addHandles((0,u.wB)((()=>r.needsRender),(e=>{e&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=(0,P.mg)({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=(0,p.xt)(this._overlayRenderTaskHandle)}))),this.forceDOMReadyCycle(),this._set("container",i),this._startMeasuring()}get focused(){const e=document.activeElement===this.surface;return document.hasFocus()&&e}get size(){return[this.width,this.height]}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(e,t,i){const n=this.position;return e-=n?n[0]:0,t-=n?n[1]:0,i?(i[0]=e,i[1]=t):i=[e,t],i}containerToPage(e,t,i){const n=this.position;return e+=n?n[0]:0,t+=n?n[1]:0,i?(i[0]=e,i[1]=t):i=[e,t],i}_handleUIChange(e,t){this.removeHandles("ui"),t&&t!==e&&t.destroy(),e&&(e.view=this,this.addHandles((0,u.wB)((()=>this.root),(t=>{e.container=t?function(e){const t=document.createElement("div");return e.appendChild(t),t}(t):null}),u.Vh),"ui")),this._set("ui",e)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const e=this._freqInfo;e.freq=O,e.time=z;const t=(0,P.mg)({prepare:e=>{const i=this._measure(),n=this._freqInfo;if(n.time+=e.deltaTime,i&&(n.freq=O,this._get("resizing")||this._set("resizing",!0)),n.time<n.freq)return;n.time=0;const o=this._position();n.freq=o||i?O:Math.min(z,2*n.freq),!i&&n.freq>=512&&(t.pause(),this._get("resizing")&&this._set("resizing",!1))}}),i=new ResizeObserver((i=>{e.freq=O,e.time=z,t.resume()}));null!=this.container&&i.observe(this.container);const n=(0,k.hA)((()=>i.disconnect()));this.addHandles([(0,A.on)(window,"resize",(()=>{e.freq=O,e.time=z,t.resume()})),n,t],"measuring"),this._measure(),this._position()}_measure(){const e=this.container,t=e?e.clientWidth:0,i=e?e.clientHeight:0;if(0===t||0===i)return this.suspended||this._set("suspended",!0),!1;const n=this.width,o=this.height;return t===n&&i===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",i),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:n,oldHeight:o,width:t,height:i}),!0)}_position(){const e=this.container,t=this.position,i=e&&D(e);return!!i&&(!t||i[0]!==t[0]||i[1]!==t[1])&&(this._set("position",[i[0],i[1]]),!0)}forceDOMReadyCycle(){}};return(0,n._)([(0,o.MZ)()],t.prototype,"container",null),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"focused",null),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"height",void 0),(0,n._)([(0,o.MZ)()],t.prototype,"messagesCommon",void 0),(0,n._)([(0,o.MZ)({type:I})],t.prototype,"overlay",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"position",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"resizing",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"root",void 0),(0,n._)([(0,o.MZ)({value:null,readOnly:!0})],t.prototype,"size",null),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"surface",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"suspended",void 0),(0,n._)([(0,o.MZ)({nonNullable:!0})],t.prototype,"ui",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"userContent",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"width",void 0),(0,n._)([(0,o.MZ)()],t.prototype,"widthBreakpoint",void 0),t=(0,n._)([(0,r.$)("esri.views.DOMContainer")],t),t};var N=i(98773),H=i(50346),G=i(57308);function W(e){return null!=e&&"open"in e&&"declaredClass"in e}function U(e){return null!=e&&"declaredClass"in e&&"dockOptions"in e}const B=e=>{let t=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([(0,u.wB)((()=>[this.ui,this.popup]),((e,t)=>{let[i,n]=e;const o="popup";if(t){const[e,i]=t;e&&W(i)&&(i.view=null,U(i)&&e.remove(i,o))}i&&W(n)&&(n.view=this,U(n)&&i.add(n,{key:o,position:"manual",internal:!0}))}),u.Vh),this.on("click",(e=>{this.popup&&this.popupEnabled&&("mouse"!==e.pointerType||0===e.button)&&(W(this.popup)?this.popup.viewModel.handleViewClick(e):e.async((async()=>{await this.setupPopup(),W(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(e)})))}),G.o.WIDGET)]),(0,u.C_)((()=>this.ready&&this.popupEnabled&&!this.updating)).then((()=>{Promise.all([i.e(7847),i.e(97763),i.e(37375),i.e(79788),i.e(35039),i.e(49176),i.e(73347),i.e(98733),i.e(5027),i.e(3561),i.e(2236),i.e(38451),i.e(89122),i.e(9912),i.e(47951),i.e(88688),i.e(88869),i.e(92210)]).then(i.bind(i,92210))}))}destroy(){this.destroyed||this.closePopup()}async openPopup(e){if(W(this.popup))return this.popup.open(e);try{if(await this.setupPopup(),!this.popup)return void a.A.getLogger(this).error(new d.A("view:null-popup","Popup is null and can't be opened"));this.popup.open(e)}catch{}}closePopup(){this._popupSetupTask?.abort(),W(this.popup)&&this.popup.close()}async fetchPopupFeatures(e,t){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(e,t),t)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!W(this.popup))return this._popupSetupTask=(0,N.UT)((async e=>{const{default:t}=await Promise.all([i.e(7847),i.e(97763),i.e(37375),i.e(79788),i.e(35039),i.e(49176),i.e(73347),i.e(98733),i.e(5027),i.e(3561),i.e(2236),i.e(38451),i.e(89122),i.e(9912),i.e(47951),i.e(88688),i.e(88869),i.e(92210)]).then(i.bind(i,92210));if((0,H.Te)(e),!this.popup||W(this.popup))return;const n=this.popup;delete n.open,delete n.close,this.popup=new t(n)})),this._popupSetupTask.promise}async _popupHitsToFeatures(e,t){let{location:i,hits:n}=e;const o=[],a=[];let r=!1;const l=(0,H.YL)(t,(0,s.A)("popup-view-fetch-timeout")??$),h=e=>{const t=a.at(-1);return t&&t.layerView===e&&!r?t:(e=>{const t=new q(e);return a.push(t),o.push(t.promise),t})(e)};for(const s of n)"graphic"in s?(h(s.layerView).graphics.push(s.graphic),r=!1):(o.push(s.layerView.fetchPopupFeaturesAtLocation(s.mapPoint,l)),r=!0);a.map((e=>e.resolve(l)));const c=(0,H.nA)(o).then((e=>e.filter((e=>!!e)).flat()));return{pendingFeatures:o,allGraphicsPromise:c,location:i}}async _getPopupHits(e,t){const{hits:i,location:n}=await this.popupHitTest(e);(0,H.Te)(t);const o=[];for(const s of i)if("graphic"in s){if(this._isValidPopupGraphic(s.graphic,t)){const e=this._isValidPopupGraphicsLayerView(s.layerView)?s.layerView:void 0;o.push({graphic:s.graphic,layerView:e})}}else this._isValidPopupLocationLayerView(s.layerView)&&o.push({mapPoint:s.mapPoint,layerView:s.layerView});return{hits:o,location:n}}_isValidPopupGraphic(e,t){return e&&!!e.getEffectivePopupTemplate(t?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(e){return!e||(!("layer"in e)||!e.suspended)&&"fetchPopupFeaturesFromGraphics"in e}_isValidPopupLocationLayerView(e){return(!("layer"in e)||!e.suspended)&&"fetchPopupFeaturesAtLocation"in e}};return(0,n._)([(0,o.MZ)()],t.prototype,"popup",void 0),(0,n._)([(0,o.MZ)()],t.prototype,"popupEnabled",void 0),t=(0,n._)([(0,r.$)("esri.views.PopupView")],t),t};class q{constructor(e){this.layerView=e,this._resolver=(0,H.Tw)(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:t,graphics:i,_resolver:n}=this;if(!t)return n.resolve(i),n.promise;let o;return t.fetchPopupFeaturesFromGraphics(i,e).catch((e=>(o=e,null))).then((e=>{e?n.resolve(e):n.reject(o)})),n.promise}}const $=5e3;var j=i(32809),K=i(3975),X=i(54099),Y=i(88321),J=i(49304),Q=i(91291),ee=i(5364),te=i(76797),ie=i(91605),ne=i(13312),oe=i(80963);let se=class extends ee.X{constructor(e){super(e),this.addHandles(this.on("before-add",(e=>{null!=e.item&&e.item.parent===this.owner&&(a.A.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),e.preventDefault())})))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};se=(0,n._)([(0,r.$)("esri.support.AnalysesCollection")],se);var ae=i(64519),re=i(36693),le=i(59187),he=i(67478);let ce=class extends Z.A{constructor(e){super(e),this.view=null,this.baseLayerViews=new h.A,this.referenceLayerViews=new h.A,this._loadingHandle=(0,u.wB)((()=>this.view?.map?.basemap),(e=>{e&&e.load().catch((()=>{}))}),u.Vh)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return this.view?.suspended??!0}get updating(){if(this.view?.suspended)return!1;const e=this.view?.map?.basemap;return!!e?.loaded&&(this.baseLayerViews.some((e=>e.updating))||this.referenceLayerViews.some((e=>e.updating)))}};(0,n._)([(0,o.MZ)({constructOnly:!0})],ce.prototype,"view",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],ce.prototype,"baseLayerViews",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],ce.prototype,"referenceLayerViews",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],ce.prototype,"suspended",null),(0,n._)([(0,o.MZ)({type:Boolean,readOnly:!0})],ce.prototype,"updating",null),ce=(0,n._)([(0,r.$)("esri.views.BasemapView")],ce);const de=ce;var pe=i(87663),ue=i(17879),ge=i(25515),me=i(10425);function fe(e){return null!=e&&"object"==typeof e&&"layerViews"in e}class _e{constructor(e,t,i){this.layer=e,this.view=t,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=(0,H.Tw)(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,(0,H.u7)(this._controller.signal,(()=>{const t=new d.A("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(t)}))}tryRecycle(e){if(!this.done||!this.layerView||!function(e){return"tryRecycleWith"in e}(this.layerView))return null;const t=this.layer.type,i=this._controller.signal;for(let n=0;n<e.length;n++){const o=e[n];if(o.type!==t)continue;const s=this.layerView.tryRecycleWith(o,{signal:i});if(s){e.splice(n,1),this.layer=o;const t=this.layerView,i=t.view;return this.promise=Promise.race([s.then((()=>((0,H.Te)(this._controller.signal),o.emit("layerview-destroy",{view:i,layerView:t}),i.emit("layerview-destroy",{view:i,layerView:t}),o.emit("layerview-create",{view:i,layerView:t}),i.emit("layerview-create",{view:i,layerView:t}),t))),new Promise(((e,t)=>(0,H.u7)(this._controller.signal,(()=>t((0,H.NK)())))))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:t,view:i}=this;t.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:t,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:t,view:i}=this;this._map=i.map;try{let n,o;if(await t.load({signal:e}),t.prefetchResources&&await t.prefetchResources({signal:e}),function(e){return e.createLayerView!==ge.A.prototype.createLayerView}(t))n=await t.createLayerView(i,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(t))throw new d.A("layer:view-not-supported","No layerview implementation was found");const o=await this.layerViewImporter.importLayerView(t);(0,H.Te)(e),n="default"in o?new o.default({layer:t,view:i}):new o({layer:t,view:i})}const s=()=>{o=(0,p.xt)(o),n.destroyed||n.destroy(),n.layer=null,n.parent=null,n.view=null,this.done=!0};o=(0,H.u7)(e,s),(0,H.Te)(e);try{await n.when()}catch(Ue){throw s(),Ue}const a=this._map?.allLayers?.includes(t);if(!a)return s(),void this._deferred.reject(new d.A("view:no-layerview-for-layer","The layer has been removed from the map",{layer:t}));this.layerView=n,t.emit("layerview-create",{view:i,layerView:n}),i.emit("layerview-create",{layer:t,layerView:n}),this.done=!0,this._deferred.resolve(n)}catch(Ue){t.emit("layerview-create-error",{view:i,error:Ue}),i.emit("layerview-create-error",{layer:t,error:Ue}),this.done=!0,this._deferred.reject(new d.A("layerview:create-error","layerview creation failed",{layer:t,error:Ue}))}}}let ye=class extends Z.A{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new C.U,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const e=this.view.map?.allLayers;if(e)for(const t of e)this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t)},this._reschedule=()=>this.destroyed?Promise.reject():(null==this._workPromise&&(this._workPromise=(0,H.Tw)(),this._workPromise.promise.catch((()=>{}))),this.removeHandles("reschedule"),this.addHandles((0,P._)(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;const e=this.view.map;if(this._map!==e&&(this.clear(),this._map=e),null==this._workPromise)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const t=new Set,i=[],n=this.view.ready,o=e=>{if(null!=e)for(const s of e)if(s){t.add(s);const e=this._layerLayerViewInfoMap.get(s);e&&n?e.start():e||this._recyclingInfoMap.has(s)||i.push(s),"layers"in s&&s.layers&&o(s.layers)}};for(const a of this._rootCollectionNames)o((0,ue.Jt)(this,a));for(const[a,r]of this._layerLayerViewInfoMap)if(!t.has(a)){this._layerLayerViewInfoMap.delete(r.layer);const e=r.tryRecycle(i);e?(this.notifyChange("updating"),this._recyclingInfoMap.set(r.layer,r),e.then((()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(r.layer),this._layerLayerViewInfoMap.set(r.layer,r),this._reschedule()})).catch((()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(r.layer),r.destroy(),this._reschedule()}))):r.destroy()}for(const[a,r]of this._recyclingInfoMap)t.has(a)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(r.layer),r.destroy());for(const a of i)this._createLayerView(a);this._refreshCollections();const s=[e?.ground?.layers,e?.basemap?.baseLayers,e?.basemap?.referenceLayers,e?.layers].filter((e=>!!e));t.forEach((e=>"layers"in e&&s.push(e.layers))),this.addHandles(s.map((e=>this._watchUpdatingTracking.addOnCollectionChange((()=>e),this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([(0,u.on)((()=>this.view?.map?.allLayers),"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),(0,u.wB)((()=>{const e=this.view,t=e?.map;return[t?.basemap,t?.ground,t?.layers,e?.ready]}),(()=>this._reschedule()),u.pc)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),(0,me.X)(this._recyclingInfoMap),(0,me.X)(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,null!=this._workPromise&&(this._workPromise.reject((0,H.NK)()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return null!=this._workPromise||this._watchUpdatingTracking.updating||(0,pe.Bs)(this._layerLayerViewInfoMap,(e=>!e.done))||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const t of this._layerLayerViewInfoMap.values())t.done||++e;return e}clear(){this.destroyed||((0,me.X)(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new d.A("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}isCreatingLayerViewsForLayer(e,t){this.commitProperty("updatingRemaining");const i=this._layerLayerViewInfoMap.get(e);if(!i?.done)return!0;const n=i.layerView;return!(!n||!t||n.parent===t)||!!(i.done&&n&&"layers"in e&&e.layers?.length)&&e.layers.some((e=>this.isCreatingLayerViewsForLayer(e,n)))}_refreshCollections(){for(const[e,t]of this._layersToLayerViews)this._populateLayerViewsOwners((0,ue.Jt)(this,e),(0,ue.Jt)(this,t),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,t,i){if(!e||!t)return void(t&&t.removeAll());let n=0;for(const o of e){const e=this._layerLayerViewInfoMap.get(o);if(!e?.layerView)continue;const s=e.layerView;s.layer=o,s.parent=i,t.at(n)!==s&&t.splice(n,0,s),"layers"in o&&fe(s)&&this._populateLayerViewsOwners(o.layers,s.layerViews,s),n+=1}n<t.length&&t.splice(n,t.length)}_createLayerView(e){e.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const t=new _e(e,this.view,this.layerViewImporter);t.promise.then((()=>this._refreshCollections()),(t=>{t&&((0,H.zf)(t)||"cancelled:layerview-create"===t.name)||a.A.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:t}),this._refreshCollections()})),this._layerLayerViewInfoMap.set(e,t),this.view.ready&&t.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};(0,n._)([(0,o.MZ)()],ye.prototype,"_workPromise",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],ye.prototype,"_watchUpdatingTracking",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],ye.prototype,"_layersToLayerViews",null),(0,n._)([(0,o.MZ)({readOnly:!0})],ye.prototype,"_rootCollectionNames",null),(0,n._)([(0,o.MZ)()],ye.prototype,"layerViewImporter",void 0),(0,n._)([(0,o.MZ)()],ye.prototype,"supportsGround",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],ye.prototype,"updating",null),(0,n._)([(0,o.MZ)({readOnly:!0})],ye.prototype,"updatingRemaining",null),(0,n._)([(0,o.MZ)({constructOnly:!0})],ye.prototype,"view",void 0),ye=(0,n._)([(0,r.$)("esri.views.LayerViewManager")],ye);const ve=ye;var we=i(76931);let Me=class extends Z.A{constructor(e){super(e),this.factor=1.5,this.offset=(0,we.tc)(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};(0,n._)([(0,o.MZ)({type:Number})],Me.prototype,"factor",void 0),(0,n._)([(0,o.MZ)({nonNullable:!0})],Me.prototype,"offset",void 0),(0,n._)([(0,o.MZ)()],Me.prototype,"position",void 0),(0,n._)([(0,o.MZ)({type:Number,range:{min:0}})],Me.prototype,"size",void 0),(0,n._)([(0,o.MZ)()],Me.prototype,"maskUrl",void 0),(0,n._)([(0,o.MZ)()],Me.prototype,"maskEnabled",void 0),(0,n._)([(0,o.MZ)()],Me.prototype,"overlayUrl",void 0),(0,n._)([(0,o.MZ)()],Me.prototype,"overlayEnabled",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Me.prototype,"version",null),(0,n._)([(0,o.MZ)({type:Boolean})],Me.prototype,"visible",void 0),Me=(0,n._)([(0,r.$)("esri.views.Magnifier")],Me);const be=Me;var xe=i(18690),Te=i(67993),Se=i(41289),Ae=i(31933),ke=i(97015);function Pe(e){return!!(null!=e&&"object"==typeof e&&"createQuery"in e&&e.createQuery&&"on"in e&&e.on)}let Ze=class extends X.A.EventedAccessor{constructor(e){super(e),this._selectionMap=new Te.A,this._sources=new h.A,this._trashCan=[],this._layerEditHandles=new h.A,this._vizTaskId=0,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([(0,u.wB)((()=>[this.view,this.showHighlight]),(()=>this._refreshVisualization())),(0,u.on)((()=>this.sources),"change",(e=>{const t=this._selectionMap;for(const i of e.removed)t.delete(i);this._refreshListeners(),this._refreshVisualization()}),{onListenerAdd:()=>this._refreshListeners()})]);const e=new h.A;this.view.when().then((()=>{this.view.map&&(this.view.map.allLayers.flatten((e=>"sublayers"in e&&e.sublayers?e.sublayers:null)).forEach((t=>{(Pe(t)&&!(0,Ae.F2)(t)||(0,Ae.Sv)(t))&&e.add(t)})),this.sources=e)}))}destroy(){this._layerEditHandles.drain(p.xt)}get selections(){return Array.from(this._selectionMap.entries()).map((e=>{const[t,i]=e;return{layer:t,selection:[...i.selection]}}))}get count(){let e=0;for(const t of this._selectionMap.values())e+=t.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){(0,K.V)(e,this._sources)}async getSelectedFeatures(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layerView";const{view:n,selections:o}=this,s=(void 0!==e?o.filter((t=>e.includes(t.layer))):o).filter((e=>e.selection.length>0)).map((async e=>{const{layer:o,selection:s}=e,a=(0,Ae.Sv)(o)?o.parent:o;if(null==a||!Re(a))return null;if("layer"===i)return Ie(a,s,t);if(Ce(a))return null;const r=await n.whenLayerView(a).catch((()=>null));return r?Ie(r,s,t):null}));return(await Promise.all(s)).filter((e=>null!=e))}updateSelection(e){const t=new Map;for(const[o,s]of this._selectionMap)t.set(o,[...s.selection]);let i=!1;const n=e.current.concat(e.added);for(const o of n){const e=o.sourceLayer,n=o.getObjectId();if(this.sources.includes(e)&&(Pe(e)||(0,Ae.Sv)(e))&&null!==n){const o=(0,pe.tE)(t,e,(()=>[]));o.includes(n)||(o.push(n),i=!0)}}for(const o of e.removed){const e=o.sourceLayer,n=o.getObjectId();if(this.sources.includes(e)&&(Pe(e)||(0,Ae.Sv)(e))&&null!==n){const o=t.get(e),s=o?.indexOf(n);void 0!==s&&s>=0&&(o?.splice(s,1),i=!0)}}if(i){const{_selectionMap:e,_trashCan:i}=this,n=[];for(const[o,s]of t){const t=e.get(o);void 0!==t&&i.push(t),e.set(o,{selection:s}),n.push({layer:o,selection:s,...(0,xe.iv)(void 0!==t?t.selection:[],s)})}this._onSelectionChange(n)}}setSelection(e,t){this._setSelection(e,t)}getSelection(e){const t=this._selectionMap.get(e);return t?.selection}appendToSelection(e,t){const i=this._selectionMap.get(e),n=void 0!==i?[...i.selection]:[];for(const o of t)n.includes(o)||n.push(o);this._setSelection(e,n)}removeFromSelection(e,t){const i=this._selectionMap.get(e);if(!i)return;const n=[];for(const o of i.selection)t.includes(o)||n.push(o);this._setSelection(e,n)}toggleInSelection(e,t){const i=this._selectionMap.get(e);if(!i||0===i.selection.length)return void this._setSelection(e,t);const n=new Set(i.selection),o=new Set(t),s=(0,Se.BT)(n,o);this._setSelection(e,Array.from(s))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const t=[];for(const[i,n]of this._selectionMap.entries())t.push({layer:i,added:[],removed:[...n.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(t)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){if(null==this.view||null==this.sources)return;for(this._vizTaskId++;this._trashCan.length>0;){const e=this._trashCan.pop();e?.highlightHandle?.remove()}const{sources:e,view:t,_selectionMap:i,showHighlight:n}=this,o=this._vizTaskId;for(const s of e){const e=i.get(s),a=(0,Ae.Sv)(s)?s.parent:s;if(null!=a&&Re(a)){if(Ce(a))continue;t.whenLayerView(a).then((t=>{e?.highlightHandle?.remove(),null!=e&&n&&o===this._vizTaskId&&"highlight"in t&&"function"==typeof t.highlight&&e.selection.length>0&&(e.highlightHandle=t.highlight(e.selection,this.highlightName))})).catch((()=>{e?.highlightHandle?.remove()}))}}}_refreshListeners(){this._layerEditHandles.drain(p.xt);for(const e of this.sources){const t=(0,Ae.Sv)(e)?e.parent:e;if(null!=t&&Pe(t)){const i=t.on("edits",(t=>{this._handleEditChanges(t,e)}));this._layerEditHandles.push(i)}}}_handleEditChanges(e,t){if(void 0!==e.deletedFeatures&&e.deletedFeatures.length>0&&this._selectionMap.has(t)){const i=e.deletedFeatures.filter((e=>null==e.error)).map((e=>e.objectId)).filter(xe.Ru);this.removeFromSelection(t,i)}}_setSelection(e,t){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const i=this._selectionMap.get(e);if(void 0===i||!Ee(i,{selection:t})){void 0!==i&&this._trashCan.push(i),this._selectionMap.set(e,{selection:[...t]});const n={layer:e,selection:[...t],...(0,xe.iv)(void 0!==i?i.selection:[],t)};this._onSelectionChange([n])}}};(0,n._)([(0,o.MZ)({readOnly:!0,nonNullable:!0})],Ze.prototype,"selections",null),(0,n._)([(0,o.MZ)({readOnly:!0,nonNullable:!0})],Ze.prototype,"count",null),(0,n._)([(0,o.MZ)({constructOnly:!0,nonNullable:!0})],Ze.prototype,"view",void 0),(0,n._)([(0,o.MZ)({readOnly:!0,nonNullable:!0})],Ze.prototype,"hasSelection",null),(0,n._)([(0,o.MZ)()],Ze.prototype,"showHighlight",void 0),(0,n._)([(0,o.MZ)()],Ze.prototype,"sources",null),(0,n._)([(0,o.MZ)()],Ze.prototype,"highlightName",void 0),Ze=(0,n._)([(0,r.$)("esri.views.SelectionManager")],Ze);const Ce=e=>(0,Ae.Sv)(e)?!0===e.parent?.isTable:e.isTable,Re=e=>void 0!==e?.when,Ee=(e,t)=>{if(null==e&&null==t)return!0;if(null!=e&&null==t||null==e&&null!=t)return!1;if(null!=e&&null!=t&&null!=e.selection&&null!=t.selection){const i=[...e.selection],n=[...t.selection];if(i.length!==n.length)return!1;i.sort(),n.sort();for(let e=0;e<i.length;e++)if(i[e]!==n[e])return!1}return!0},Ie=async function(e,t){let i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((e=>void 0!==e.layer)(e)){const o=e;i=void 0===o?null:await o.queryFeatures(new ke.A({...n,objectIds:t})).then((t=>({data:t,layer:e.layer})))}else{const o=e;i=void 0===o?null:await o.queryFeatures(new ke.A({...n,objectIds:t})).then((e=>({data:e,layer:o})))}return i},Ve=Ze;var De=i(69539),Le=i(69098);let Oe=class extends(Le.A.ClonableMixin(Z.A)){constructor(e){super(e),this.accentColor=new De.A([255,127,0]),this.textColor=new De.A([255,255,255])}};(0,n._)([(0,o.MZ)({type:De.A,nonNullable:!0})],Oe.prototype,"accentColor",void 0),(0,n._)([(0,o.MZ)({type:De.A,nonNullable:!0})],Oe.prototype,"textColor",void 0),Oe=(0,n._)([(0,r.$)("esri.views.Theme")],Oe);const ze=Oe;var Fe=i(50176),Ne=i(15941),He=i(89196);i(64921);const Ge=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],We={};function Ue(e){return!!We[e]}Ge.forEach((e=>{We[e]=!0}));class Be{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(((e,t)=>{let{handler:i,priority:n}=e;return this.inputManager?.installHandlers(t,[i],n)}))}disconnect(){this.inputManager&&this._handlers.forEach(((e,t)=>this.inputManager?.uninstallHandlers(t))),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,i,n){const o=Array.isArray(e)?e:e.split(",");if(!function(e){for(const t of e)if(!Ue(t))return!1;return!0}(o))return o.some(Ue)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let s,a;Array.isArray(t)?a=t:(s=t,a=[]),"function"==typeof i?s=i:n=i,n=null!=n?n:G.o.DEFAULT;const r=this._createUniqueGroupName(),l=new qe(this.view,o,a,s);this._handlers.set(r,{handler:l,priority:n});for(const h of o){const e=this._handlerCounts.get(h)||0;this._handlerCounts.set(h,e+1)}return this.inputManager&&this.inputManager.installHandlers(r,[l],n),(0,k.hA)((()=>this._removeHandler(r,o)))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const e of t){const t=this._handlerCounts.get(e);void 0===t||(1===t?this._handlerCounts.delete(e):this._handlerCounts.set(e,t-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}}class qe extends He.l{constructor(e,t,i,n){super(!0),this._latestDragStart=void 0,this.view=e;for(const o of t)switch(o){case"click":this.registerIncoming("click",i,(t=>n(Ke(e,t))));break;case"double-click":this.registerIncoming("double-click",i,(t=>n(Xe(e,t))));break;case"immediate-click":this.registerIncoming("immediate-click",i,(t=>n(Ye(e,t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,(t=>n(Je(e,t))));break;case"hold":this.registerIncoming("hold",i,(t=>n(Qe(e,t))));break;case"drag":this.registerIncoming("drag",i,(e=>{const t=this._wrapDrag(e);t&&n(t)}));break;case"key-down":this.registerIncoming("key-down",i,(e=>n(tt(e))));break;case"key-up":this.registerIncoming("key-up",i,(e=>n(it(e))));break;case"pointer-down":this.registerIncoming("pointer-down",i,(e=>n(nt(e,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",i,(e=>n(nt(e,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",i,(e=>n(nt(e,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,(e=>n(ot(e))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,(e=>n(st(e))));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,(e=>n(nt(e,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,(e=>n(nt(e,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",i,(e=>{n(at(e))}));break;case"focus":this.registerIncoming("focus",i,(e=>{n($e(e))}));break;case"blur":this.registerIncoming("blur",i,(e=>{n(je(e))}))}}_wrapDrag(e){const t=e.data,{x:i,y:n}=t.center,{action:o,pointerType:s,button:a}=t;if("start"===o&&(this._latestDragStart=t),!this._latestDragStart)return;const r=t.pointer.native,l=t.buttons,{cancelable:h,timestamp:c}=e,d={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return"end"===o&&(this._latestDragStart=void 0),{type:"drag",action:o,x:i,y:n,origin:d,pointerType:s,button:a,buttons:l,radius:t.radius,angle:(0,Ne.KJ)(t.angle),native:r,timestamp:c,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}}function $e(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function je(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function Ke(e,t){const{pointerType:i,button:n,buttons:o,x:s,y:a,native:r,eventId:l}=t.data,{cancelable:h,timestamp:c}=t;return{type:"click",pointerType:i,button:n,buttons:o,x:s,y:a,native:r,timestamp:c,screenPoint:(0,we.tc)(s,a),mapPoint:et(e,s,a),eventId:l,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function Xe(e,t){const{pointerType:i,button:n,buttons:o,x:s,y:a,native:r,eventId:l}=t.data,{cancelable:h,timestamp:c}=t;return{type:"double-click",pointerType:i,button:n,buttons:o,x:s,y:a,native:r,timestamp:c,mapPoint:et(e,s,a),eventId:l,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function Ye(e,t){const{pointerType:i,button:n,buttons:o,x:s,y:a,native:r,eventId:l}=t.data,h=r.pointerId,{cancelable:c,timestamp:d}=t;return{type:"immediate-click",pointerId:h,pointerType:i,button:n,buttons:o,x:s,y:a,native:r,timestamp:d,mapPoint:et(e,s,a),eventId:l,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function Je(e,t){const{pointerType:i,button:n,buttons:o,x:s,y:a,native:r,eventId:l}=t.data,h=r.pointerId,{cancelable:c,timestamp:d}=t;return{type:"immediate-double-click",pointerId:h,pointerType:i,button:n,buttons:o,x:s,y:a,native:r,timestamp:d,mapPoint:et(e,s,a),eventId:l,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function Qe(e,t){const{pointerType:i,button:n,buttons:o,x:s,y:a,native:r}=t.data,{cancelable:l,timestamp:h}=t;return{type:"hold",pointerType:i,button:n,buttons:o,x:s,y:a,native:r,timestamp:h,mapPoint:et(e,s,a),cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function et(e,t,i){return e.toMap((0,we.tc)(t,i),{exclude:[]})}function tt(e){const{key:t,repeat:i,native:n}=e.data,{cancelable:o,timestamp:s}=e;return{type:"key-down",key:t,repeat:i,native:n,timestamp:s,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function it(e){const{key:t,native:i}=e.data,{cancelable:n,timestamp:o}=e;return{type:"key-up",key:t,native:i,timestamp:o,cancelable:n,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function nt(e,t){const{x:i,y:n,button:o,buttons:s,native:a,eventId:r}=e.data,l=a.pointerId,h=a.pointerType,{cancelable:c,timestamp:d}=e;return{type:t,x:i,y:n,pointerId:l,pointerType:h,button:o,buttons:s,native:a,timestamp:d,eventId:r,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function ot(e){const{x:t,y:i,buttons:n,native:o,eventId:s}=e.data.currentEvent,{button:a}=e.data.startEvent,r=e.data.startEvent.native.pointerId,l=e.data.startEvent.native.pointerType,h=e.data.action,c={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:d,timestamp:p}=e;return{type:"pointer-drag",x:t,y:i,pointerId:r,pointerType:l,button:a,buttons:n,action:h,origin:c,native:o,timestamp:p,eventId:s,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function st(e){const{cancelable:t,data:i,timestamp:n}=e,{x:o,y:s,deltaY:a,native:r}=i;return{type:"mouse-wheel",x:o,y:s,deltaY:a,native:r,timestamp:n,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function at(e){const{action:t,state:i,device:n}=e.data,{cancelable:o,timestamp:s}=e,{buttons:a,axes:r}=i;return{type:"gamepad",device:n,timestamp:s,action:t,buttons:a,axes:r,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}var rt=i(76336);function lt(e){return[e.on("before-add",(t=>{const i=t.item;if(null==i||e.includes(i))return a.A.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault();i.onAdd()})),e.on("after-remove",(e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()}))]}function ht(e){return e.visible&&null!=e.getEditableFlag&&e.getEditableFlag(rt.PK.USER)&&e.getEditableFlag(rt.PK.MANAGER)}var ct=i(85361),dt=i(11500);class pt{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,t){const i=()=>e.stopPropagation();switch(e.type){case"pointer-move":mt(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:"start"===e.action?this._externallyDragging=!0:"end"===e.action&&(this._externallyDragging=!1),this._stopDrag&&(i(),"end"===e.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!ft(e))break;const n=(0,dt.ZV)(e),o=gt(n,e.pointerType,t.forEachTool);if(null==o)break;const s=o.manipulator,a=o.tool;null==s||null==a||!s.interactive||s.grabbable&&s.grabbableForEvent(e)||!s.grabbing||s.dragging||this._releaseManipulatorBeforeDragging(s,e,t),null!=s&&null!=a&&s.interactive&&s.grabbable&&s.grabbableForEvent(e)&&!s.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:s,tool:a,start:n,pointerType:e.pointerType}),1===this._grabbedManipulators.size&&null==t.activeTool&&(this._revertToNullActiveTool=!0,t.setActiveTool(o.tool)),s.grabbing=!0,s.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),i());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!ft(e))break;const n=this._grabbedManipulators.get(e.pointerId),o=n?.manipulator,s=n?.tool;if(null==o||null==s)break;const a=(0,dt.ZV)(e);a.x=(0,Ne.qE)(a.x,0,t.view.width),a.y=(0,Ne.qE)(a.y,0,t.view.height);const r=n.start,l=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":"update"!==e.action&&1!==this._grabbedManipulators.size||(o.dragging=!0,l?o.events.emit("drag",{action:"update",start:r,screenPoint:a}):o.events.emit("drag",{action:"start",start:r,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:s,manipulator:o,start:r}));break;case"end":o.dragging=!1,l&&o.events.emit("drag",{action:"end",start:r,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}i();break}case"immediate-click":{const n=(0,dt.ZV)(e),o=gt(n,e.pointerType,t.forEachTool);if(function(e){return!!e.native.shiftKey}(e)||t.forEachTool((e=>{if((null==o||o.tool!==e||e.automaticManipulatorSelection)&&e.manipulators){let t=!1;e.manipulators.forEach((e=>{let{manipulator:i}=e;i.selected&&(i.selected=!1,t=!0)})),t&&e.onManipulatorSelectionChanged&&e.onManipulatorSelectionChanged()}})),null==o)break;const{manipulator:s,tool:a}=o;if(!s.interactive)break;s.selectable&&a.automaticManipulatorSelection&&(s.selected=!s.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const r=e.native.shiftKey;s.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:r,stopPropagation:i}),_t(s,i);break}case"click":{const n=(0,dt.ZV)(e),o=gt(n,e.pointerType,t.forEachTool),s=o?.manipulator;if(null==s||!s.interactive)break;const a=e.native.shiftKey;s.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a}),i();break}case"double-click":{const n=(0,dt.ZV)(e),o=gt(n,e.pointerType,t.forEachTool),s=null!=o?o.manipulator:null;if(null==s||!s.interactive)break;const a=e.native.shiftKey;s.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:i}),_t(s,i);break}case"immediate-double-click":{const n=(0,dt.ZV)(e),o=gt(n,e.pointerType,t.forEachTool),s=null!=o?o.manipulator:null;if(null==s||!s.interactive)break;const a=e.native.shiftKey;s.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:i}),"mouse"===e.pointerType&&_t(s,i);break}}this._onFocusChange(t.forEachTool)}_releaseManipulatorBeforeDragging(e,t,i){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:(0,dt.ZV)(t)}),this._grabbedManipulators.forEach(((t,i)=>{let{manipulator:n}=t;n===e&&this._grabbedManipulators.delete(i)})),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(e,t){const i=this._grabbedManipulators.get(e.pointerId)?.manipulator;null!=i&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:(0,dt.ZV)(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(t.setActiveTool))}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=ut(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=ut(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,i=new Set;this._grabbedManipulators.forEach((e=>{let{tool:i}=e;t.add(i)})),this._hoveredManipulators.forEach((e=>{let{tool:t}=e;i.add(t)})),e((e=>{e.hasGrabbedManipulators=t.has(e),e.hasHoveredManipulators=i.has(e);const n=this._grabbedManipulators.values(),o=(0,ct.I6)(n,(t=>{let{tool:i}=t;return i===e}));e.firstGrabbedManipulator=null!=o?o.manipulator:null}))}clearPointers(e,t){let{forEachTool:i,setActiveTool:n}=t,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3?arguments[3]:void 0;const a=(t,i)=>t===e&&(null==s||s===i);this._grabbedManipulators.forEach(((e,t)=>{let{tool:i,manipulator:n,pointerType:o}=e;a(i,n)&&(this._grabbedManipulators.delete(t),n.grabbing=!1,n.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:o}))})),this._draggedManipulators.forEach(((e,t)=>{let{tool:i,manipulator:n}=e;a(i,n)&&(this._draggedManipulators.delete(t),n.dragging=!1,n.events.emit("drag",{action:"cancel"}))})),o&&this._hoveredManipulators.forEach(((e,t)=>{let{tool:i,manipulator:n}=e;a(i,n)&&(this._hoveredManipulators.delete(t),n.hovering=!1)})),this._afterManipulatorRelease(n),this._onFocusChange(i)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach(((t,i)=>{this._updateHoveredStateForPointerAtScreenPosition((0,we.tc)(t.x,t.y),i,t.pointerType,e)}))}handleHoverEvent(e,t){const i=e.type;"pointer-up"!==i&&"immediate-click"!==i&&"pointer-move"!==i||!mt(e.pointerType)||("pointer-up"!==i&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition((0,dt.ZV)(e),e.pointerId,e.pointerType,t))}_updateHoveredStateForPointerAtScreenPosition(e,t,i,n){let o=gt(e,i,n);const s=this._hoveredManipulators.get(t)?.manipulator;null==o||o.manipulator.interactive||(o=null),null!=o&&s===o.manipulator||(null!=s&&(s.hovering=!1),null!=o?(o.manipulator.hovering=!0,this._hoveredManipulators.set(t,o)):this._hoveredManipulators.delete(t),this._onFocusChange(n))}_afterManipulatorRelease(e){0===this._grabbedManipulators.size&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(((t,i)=>{let{manipulator:n}=t;e===i&&(this._hoveredManipulators.delete(e),n.hovering=!1)}))}}function ut(e){for(const{manipulator:t}of e.values())if(null!=t&&t.interactive){if(t.grabbing&&t.grabCursor)return t.grabCursor;if(t.cursor)return t.cursor}return null}function gt(e,t,i){let n=null;return i((i=>{if(null==i.manipulators||!ht(i))return!1;const o=i.manipulators.intersect(e,t);return null!=o&&(n={tool:i,manipulator:o},!0)})),n}function mt(e){return"mouse"===e}function ft(e){return"mouse"!==e.pointerType||0===e.button}function _t(e,t){e?.consumesClicks&&t()}const yt="attached",vt="tools";let wt=class extends Z.A{constructor(e){super(e),this._updatingHandles=new C.U,this._clock=Fe.p,this._manipulatorState=new pt,this.tools=new h.A,this.cursor=null,this._interacting=!1,this._interactingTimeout=1e3,this._interactingTimeoutHandle=null,this._forEachTool=e=>{for(const t of this.tools.items)if(e(t))return}}initialize(){this.addHandles([this.view.on(Ge,(e=>{this._handleInputEvent(e)}),G.o.TOOL),...lt(this.tools),this.tools.on("before-add",(e=>{let{item:t}=e;this._updateToolEditableFlag(t)})),this.tools.on("before-remove",(e=>{let{item:t}=e;this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()})),this.tools.on("change",(()=>{this._refreshToolWatchers()}))])}destroy(){this.activeTool=null,this.tools.drain((e=>e.destroy())),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(null!=e&&!this.view.ready)return void a.A.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),null!=t&&t.deactivate(),null!=e&&e.activate(),this._removeIncompleteTools(e);for(const i of this.tools){this._updateToolEditableFlag(i);const e=ht(i);null!=this.activeTool&&e||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!e)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some((e=>e.updating))}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=(0,p.xt)(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout((()=>this._interacting=!1),this._interactingTimeout)}attach(){"3d"===this.view.type?this.addHandles([(0,u.wB)((()=>{const{state:e}=this.view;return"camera"in e&&e.camera}),(()=>this._forEachManipulator((e=>e.onViewChange())))),this.view.elevationProvider?.on("elevation-change",(e=>this._forEachManipulator((t=>t.onElevationChange(e)))))],yt):this.addHandles((0,u.wB)((()=>this.view.extent),(()=>this._forEachManipulator((e=>e.onViewChange())))))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(yt),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool((t=>{t.manipulators&&t.manipulators.forEach((i=>{let{manipulator:n}=i;return e(n,t)}))}))}_handleInputEvent(e){let t=!1;const i={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};null!=this.activeTool?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool((e=>{!t&&e.visible&&e.handleInputEvent(i)})),!t&&"key-down"===e.type&&"Escape"===e.key&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),t||null==this.activeTool||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor(),"pointer-move"===e.type&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(vt),this._forEachTool((e=>{if(e instanceof Z.A){const t=(0,u.wB)((()=>[e.cursor,e.visible,e.editable]),(()=>{ht(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}));this.addHandles(t,vt)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",(t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)})),e.manipulators.on("change",(()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}))],vt)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag?.(rt.PK.MANAGER,null==this.activeTool||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;null==e&&this._forEachTool((t=>!(null==t.cursor||!t.visible)&&(e=t.cursor,!0))),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter((t=>(null==e||t!==e)&&!t.created&&t.removeIncompleteOnCancel)).forEach((e=>{this.tools.remove(e)}))}get test(){}};(0,n._)([(0,o.MZ)({constructOnly:!0,nonNullable:!0})],wt.prototype,"view",void 0),(0,n._)([(0,o.MZ)({value:null})],wt.prototype,"activeTool",null),(0,n._)([(0,o.MZ)({readOnly:!0,type:h.A})],wt.prototype,"tools",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],wt.prototype,"cursor",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],wt.prototype,"updating",null),(0,n._)([(0,o.MZ)()],wt.prototype,"_interacting",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],wt.prototype,"interacting",null),wt=(0,n._)([(0,r.$)("esri.views.ToolViewManager")],wt);var Mt=i(1723),bt=i(30363);let xt=class extends Z.A{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown","standard"===e.mapping?this._detectedDeviceType="standard":St.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return null!=this.nativeIndex&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return At[this.deviceType]}};(0,n._)([(0,o.MZ)({nonNullable:!0,readOnly:!0})],xt.prototype,"nativeIndex",void 0),(0,n._)([(0,o.MZ)({type:String,readOnly:!0})],xt.prototype,"deviceType",null),(0,n._)([(0,o.MZ)({type:Number,readOnly:!0})],xt.prototype,"axisThreshold",null),xt=(0,n._)([(0,r.$)("esri.views.input.gamepad.GamepadInputDevice")],xt);const Tt=xt,St=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),At={standard:.15,spacemouse:.025,unknown:0};let kt=class extends Z.A{constructor(){super(...arguments),this.devices=new h.A,this.enabledFocusMode="document"}};(0,n._)([(0,o.MZ)({type:h.A.ofType(Tt),readOnly:!0})],kt.prototype,"devices",void 0),(0,n._)([(0,o.MZ)({type:["document","view","none"]})],kt.prototype,"enabledFocusMode",void 0),kt=(0,n._)([(0,r.$)("esri.views.input.gamepad.GamepadSettings")],kt);const Pt=kt;let Zt=class extends Z.A{constructor(){super(...arguments),this.gamepad=new Pt}};(0,n._)([(0,o.MZ)({readOnly:!0})],Zt.prototype,"gamepad",void 0),Zt=(0,n._)([(0,r.$)("esri.views.input.Input")],Zt);const Ct=Zt;var Rt=i(17555),Et=i(63241);const It=()=>(0,o.MZ)({type:["pan","rotate","zoom","none"],nonNullable:!0});let Vt=class extends Z.A{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};(0,n._)([It()],Vt.prototype,"dragPrimary",void 0),(0,n._)([It()],Vt.prototype,"dragSecondary",void 0),(0,n._)([It()],Vt.prototype,"dragTertiary",void 0),(0,n._)([(0,o.MZ)({type:["zoom","none"],nonNullable:!0})],Vt.prototype,"mouseWheel",void 0),Vt=(0,n._)([(0,r.$)("esri.views.navigation.NavigationActionMap")],Vt);const Dt=Vt;let Lt=class extends Z.A{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};(0,n._)([(0,o.MZ)({type:Boolean,nonNullable:!0})],Lt.prototype,"enabled",void 0),(0,n._)([(0,o.MZ)({type:Tt})],Lt.prototype,"device",void 0),(0,n._)([(0,o.MZ)({type:["pan","zoom"],nonNullable:!0})],Lt.prototype,"mode",void 0),(0,n._)([(0,o.MZ)({type:["forward-down","forward-up"],nonNullable:!0})],Lt.prototype,"tiltDirection",void 0),(0,n._)([(0,o.MZ)({type:Number,nonNullable:!0})],Lt.prototype,"velocityFactor",void 0),Lt=(0,n._)([(0,r.$)("esri.views.navigation.gamepad.GamepadSettings")],Lt);const Ot=Lt;let zt=class extends Z.A{constructor(e){super(e),this.actionMap=new Dt,this.browserTouchPanEnabled=!0,this.gamepad=new Ot,this.momentumEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!(0,Rt.O)()}get mouseWheelZoomEnabled(){return"zoom"===this.actionMap.mouseWheel}set mouseWheelZoomEnabled(e){(0,Et.Lx)(a.A.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};(0,n._)([(0,o.MZ)({type:Dt,nonNullable:!0})],zt.prototype,"actionMap",void 0),(0,n._)([(0,o.MZ)({type:Boolean})],zt.prototype,"browserTouchPanEnabled",void 0),(0,n._)([(0,o.MZ)({type:Ot,nonNullable:!0})],zt.prototype,"gamepad",void 0),(0,n._)([(0,o.MZ)({type:Boolean})],zt.prototype,"momentumEnabled",void 0),(0,n._)([(0,o.MZ)({type:Boolean})],zt.prototype,"mouseWheelZoomEnabled",null),zt=(0,n._)([(0,r.$)("esri.views.navigation.Navigation")],zt);const Ft=zt;var Nt=i(47700),Ht=i(64465);let Gt,Wt=null;async function Ut(e){Wt||(Wt=i.e(61864).then(i.bind(i,39483)).then((e=>Gt=e))),await Wt,(0,H.Te)(e)}async function Bt(e,t,i,n){if(!e)return null;const o=e.spatialReference;return(0,y.isLoaded)()||(0,y.canProjectWithoutEngine)(o,t)?(0,y.project)(e,t):Gt?Gt.projectGeometry(e,t,i,n):(await Promise.race([Ut(n),(0,y.load)(n)]),Bt(e,t,i,n))}let qt=class extends Z.A{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=(0,p.DC)(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return null==this.userSpatialReference||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const e=this.map?.(),t=[];return null!=this.priorityCollection&&t.push(this.priorityCollection),t.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),t}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,(t=>{const i=this._getSupportedSpatialReferences(t);if(i.length>0){const t=this._narrowDownSpatialReferenceCandidates(e,i);null!=t&&(e=t)}return 1===e?.length}))&&1!==e?.length)return{updating:!0};const t=this._pickSpatialReferenceCandidate(e);return{spatialReference:t?.spatialReference??null,viewingMode:t?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=this.map?.(),t=this.spatialReference;if(!t)return{updating:this._spatialReferenceTask.updating};let i;const n=this._collectLayers([{parent:e?.basemap,layers:e?.basemap?.baseLayers},{layers:e?.layers}],(e=>!(!("tileInfo"in e)||!e.tileInfo?.spatialReference.equals(t))&&(i=e,!0)),(e=>"tileInfo"in e));return i?{tileInfo:i.tileInfo,updating:!1}:{updating:n}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let e={};const t=this._collectLayers(this.mapCollections,(t=>{const i=(0,Nt.zy)(t);return!!i&&(e={heightModelInfo:i,vcsWkid:t.spatialReference?.vcsWkid,latestVcsWkid:t.spatialReference?.latestVcsWkid},!0)}),(e=>(0,Nt.jI)(e)));return{...e,updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],t=this._collectLayers(this.mapCollections,(t=>{const i="fullExtents"in t&&t.fullExtents||(null!=t.fullExtent?[t.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:i[0],o=i.find((e=>e.spatialReference.equals(this.spatialReference)))??n;if(o)return e.push({extent:o,layer:t}),!0;if(this._getSupportedSpatialReferences(t).length>0)for(const s of i)e.push({extent:s,layer:t});return!1}));return{candidates:e,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(null==e||0===e.length)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(e),n=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:null!=this._projectExtentTask.task&&!this._projectExtentTask.task.finished}:(null!=this._projectExtentTask.task&&(this._projectExtentTask.task=(0,p.DC)(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:n.clone(),task:(0,N.UT)((async e=>{try{const t=await Bt(i.extent,n,"portalItem"in i.layer?i.layer.portalItem:void 0,e);this._projectExtentTask={...this._projectExtentTask,task:null,output:t}}catch(t){if((0,H.G4)(e))return;this._projectExtentTask={...this._projectExtentTask,task:null}}}))},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(null==e)return t;const i=new Array;for(const n of e)for(const e of t){if(!n.spatialReference.equals(e.spatialReference))continue;const t=jt(n.viewingMode,e.viewingMode);if(!1!==t){i.push({spatialReference:n.spatialReference,viewingMode:t});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return null==e||e.length<1?t?{spatialReference:t,viewingMode:null}:null:(null!=t&&e.length>1&&e.some((e=>{let{spatialReference:i}=e;return i.equals(t)}))&&(e=e.filter((e=>{let{spatialReference:i}=e;return i.equals(t)}))),e.length>1&&e.some((e=>{let{viewingMode:t}=e;return t!==Ht.RT.Local}))&&(e=e.filter((e=>{let{viewingMode:t}=e;return t!==Ht.RT.Local}))),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(0===t.length)return[];const i=[];for(const n of t){const t=this.getSpatialReferenceSupport(n,e);if(null!=t){const e=t.constraints??[{spatialReference:n,viewingMode:null}];for(const{spatialReference:t,viewingMode:n}of e)this.requiresExtentInSpatialReference&&null!=this.userSpatialReference&&!t.equals(this.userSpatialReference)||i.push({spatialReference:t,viewingMode:n})}}return i}_pickExtentCandidate(e){const t=this.spatialReference;return e.find((e=>{let{extent:i}=e;return t.equals(i.spatialReference)}))||e[0]}_collectLayers(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const n=new $t(i,t);for(const o of e)if(this._collectCollection(o,n),n.done||n.preloading===this.sourcePreloadCount)break;return n.updating}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const i of e.layers)if(t.layerFilter(i)){switch(this._loadMaybe(i)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":if(t.updating||(t.done=t.pushLayer(i)),t.done||t.preloading===this.sourcePreloadCount)break;"layers"in i&&this._collectCollection({layers:i.layers},t)}if(t.done||t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&null!=e.loadStatus?"not-loaded"===e.loadStatus?(e.load().catch((e=>{(0,H.zf)(e)})),"loading"):e.loadStatus:"loaded"}};(0,n._)([(0,o.MZ)()],qt.prototype,"required",void 0),(0,n._)([(0,o.MZ)({constructOnly:!0})],qt.prototype,"map",void 0),(0,n._)([(0,o.MZ)({constructOnly:!0})],qt.prototype,"getSpatialReferenceSupport",void 0),(0,n._)([(0,o.MZ)()],qt.prototype,"defaultSpatialReference",void 0),(0,n._)([(0,o.MZ)()],qt.prototype,"userSpatialReference",void 0),(0,n._)([(0,o.MZ)()],qt.prototype,"sourcePreloadCount",void 0),(0,n._)([(0,o.MZ)()],qt.prototype,"priorityCollection",void 0),(0,n._)([(0,o.MZ)()],qt.prototype,"requiresExtentInSpatialReference",void 0),(0,n._)([(0,o.MZ)()],qt.prototype,"suspended",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"ready",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"heightModelInfoReady",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"spatialReference",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"extent",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"heightModelInfo",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"vcsWkid",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"latestVcsWkid",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"viewingMode",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"tileInfo",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"mapCollections",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"_spatialReferenceTask",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"_tileInfoTask",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"_heightModelInfoTask",null),(0,n._)([(0,o.MZ)({readOnly:!0})],qt.prototype,"_extentCandidatesTask",null),(0,n._)([(0,o.MZ)()],qt.prototype,"_extentTask",null),(0,n._)([(0,o.MZ)()],qt.prototype,"_projectExtentTask",void 0),qt=(0,n._)([(0,r.$)("esri.views.support.DefaultsFromMap")],qt);class $t{constructor(e,t){this.layerFilter=e,this.pushLayer=t,this.preloading=-1,this.updating=!1,this.done=!1}}function jt(e,t){return null!=e?null!=t?e===t&&e:e:t}let Kt=class extends Z.A{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};(0,n._)([(0,o.MZ)()],Kt.prototype,"featureTitleFields",void 0),(0,n._)([(0,o.MZ)()],Kt.prototype,"utilityNetworkFields",void 0),(0,n._)([(0,o.MZ)()],Kt.prototype,"globalIdField",void 0),Kt=(0,n._)([(0,r.$)("esri.views.support.RequiredFieldsOptions")],Kt);const Xt=Kt;var Yt;let Jt=Yt=class extends(X.A.EventedMixin(Q.A.EsriPromiseMixin(Z.A))){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.handles=new Y.A,this.updatingHandles=new C.U,this.allLayerViews=new c.A({getCollections:()=>[this.basemapView?.baseLayerViews,this.groundView?.layerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:ti}),this.groundView=null,this.basemapView=null,this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new ae.Y,this.analyses=new se,this.typeSpecificPreconditionsReady=!0,this.layerViews=new h.A,this.magnifier=new be,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Ct,this.navigation=new Ft,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Be(this),this.persistableViewModels=new h.A,this.requiredFieldsOptions=new Xt,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add((0,u.wB)((()=>this.preconditionsReady),(e=>{const t=this.ready;if(e?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,Yt.views.add(this)):(this._lockedSpatialReference=null,Yt.views.remove(this)),this.notifyChange("spatialReference"),!e&&t)this.toolViewManager?.detach(),null!=this.analysisViewManager&&this.analysisViewManager.detach(),this.layerViewManager?.clear(),this._teardown();else if(e&&!t){try{this._startup()}catch(Me){return void queueMicrotask((()=>{this.fatalError=new d.A("startup-error",null,Me)}))}null!=this.analysisViewManager&&this.analysisViewManager.attach(),this.toolViewManager.attach()}}),u.OH))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then((()=>(this._isValid=!0,(0,u.C_)((()=>this.ready)))))),this.basemapView=new de({view:this}),this.layerViewManager=new ve({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new wt({view:this}),this.selectionManager=new Ve({view:this}),this.addHandles([(0,u.z7)((()=>"map-content-error"===this.readyState&&!this.spatialReference),(()=>{a.A.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})),(0,u.wB)((()=>this.initialExtentRequired),(e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e}),u.pc),(0,u.wB)((()=>this.ready),(e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)}),u.OH),(0,u.wB)((()=>this._userSpatialReference),(e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)}),u.pc)])}destroy(){this.destroyed||(Yt.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=(0,p.pR)(this.graphics),this.analyses=(0,p.pR)(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),(0,p.pR)(this.analysisViewManager),this.toolViewManager=(0,p.pR)(this.toolViewManager),this.layerViewManager=(0,p.pR)(this.layerViewManager),this.selectionManager=(0,p.pR)(this.selectionManager),this.basemapView=(0,p.pR)(this.basemapView),this.groundView?.destroy(),this.layerViews?.forEach((e=>e.destroy())),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=(0,p.pR)(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return a.A.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new qt({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,t)=>this.getSpatialReferenceSupport(e,t),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??new(h.A.ofType(bt.A))([new bt.A({name:Mt.Tv}),new bt.A({name:Mt.n4,color:Mt.lH})])}set highlights(e){this._set("highlights",(0,K.V)(e,this._get("highlights"),h.A.ofType(bt.A)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||J.A.isLoadable(this.map)&&!this.map.loaded||0===this.width||0===this.height||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(a.A.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),J.A.isLoadable(e)&&e.load().catch((()=>{})),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if(this.defaultsFromMap?.ready&&!this.spatialReference){const e=!("loaded"in this.map)||this.map.loaded,t=this.map.ground.loaded,i=this.map.basemap?.loaded??!0;return e&&i&&t&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=(0,N.UT)((e=>(0,H.Pl)((0,s.A)("view-readyState-waiting-delay"),null,e))),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=(0,p.DC)(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){const t=e.clone();return t.vcsWkid=this.defaultsFromMap.vcsWkid,t.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,t}return e}set spatialReference(e){const t=!(0,oe.aI)(e,this._get("spatialReference"));this._set("_userSpatialReference",e),t&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??re.qU}set timeZone(e){this._userTimeZone=e,(0,he.wr)(e)||a.A.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._cursor??"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new ze}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(e){throw new d.A("importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return null!=this.getSpatialReferenceSupport(e)}when(e,t){return this.isResolved()&&!this.ready&&a.A.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,t)}forceReadyCycle(){this.ready&&((0,u.z7)((()=>this.destroyed||!1===this.preconditionsReady),(()=>this._readyCycleForced=!1),{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}};Jt.views=new h.A,(0,n._)([(0,o.MZ)()],Jt.prototype,"_userSpatialReference",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"activeTool",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"allLayerViews",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"groundView",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"animation",null),(0,n._)([(0,o.MZ)()],Jt.prototype,"basemapView",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"center",null),(0,n._)([(0,o.MZ)()],Jt.prototype,"defaultsFromMapSettings",null),(0,n._)([(0,o.MZ)()],Jt.prototype,"defaultsFromMap",null),(0,n._)([(0,o.MZ)()],Jt.prototype,"displayFilterEnabled",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"fatalError",void 0),(0,n._)([(0,o.MZ)({type:te.A})],Jt.prototype,"extent",null),(0,n._)([(0,o.MZ)((0,ee.C)(ae.Y,"graphics"))],Jt.prototype,"graphics",void 0),(0,n._)([(0,o.MZ)((0,ee.C)(se,"analyses"))],Jt.prototype,"analyses",void 0),(0,n._)([(0,o.MZ)({readOnly:!0,type:ie.A})],Jt.prototype,"heightModelInfo",null),(0,n._)([(0,o.MZ)({type:h.A.ofType(bt.A)})],Jt.prototype,"highlights",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"interacting",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"navigating",null),(0,n._)([(0,o.MZ)({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Jt.prototype,"preconditionsReady",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"typeSpecificPreconditionsReady",void 0),(0,n._)([(0,o.MZ)({type:h.A,readOnly:!0})],Jt.prototype,"layerViews",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"resolution",null),(0,n._)([(0,o.MZ)({type:be})],Jt.prototype,"magnifier",void 0),(0,n._)([(0,o.MZ)({value:null,type:j.A})],Jt.prototype,"map",null),(0,n._)([(0,o.MZ)()],Jt.prototype,"padding",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"ready",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"_readyStateWaitingTask",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"readyState",null),(0,n._)([(0,o.MZ)({type:ne.A})],Jt.prototype,"spatialReference",null),(0,n._)([(0,o.MZ)()],Jt.prototype,"stationary",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"supportsGround",void 0),(0,n._)([(0,o.MZ)({type:le.A})],Jt.prototype,"timeExtent",null),(0,n._)([(0,o.MZ)({type:String,nonNullable:!0})],Jt.prototype,"timeZone",null),(0,n._)([(0,o.MZ)()],Jt.prototype,"tools",null),(0,n._)([(0,o.MZ)()],Jt.prototype,"toolViewManager",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"type",void 0),(0,n._)([(0,o.MZ)({type:Number})],Jt.prototype,"scale",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"updating",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"initialExtentRequired",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"initialExtent",null),(0,n._)([(0,o.MZ)()],Jt.prototype,"cursor",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"input",void 0),(0,n._)([(0,o.MZ)({type:Ft,nonNullable:!0})],Jt.prototype,"navigation",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"layerViewManager",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"analysisViewManager",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"selectionManager",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"width",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"height",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"resizing",void 0),(0,n._)([(0,o.MZ)({value:null,readOnly:!0})],Jt.prototype,"size",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"suspended",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"viewEvents",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Jt.prototype,"persistableViewModels",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"_isValid",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"_readyCycleForced",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"_lockedSpatialReference",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"_userTimeZone",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"_lockedTimeZone",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"_userTimeExtent",void 0),(0,n._)([(0,o.MZ)()],Jt.prototype,"_lockedTimeExtent",void 0),(0,n._)([(0,o.MZ)({type:ze})],Jt.prototype,"theme",void 0),(0,n._)([(0,o.MZ)({readOnly:!0,type:ze})],Jt.prototype,"effectiveTheme",null),Jt=Yt=(0,n._)([(0,r.$)("esri.views.View")],Jt);const Qt=globalThis.$arcgis;Qt&&!Qt.views&&Object.defineProperty(Qt,"views",{configurable:!1,enumerable:!0,writable:!1,value:Jt.views});const ei=Jt;function ti(e){return e.layerViews}var ii=i(19555),ni=i(72745),oi=i(28632),si=i(42553),ai=i(53494),ri=i(94967),li=i(98006),hi=i(99809),ci=i(63919),di=i(85827),pi=i(59422);function ui(e){return function(e){return e instanceof Float32Array&&e.length>=2}(e)||function(e){return Array.isArray(e)&&e.length>=2}(e)}var gi,mi=i(19247),fi=i(1438);const _i=[0,0];let yi=gi=class extends si.A{constructor(e){super(e),this._viewpoint2D={center:(0,ni.vt)(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new te.A,this.id=0,this.inverseTransform=(0,hi.vt)(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=(0,hi.vt)(),this.transformNoRotation=(0,hi.vt)(),this.displayMat3=(0,di.vt)(),this.displayViewMat3=(0,di.vt)(),this.viewMat3=(0,di.vt)(),this.viewMat2d=(0,li.vt)(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(e){this._set("pixelRatio",e),this._update()}set size(e){this._set("size",e),this._update()}set viewpoint(e){if(e){const t=this._viewpoint2D,i=e.targetGeometry;t.center[0]=i.x,t.center[1]=i.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=i.spatialReference}this._update()}get visibleArea(){const[e,t]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,t),this.toMap([0,0],e,t),this.toMap([0,0],e,0)]}copy(e){const t=this.size,i=this.viewpoint;return i&&t?(this.viewpoint=(0,oi.C)(i,e.viewpoint),this._set("size",(0,ii.C)(t,e.size))):(this.viewpoint=e.viewpoint.clone(),this._set("size",[e.size[0],e.size[1]])),this._set("pixelRatio",e.pixelRatio),this}clone(){return new gi({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(e,t,i){return ui(t)?(0,ii.l0)(e,t,this.inverseTransform):(_i[0]=t,_i[1]=i,(0,ii.l0)(e,_i,this.inverseTransform))}toScreen(e,t,i){return ui(t)?(0,ii.l0)(e,t,this.transform):(_i[0]=t,_i[1]=i,(0,ii.l0)(e,_i,this.transform))}toScreenNoRotation(e,t,i){return ui(t)?(0,ii.l0)(e,t,this.transformNoRotation):(_i[0]=t,_i[1]=i,(0,ii.l0)(e,_i,this.transformNoRotation))}wrapMapCoordinate(e,t){(0,ii.C)(e,t);const[i]=t,[n]=this.center,{extent:o,spatialReference:s}=this;let{xmin:a,xmax:r}=o;if(s.isWrappable){const e=(0,oi.FT)(s)/2;a=Math.max(a,n-e),r=Math.min(r,n+e)}return(i<a||i>r)&&(e[0]=(0,fi.O7)(i,n,s)),e}getScreenTransform(e,t){const{center:i}=this._viewpoint2D,n=this._get("pixelRatio")||1,o=this._get("size");return(0,oi.GL)(e,i,o,t,0,n),e}_update(){const{center:e,spatialReference:t,scale:i,rotation:n}=this._viewpoint2D,o=this._get("pixelRatio")||1,s=this._get("size"),a=new l.A({targetGeometry:new mi.A(e[0],e[1],t),scale:i,rotation:n});if(this._set("viewpoint",a),!s||!t||!i)return;this.resolution=(0,oi.Hn)(a),this.rotation=n,this.scale=i,this.spatialReference=t,(0,ii.C)(this.center,e);const r=0!==s[0]?2/s[0]:0,h=0!==s[1]?-2/s[1]:0;(0,ci.hZ)(this.displayMat3,r,0,0,0,h,0,-1,1,1);const c=(0,ci.D_)(this.viewMat3),d=(0,pi.fA)(s[0]/2,s[1]/2),p=(0,pi.fA)(-s[0]/2,-s[1]/2),u=(0,ai.DF)(n);(0,ci.Tl)(c,c,d),(0,ci.e$)(c,c,u),(0,ci.Tl)(c,c,p),(0,ci.lw)(this.displayViewMat3,this.displayMat3,c);const g=(0,ri.kN)(this.viewMat2d,d);return(0,ri.e$)(g,g,u),(0,ri.Tl)(g,g,p),(0,oi.Z7)(this.extent,a,s),(0,oi.RG)(this.transform,a,s,o),(0,ri.B8)(this.inverseTransform,this.transform),(0,oi.cp)(this.transformNoRotation,a,s,o),this.worldScreenWidth=(0,oi.hV)(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};(0,n._)([(0,o.MZ)({readOnly:!0})],yi.prototype,"id",void 0),(0,n._)([(0,o.MZ)({value:1,json:{write:!0}})],yi.prototype,"pixelRatio",null),(0,n._)([(0,o.MZ)({json:{write:!0}})],yi.prototype,"size",null),(0,n._)([(0,o.MZ)()],yi.prototype,"spatialReference",void 0),(0,n._)([(0,o.MZ)({type:l.A,json:{write:!0}})],yi.prototype,"viewpoint",null),(0,n._)([(0,o.MZ)({readOnly:!0})],yi.prototype,"visibleArea",null),yi=gi=(0,n._)([(0,r.$)("esri.views.2d.ViewState")],yi);const vi=yi;var wi,Mi;let bi=wi=class extends Z.A{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new wi({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};(0,n._)([(0,o.MZ)()],bi.prototype,"left",void 0),(0,n._)([(0,o.MZ)()],bi.prototype,"top",void 0),(0,n._)([(0,o.MZ)()],bi.prototype,"right",void 0),(0,n._)([(0,o.MZ)()],bi.prototype,"bottom",void 0),bi=wi=(0,n._)([(0,r.$)("esri.views.2d.PaddedViewState.Padding")],bi);let xi=Mi=class extends vi{constructor(){super(...arguments),this.paddedViewState=new vi,this._updateContent=(()=>{const e=(0,ni.vt)();return()=>{const t=this._get("size"),i=this._get("padding");if(!t||!i)return;const n=this.paddedViewState;(0,ii.hZ)(e,i.left+i.right,i.top+i.bottom),(0,ii.Re)(e,t,e),(0,ii.C)(n.size,e);const o=n.viewpoint;o&&(this.viewpoint=o)}})(),this.addHandles((0,u.wB)((()=>[this.size,this.padding]),(()=>this._updateContent()),u.OH)),this.padding=new bi,this.size=[0,0]}set padding(e){this._set("padding",e||new bi)}set viewpoint(e){if(e){this.paddedViewState.viewpoint=e;let t=e;const i=this._get("padding");i&&(t=(0,oi.nr)(e.clone(),e,this._get("size"),i));const{targetGeometry:n,rotation:o,scale:s}=t,{x:a,y:r,spatialReference:l}=n,h=this._viewpoint2D;h.center[0]=a,h.center[1]=r,h.rotation=o,h.scale=s,h.spatialReference=l,this._update()}}clone(){return new Mi({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};(0,n._)([(0,o.MZ)()],xi.prototype,"paddedViewState",void 0),(0,n._)([(0,o.MZ)({type:bi})],xi.prototype,"padding",null),(0,n._)([(0,o.MZ)()],xi.prototype,"viewpoint",null),xi=Mi=(0,n._)([(0,r.$)("esri.views.2d.PaddedViewState")],xi);const Ti=xi;var Si=i(98476),Ai=i(59752);class ki{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=(0,Ai.mj)(),this._schedulerHandle=(0,u.z7)((()=>this._scheduler.updating),(()=>this.requestFrame())),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),null==this.view.animation?.target||(0,H.$X)(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=e=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:t,graphicsView:i,labelManager:n,state:{id:o}}=this.view;t?.forEach(this._updateLayerView,this),null!=n&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),null!=i&&(i.lastUpdateId!==o&&(i.viewChange(),i.lastUpdateId=o),i.updateRequested&&i.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=Si.M.ANIMATING:this.view.interacting?this._scheduler.state=Si.M.INTERACTING:this._scheduler.state=Si.M.IDLE,this._scheduler.frame(e)||this._updateRequested||this._scheduler.state!==Si.M.IDLE||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new Ti,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=(0,u.wB)((()=>e.stationary),(e=>{this.stationary=e,this.requestFrame()})),this._frameTaskHandle=(0,P.mg)(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const t=this.view.state,i=e.lastUpdateId;null!=i&&(this.stationary||e.moving)||(e.moving=!0),i!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}}let Pi=class extends Q.A{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=(0,H.Tw)(),this.addResolvingPromise(this._resolver.promise)}get done(){return"finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._resolver?.reject(new d.A("ViewAnimation stopped")))}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._resolver?.resolve())}update(e,t){t||(t=(0,H.$X)(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};(0,n._)([(0,o.MZ)({readOnly:!0})],Pi.prototype,"done",null),(0,n._)([(0,o.MZ)({readOnly:!0,type:String})],Pi.prototype,"state",void 0),(0,n._)([(0,o.MZ)()],Pi.prototype,"target",void 0),Pi=(0,n._)([(0,r.$)("esri.views.ViewAnimation")],Pi),function(e){e.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(Pi||(Pi={}));const Zi=Pi;let Ci=class extends Z.A{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,t){if(!e)return void a.A.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new Zi;this.view.animation=i,await(0,u.C_)((()=>this.view.ready),t);const n={...t,animate:t?.animate??!(0,Rt.O)(),animationMode:t?.animationMode??"auto"},{extent:o,spatialReference:s,size:r,viewpoint:l,constraints:h,padding:c,allLayerViews:d}=this.view,p=(0,oi.vt)(e,{extent:o,spatialReference:s,size:r,viewpoint:l,constraints:h,padding:c,allLayerViews:d,pickClosestTarget:t?.pickClosestTarget??!0});return i?.update(p),this._gotoTask={},n.animate?this._gotoAnimated(p,n):this._gotoImmediate(p,n)}_gotoImmediate(e,t){const i=this._gotoTask,n=this.view.animation,o=e.then((e=>{if((0,H.Te)(t),i!==this._gotoTask)throw new d.A("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=n.target=e,n.finish()}));return this._cancellableGoTo(i,n,o,t)}_gotoAnimated(e,t){const i=this._gotoTask,n=this.view.animation;if(!n)return Promise.resolve();const o=e.then((e=>{if((0,H.Te)(t),i!==this._gotoTask)throw new d.A("view:goto-interrupted","Goto was interrupted");return n.update(e),this.view.animationManager.animate(n,this.view.viewpoint,t),n.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,n,o,t)}_cancellableGoTo(e,t,i,n){const o=()=>e===this._gotoTask;return(0,H.qr)(i,n).finally((()=>{o()&&(t.done||t.stop())}))}};(0,n._)([(0,o.MZ)({constructOnly:!0})],Ci.prototype,"view",void 0),Ci=(0,n._)([(0,r.$)("esri.views.2d.GoToManager")],Ci);var Ri,Ei=i(22848),Ii=i(5632),Vi=i(11352),Di=i(5262);let Li=Ri=class extends(Ii.A.NumericIdentifiableMixin(Z.A)){constructor(e){super(e),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(null==this.geometry||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return(0,y.project)(this.geometry,this.spatialReference)}catch(e){return a.A.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:e}),null}return this.geometry}constrain(e,t){if(null==this.normalizedGeometry)return e;const i=e.targetGeometry;if("extent"===this.normalizedGeometry.type?(0,Vi.qz)(this.normalizedGeometry,i):(0,Vi.m3)(this.normalizedGeometry,i))return e;const{coordinate:n}=function(e,t){const{spatialReference:i}=t,n=[t.x,t.y];let o,s,a,r;const l=[0,0],h=function(e){switch(e.type){case"extent":return[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]];case"polygon":return e.rings;case"polyline":return e.paths}}(e);for(let d=0;d<h.length;d++){const e=h[d];for(let t=0;t<e.length-1;t++){(0,Di.B1)(l,n,e,t);const i=(0,ii.Io)(n,l);(null==o||i<o)&&(o=i,s=[...l],a=d,r=t)}}if(null==o||!s||null==a||null==r)throw new d.A("nearest-coordinate:failed","Failed to find the nearest coordinate");const[c,p]=s;return{coordinate:new mi.A({x:c,y:p,spatialReference:i}),distance:o}}(this.normalizedGeometry,i);return n?(e.targetGeometry=n,e):e}clone(){return new Ri({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};var Oi;(0,n._)([(0,o.MZ)({constructOnly:!0})],Li.prototype,"geometry",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Li.prototype,"normalizedGeometry",null),(0,n._)([(0,o.MZ)({constructOnly:!0})],Li.prototype,"spatialReference",void 0),Li=Ri=(0,n._)([(0,r.$)("esri.views.2d.constraints.GeometryConstraint")],Li);let zi=Oi=class extends(Ii.A.NumericIdentifiableMixin(Z.A)){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(e,t){return this.enabled&&t?(this.rotationEnabled||(e.rotation=t.rotation),e):e}clone(){return new Oi({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};(0,n._)([(0,o.MZ)()],zi.prototype,"enabled",void 0),(0,n._)([(0,o.MZ)()],zi.prototype,"rotationEnabled",void 0),zi=Oi=(0,n._)([(0,r.$)("esri.views.2d.constraints.RotationConstraint")],zi);const Fi=zi;var Ni;let Hi=Ni=class extends(Ii.A.NumericIdentifiableMixin(Z.A)){constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let e,{lods:t,minScale:i,maxScale:n,minZoom:o,maxZoom:s}=this,a=-1,r=-1,l=!1,h=!1;if(0!==i&&0!==n&&i<n&&([i,n]=[n,i]),!t?.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",n);t=t.map((e=>e.clone())),t.sort(((e,t)=>t.scale-e.scale)),t.forEach(((e,t)=>e.level=t));for(const c of t)!l&&i>0&&i>=c.scale&&(a=c.level,l=!0),!h&&n>0&&n>=c.scale&&(r=e?e.level:-1,h=!0),e=c;-1===o&&(o=0===i?0:a),-1===s&&(s=0===n?t.length-1:r),o=Math.max(o,0),o=Math.min(o,t.length-1),s=Math.max(s,0),s=Math.min(s,t.length-1),o>s&&([o,s]=[s,o]),i=t[o].scale,n=t[s].scale,t.splice(0,o),t.splice(s-o+1,t.length),t.forEach(((e,t)=>{this._lodByScale[e.scale]=e,this._scales[t]=e.scale})),this._set("effectiveLODs",t),this._set("effectiveMinZoom",o),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",n)}constrain(e,t){if(t&&e.scale===t.scale)return e;const i=this.effectiveMinScale,n=this.effectiveMaxScale,o=e.targetGeometry,s=t&&t.targetGeometry,a=0!==n&&e.scale<n,r=0!==i&&e.scale>i;if(a||r){const a=r?i:n;if(t&&s){const i=(a-t.scale)/(e.scale-t.scale);o.x=s.x+(o.x-s.x)*i,o.y=s.y+(o.y-s.y)*i}e.scale=a}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),i=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(i>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const i=Math.floor(e),n=Math.ceil(e);return t[i]+(e-i)*(t[n]-t[i])}scaleToZoom(e){if(!this.effectiveLODs)return-1;const t=this._scales;let i,n;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let o=0;o<t.length-1;o++){if(i=t[o],n=t[o+1],n===e)return o+this.effectiveMinZoom+1;if(i>e&&n<e)return o+this.effectiveMinZoom+1-(e-n)/(i-n)}return-1}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i+1)}snapToPreviousScale(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i-1)}clone(){return new Ni({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce(((t,i)=>Math.abs(i-e)<=Math.abs(t-e)?i:t),this._scales[0])),this._lodByScale[e].scale}};(0,n._)([(0,o.MZ)({readOnly:!0})],Hi.prototype,"effectiveLODs",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Hi.prototype,"effectiveMinZoom",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Hi.prototype,"effectiveMaxZoom",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Hi.prototype,"effectiveMinScale",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Hi.prototype,"effectiveMaxScale",void 0),(0,n._)([(0,o.MZ)()],Hi.prototype,"lods",void 0),(0,n._)([(0,o.MZ)()],Hi.prototype,"minZoom",void 0),(0,n._)([(0,o.MZ)()],Hi.prototype,"maxZoom",void 0),(0,n._)([(0,o.MZ)()],Hi.prototype,"minScale",void 0),(0,n._)([(0,o.MZ)()],Hi.prototype,"maxScale",void 0),(0,n._)([(0,o.MZ)()],Hi.prototype,"snapToZoom",void 0),Hi=Ni=(0,n._)([(0,r.$)("esri.views.2d.constraints.ZoomConstraint")],Hi);const Gi=Hi,Wi={base:null,key:"type",typeMap:{extent:te.A,polygon:_.A}};let Ui=class extends Z.A{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new h.A}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new Li({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new Fi({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,n=this.maxZoom,o=this.minScale,s=this.maxScale,a=this.snapToZoom;return e&&e.lods===t&&e.minZoom===i&&e.maxZoom===n&&e.minScale===o&&e.maxScale===s&&e.snapToZoom===a?e:new Gi({lods:t,minZoom:i,maxZoom:n,minScale:o,maxScale:s,snapToZoom:a})}canZoomInTo(e){const t=this.effectiveMaxScale;return 0===t||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return 0===t||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),this.customConstraints.forEach((i=>i.constrain(e,t))),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach((t=>t.applyPanConstraint?.(e))),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};(0,n._)([(0,o.MZ)({readOnly:!0})],Ui.prototype,"effectiveLODs",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Ui.prototype,"effectiveMinScale",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Ui.prototype,"effectiveMaxScale",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Ui.prototype,"effectiveMinZoom",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Ui.prototype,"effectiveMaxZoom",null),(0,n._)([(0,o.MZ)({types:Wi,value:null})],Ui.prototype,"geometry",null),(0,n._)([(0,o.MZ)({type:[Ei.A]})],Ui.prototype,"lods",void 0),(0,n._)([(0,o.MZ)()],Ui.prototype,"minScale",void 0),(0,n._)([(0,o.MZ)()],Ui.prototype,"maxScale",void 0),(0,n._)([(0,o.MZ)()],Ui.prototype,"minZoom",void 0),(0,n._)([(0,o.MZ)()],Ui.prototype,"maxZoom",void 0),(0,n._)([(0,o.MZ)()],Ui.prototype,"rotationEnabled",void 0),(0,n._)([(0,o.MZ)()],Ui.prototype,"snapToZoom",void 0),(0,n._)([(0,o.MZ)({type:h.A})],Ui.prototype,"customConstraints",void 0),(0,n._)([(0,o.MZ)()],Ui.prototype,"view",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],Ui.prototype,"version",null),(0,n._)([(0,o.MZ)({type:Li,readOnly:!0})],Ui.prototype,"_geometry",null),(0,n._)([(0,o.MZ)({type:Fi})],Ui.prototype,"_rotation",null),(0,n._)([(0,o.MZ)({readOnly:!0,type:Gi})],Ui.prototype,"_zoom",null),Ui=(0,n._)([(0,r.$)("esri.views.2d.MapViewConstraints")],Ui);const Bi=Ui;var qi=i(62754),$i=i(7724);let ji=class extends Z.A{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([(0,u.wB)((()=>this.constraints?.version),(e=>{this.constraints&&e&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))}),u.OH)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:t}=this.state.paddedViewState;return this.state.commitProperty("id"),new mi.A({x:e[0],y:e[1],spatialReference:t})}set center(e){if(null==e)return;if(!this.ready)return void this._set("center",e);let t;try{t=this._project(e,this.state.spatialReference)}catch(T){return void a.A.getLogger(this).error(new d.A("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:T}))}const i=this.viewpoint;(0,oi.Ji)(i,i,t),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(null==e)return;if(!e.width||!e.height)return void a.A.getLogger(this).error(new d.A("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let t;try{t=this._project(e,this.state.spatialReference)}catch(T){return void a.A.getLogger(this).error(new d.A("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:T}))}const i=this.viewpoint;(0,oi.b)(i,i,t,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const t=this.viewpoint;(0,oi.$0)(t,t,e),this.viewpoint=t}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const t=this._get("extent");return void(t&&(this._set("extent",void 0),this._set("center",t.center)))}const t=this.viewpoint;(0,oi.UR)(t,t,e),this.viewpoint=t}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(null==e)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let t,i;try{t=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?i=new d.A("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):null==e.targetGeometry&&(i=new d.A("mapview:invalid-viewpoint","geometry not defined"))}catch(E){i=new d.A("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:E})}if(i)return void a.A.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const n=new l.A({targetGeometry:new mi.A,scale:0,rotation:0});(0,oi.C)(n,t),this.constraints?.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this._set("viewpoint",n)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const t=this._get("extent");return void(t&&(this._set("extent",void 0),this._set("center",t.center)))}const t=this.constraints?.zoomToScale(e)??0;if(!t)return void this._set("zoom",-1);const i=this.viewpoint;(0,oi.UR)(i,i,t),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:t,constraints:i}=this,n=this._get("center"),o=this._get("extent"),s=this._get("scale"),a=this._get("rotation"),r=this._get("viewpoint"),l=this._get("zoom"),h=null!=l&&null!=i&&i.zoomToScale(l)||void 0;let c,d,p;const u=r?.rotation,g=r?.targetGeometry;"extent"===g?.type?c=g:"point"===g?.type&&(d=g,p=r?.scale);const m=o??c;return{center:n??d??m?.center,rotation:a??u,scale:(s??h??p??(m&&(0,oi.AU)(m,[e[0]-t.left-t.right,e[1]-t.top-t.bottom])))||void 0}}startup(e,t,i,n){const o=e.targetGeometry;try{this._project(e,i)}catch(s){a.A.getLogger(this).warn(new qi.A("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:o.toJSON(),spatialReference:i,error:s})),e.targetGeometry=n||new mi.A({x:0,y:0,spatialReference:i})}this.constraints?.fit(e),this._set("state",new Ti({padding:this.padding,size:t,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,t],spatialReference:i,rotation:n,scale:o}=this.state.paddedViewState,s=new mi.A({x:e,y:t,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",s),this._set("zoom",-1),this._set("rotation",n),this._set("scale",o),this._set("state",null)}changeSpatialReference(e){const t=this.state.paddedViewState.clone();if(null==this._scaleBeforeChangingSpatialReference)this._scaleBeforeChangingSpatialReference=t.scale;else{const e=t.viewpoint.clone();e.scale=this._scaleBeforeChangingSpatialReference,t.viewpoint=e}const i=t.clone(),[n,o]=t.center;let r=null;try{r=this._project(new mi.A({x:n,y:o,spatialReference:t.spatialReference}),e)}catch(b){(0,$i.i)()||a.A.getLogger(this).warn(new qi.A("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:r?.toJSON(),spatialReference:e,error:b}))}r||(r=new mi.A({x:0,y:0,spatialReference:e}));const h=(0,oi.Ji)(new l.A({targetGeometry:new mi.A,scale:0,rotation:0}),t.viewpoint,r);i.viewpoint=h;try{const n=20,o=[t.size[0]/2,t.size[1]/2],a=[o[0]+n,o[1]],r=t.toMap([0,0],a),{x:l,y:c}=this._project(new mi.A({x:r[0],y:r[1],spatialReference:t.spatialReference}),e);r[0]=l,r[1]=c,i.toScreen(r,r);const d=(0,oi.s5)(o,r,a),p=Math.hypot(r[0]-o[0],r[1]-o[1])/n;!Number.isFinite(p)||Math.abs(p)>4?(h.rotation=0,h.targetGeometry=new mi.A({x:0,y:0,spatialReference:e})):(h.scale*=p,h.scale>(0,s.A)("mapview-srswitch-adjust-rotation-scale-threshold")?h.rotation=0:h.rotation+=Number.isFinite(d)?d:0)}catch{}this._get("constraints")?.constrain(h,void 0),this._get("state").viewpoint=h}resize(e,t){if(!this.ready)return;const i=this.state;let n=this.state.paddedViewState.viewpoint;const o=this.state.paddedViewState.size.slice();i.size=[e,t],(0,oi.XR)(n,n,o,this.state.paddedViewState.size,this.resizeAlign),n=this.constraints?.constrain(n,void 0)??n,this.state.viewpoint=n}toMap(e){if(!this.ready)return null;const[t,i]=this.state.toMap([0,0],[e.x,e.y]),n=this.state.spatialReference;return new mi.A({x:t,y:i,spatialReference:n})}toScreen(e,t){if(!this.ready)return null;const i=this._project(e,this.state.spatialReference),n=[i.x,i.y];return!1===t?.pickClosestTarget||this.state.paddedViewState.wrapMapCoordinate(n,n),this.state.toScreen(n,n),(0,we.tc)(n[0],n[1])}_project(e,t){const i=e?.targetGeometry||e;if(!t)return e;if(!i)return null;if(t.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem)return e;if((0,oe.aI)(t,i.spatialReference))return e;const n=(0,y.project)(i,t);if(!n)throw new d.A("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:t});return function(e){return"esri.Viewpoint"===e?.declaredClass}(e)?(e.targetGeometry=n,e):n}};function Ki(e,t){switch(t){case"primary":return"touch"===e.pointerType||0===e.button;case"secondary":return"touch"!==e.pointerType&&2===e.button;case"tertiary":return"touch"!==e.pointerType&&1===e.button}}function Xi(e,t){return t.some((t=>Ki(e,t)))}function Yi(e,t){let{dragPrimary:i,dragSecondary:n,dragTertiary:o}=t;return[{key:"primary",value:i},{key:"secondary",value:n},{key:"tertiary",value:o}].filter((t=>t.value===e)).map((e=>e.key))}(0,n._)([(0,o.MZ)({type:mi.A})],ji.prototype,"center",null),(0,n._)([(0,o.MZ)()],ji.prototype,"constraints",void 0),(0,n._)([(0,o.MZ)({type:te.A})],ji.prototype,"extent",null),(0,n._)([(0,o.MZ)({value:{top:0,right:0,bottom:0,left:0},cast:e=>({top:0,right:0,bottom:0,left:0,...e})})],ji.prototype,"padding",null),(0,n._)([(0,o.MZ)()],ji.prototype,"ready",void 0),(0,n._)([(0,o.MZ)()],ji.prototype,"resizeAlign",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],ji.prototype,"resolution",null),(0,n._)([(0,o.MZ)({type:Number})],ji.prototype,"rotation",null),(0,n._)([(0,o.MZ)({type:Number})],ji.prototype,"scale",null),(0,n._)([(0,o.MZ)({readOnly:!0})],ji.prototype,"state",void 0),(0,n._)([(0,o.MZ)({type:l.A})],ji.prototype,"viewpoint",null),(0,n._)([(0,o.MZ)({readOnly:!0})],ji.prototype,"visibleArea",null),(0,n._)([(0,o.MZ)()],ji.prototype,"zoom",null),ji=(0,n._)([(0,r.$)("esri.views.2d.ViewStateManager")],ji);class Ji extends He.l{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,(e=>this._handleDoubleClick(e,t)))}_handleDoubleClick(e,t){Ki(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}}class Qi extends He.l{constructor(e,t,i){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",i,(e=>this._handleDoubleTapDrag(e)))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:i}=t;if(i!==this.pointerType)return;e.stopPropagation();const{action:n,delta:o}=t,{view:s}=this,{mapViewNavigation:a}=s;switch(n){case"begin":{const{scale:e}=s;this._startScale=e,this._currentScale=e,this._previousDelta=o,a.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const e=1.015**o.y,t=this._startScale*e,i=t/this._currentScale;a.setViewpointImmediate(i),this._currentScale=t;break}case"end":{const{constraints:e}=s,{effectiveLODs:t,snapToZoom:i}=e;if(!i||!t)return void a.end();const n=e.snapScale(this._currentScale),r=(o.y>0?Math.max(n,e.snapToPreviousScale(this._startScale)):Math.min(n,e.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(r).then((()=>{a.end()}));break}}}}class en{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,i=t.pointers.size;switch(t.action){case"start":this._currentCount=i,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}}class tn extends He.l{constructor(e,t,i){super(!0),this.view=e,this.pointerActions=t,this.registerIncoming("drag",i,(e=>this._handleDrag(e))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()))}onInstall(e){super.onInstall(e),this._dragEventSeparator=new en({start:(e,t)=>{this.view.mapViewNavigation.pan.begin(this.view,t.data),t.stopPropagation()},update:(e,t)=>{this.view.mapViewNavigation.pan.update(this.view,t.data),t.stopPropagation()},end:(e,t)=>{this.view.mapViewNavigation.pan.end(this.view,t.data),t.stopPropagation()},condition:(e,t)=>1===e&&Xi(t.data,this.pointerActions)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}}class nn extends He.l{constructor(e,t,i){super(!0),this._view=e,this.pointerActions=t;const n=this._view.mapViewNavigation;this._dragEventSeparator=new en({start:(e,t)=>{n.rotate.begin(this._view,t.data),t.stopPropagation()},update:(e,t)=>{n.rotate.update(this._view,t.data),t.stopPropagation()},end:(e,t)=>{n.rotate.end(),t.stopPropagation()},condition:(e,t)=>1===e&&Xi(t.data,this.pointerActions)}),this.registerIncoming("drag",i,(e=>this._dragEventSeparator.handle(e)))}}var on=i(20664);function sn(e){let t=e*e;return e<0&&(t*=-1),t}class an extends He.l{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Y.A,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",(e=>this._handleGamePadEvent(e))),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([(0,u.wB)((()=>this._view.navigation.gamepad?.enabled),(e=>{e?(this._handle.resume(),this._frameTask||(this._frameTask=(0,P.mg)({update:e=>this._frameUpdate(e.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))}),u.Vh)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||("end"===e.data.action?(this._currentDevice=null,function(e){e.translation[0]=0,e.translation[1]=0,e.translation[2]=0,e.heading=0,e.tilt=0}(this._transformation)):(this._currentDevice=e.data.device,function(e,t,i){const n=i,o=e.state,s=e.device,a="forward-down"===t.tiltDirection?1:-1;"standard"===s.deviceType?(n.translation[0]=sn(o.axes[0]),n.translation[1]=sn(o.axes[1]),n.translation[2]=sn(o.buttons[7])-sn(o.buttons[6]),n.heading=sn(o.axes[2]),n.tilt=sn(o.axes[3])):"spacemouse"===s.deviceType&&(n.translation[0]=1.2*sn(o.axes[0]),n.translation[1]=1.2*sn(o.axes[1]),n.translation[2]=2*-sn(o.axes[2]),n.heading=1.2*sn(o.axes[5]),n.tilt=1.2*sn(o.axes[3])),n.tilt*=a,(0,on.h)(n.translation,n.translation,1)}(e.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(e){const t=this._transformation;if(function(e){return 0===e.translation[0]&&0===e.translation[1]&&0===e.translation[2]&&0===e.heading&&0===e.tilt&&0===e.zoom}(t))return void this._frameTask?.pause();const i=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,o=ln*n*e;(0,oi.aA)(i,i,[t.translation[0]*o,-t.translation[1]*o]);const s=1+t.translation[2]*hn*e,a=this._view.constraints.rotationEnabled?-t.heading*rn*e:0,r=this._view.size,l=[r[0]/2,r[1]];(0,oi.WK)(i,i,s,a,l,r);const h=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=h}}const rn=.06,ln=.7,hn=6e-4;function cn(e){const t=()=>e("visible"===document.visibilityState);return document.addEventListener("visibilitychange",t),(0,k.hA)((()=>document.removeEventListener("visibilitychange",t)))}class dn extends He.l{constructor(e,t,i){super(!0),this.view=e,this.keys=t,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=e=>{const t=this._keyMap[e.data.key];if(e.modifiers.has("Meta")||e.modifiers.has("Control"))return void this._stopMovement();if(null==t)return;e.stopPropagation(),e.preventDefault();const i="key-down"===e.type;if(this._pressedKeys[i?"add":"delete"](t),i){if(this._direction===t)return;this._direction=t,this._isSticky=!1,this._setTimeout((()=>{this._isSticky&&this._handlePopKey()}))}else{const e=void 0===this._timeout,t=this._pressedKeys.size>0;e||t?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),null==this._direction&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=cn((e=>e?null:this._stopMovement()))}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const t=null!=this._currentDirection;if(null!=e){if(t||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else t&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=void 0===e?void 0:setTimeout((()=>{this._timeout=void 0,e()}),this._stickyKeyDuration)}}class pn extends He.l{constructor(e,t,i){super(!0),this.view=e,this.keys=t,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(t),this.registerIncoming("key-down",i,(e=>this._handleKeyDown(e))),this.registerIncoming("key-up",i,(e=>this._handleKeyUp(e))),this.registerIncoming("blur",i,(()=>this._handleStop())),this._visibilityHandle=cn((e=>e?null:this._handleStop()))}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,t){for(const i of e)this._keyToDirection.set(i,t)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const i=e.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection.get(e.data.key);if(this._pressed=null!=n,this._pressed){if(e.preventDefault(),t)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}}var un;!function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"}(un||(un={}));class gn extends He.l{constructor(e,t,i){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",i,(e=>this._handleKeyDown(e))),t.zoomIn.forEach((e=>this._keysToZoomAction[e]=un.IN)),t.zoomOut.forEach((e=>this._keysToZoomAction[e]=un.OUT))}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:i}=e.data;if(!(i in this._keysToZoomAction))return;const n=this._keysToZoomAction[i],{mapViewNavigation:o}=this.view;let s=null;switch(n){case un.IN:s=o.zoomIn();break;case un.OUT:s=o.zoomOut();break;default:return}o.begin(),s.then((()=>o.end())),e.stopPropagation()}}class mn extends He.l{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,(e=>this._handleMouseWheel(e)))}_handleMouseWheel(e){if("zoom"!==this._view.navigation.actionMap.mouseWheel)return;if(e.preventDefault(),e.stopPropagation(),!this._canZoom)return;const t=this._view.mapViewNavigation,{x:i,y:n,deltaY:o}=e.data,s=1/.6**(1/60*o),a=t.zoom(s,[i,n]);a&&(this._canZoom=!1,a.catch((()=>{})).then((()=>{this._canZoom=!0,t.end()})))}}class fn extends He.l{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",(e=>this._handleDrag(e))),this.registerIncoming("pointer-down",(()=>this._stopMomentumNavigation()));const t=this.view.mapViewNavigation;this._dragEventSeparator=new en({start:(e,i)=>{t.pinch.begin(this.view,i.data),i.stopPropagation()},update:(e,i)=>{t.pinch.update(this.view,i.data),i.stopPropagation()},end:(e,i)=>{t.pinch.end(this.view),i.stopPropagation()},condition:e=>e>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}}function _n(e){const t=e.native;return t?{buttons:t.buttons.map((e=>e.pressed?e.value||1:0)),axes:t.axes.map((t=>function(e,t){const i=Math.abs(e);return i<t?0:Math.sign(e)*(i-t)/(1-t)}(t,e.axisThreshold)))}:{buttons:[],axes:[]}}class yn{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=e=>{this._connectGamepad(e.gamepad)},this._onDisconnectGamepad=e=>{const t=e.gamepad,i=t.index,n=this._inputDevices[i];n&&(this._emitGamepadEvent(t,_n(n),!1),this._inputDevices.splice(i,1),this._latestUpdate.splice(i,1),this._input.gamepad.devices.remove(n),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(wn((e=>this._connectGamepad(e))),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new Tt(e);"unknown"!==t.deviceType&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){null==this._frameTask&&(this._frameTask=(0,P.mg)({update:()=>this._readGamepadState()}))}_stopPolling(){null!=this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),i="document"===this._input.gamepad.enabledFocusMode&&!e||"view"===this._input.gamepad.enabledFocusMode&&!t;wn((e=>{const t=this._inputDevices[e.index];if(!t)return;const n=this._latestUpdate[e.index],o=_n(t),s=i||function(e){for(let t=0;t<e.axes.length;t++)if(0!==e.axes[t])return!1;for(let t=0;t<e.buttons.length;t++)if(0!==e.buttons[t])return!1;return!0}(o);if(n){if(n.timestamp===e.timestamp)return;if(!n.active&&s)return;if(function(e,t){if(e.axes.length!==t.axes.length)return!1;if(e.buttons.length!==t.buttons.length)return!1;for(let i=0;i<e.axes.length;i++)if(e.axes[i]!==t.axes[i])return!1;for(let i=0;i<e.buttons.length;i++)if(e.buttons[i]!==t.buttons[i])return!1;return!0}(n.state,o))return}this._emitGamepadEvent(e,o,!s)}))}_emitGamepadEvent(e,t,i){const n=this._latestUpdate[e.index],o=n&&n.active;if(!o&&!i)return;const s=!o&&i?"start":o&&i?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:i},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:s})}}function vn(e){if(!e)return!1;if(!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}function wn(e){for(const t of navigator.getGamepads())vn(t)&&e(t)}const Mn=(0,s.A)("edge"),bn=(0,s.A)("chrome"),xn=(0,s.A)("ff"),Tn=(0,s.A)("safari"),Sn="esri-view-surface",An={touchNone:`${Sn}--touch-none`,touchPan:`${Sn}--touch-pan`};class kn{constructor(e,t){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new yn(e,t),this._gamepadSource.onEvent=e=>this._callback("gamepad",e)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach((e=>this._releasePointerCaptureSafe(e))),this._activePointerCaptures.clear(),this._gamepadSource=(0,p.pR)(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const e=this._active[t];this._element.removeEventListener(Pn[t],e),delete this._active[t]}e&&e.forEach((e=>{if(!this._active[e]&&Pn[e]){const t=(this._eventHandlers[e]||this._handleDefault).bind(this,e);this._element.addEventListener(Pn[e],t),this._active[e]=t}})),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,t){t?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?An.touchNone:An.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?An.touchPan:An.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(An.touchNone),this._element.classList.remove(An.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch(se){}}_updateNormalizedPointerLikeEvent(e,t){const i=(0,dt.Uo)(this._element,e);return kn.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),t.x=i.x,t.y=i.y,t}_handleKey(e,t){const{key:i}=t;i&&"key-up"===e&&this._keyDownState.delete(i);const n={native:t,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&"key-down"===e&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,t){const i=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,i)}_handlePointerPreventDefault(e,t){const i=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,i)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&(0,s.A)("mac")&&0===e.deltaY?e.deltaX:e.deltaY}_handleMouseWheel(e,t){let i=this._getDeltaFromTrackpadOrMouseWheel(t);switch(t.deltaMode){case 0:Mn&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}Mn?i*=.7:bn||Tn?i*=.6:xn&&(i*=1.375);const n=Math.abs(i);n>100&&(i=i/n*200/(1+Math.exp(-.02*(n-100))));const o=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:i});this._callback(e,o)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const i={native:t};t.preventDefault(),this._callback(e,i)}_preventAltKeyDefault(e){"Alt"===e.key&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}}kn.test={disableSubpixelCoordinates:!1};const Pn={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};class Zn extends He.l{constructor(){super(!0),this.registerIncoming("context-menu",(e=>e.data.native.preventDefault()))}}const Cn=300,Rn=1.5,En=6,In=6,Vn=500,Dn=250,Ln=10,On=350,zn=35;function Fn(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function Nn(e){const{native:t}=e,{pointerId:i,button:n,pointerType:o}=t;return"mouse"===o?`${i}:${n}`:`${o}`}class Hn extends He.l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ln,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:On,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zn,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fe.p;super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=o,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=(0,we.tc)(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new en({start:(e,t)=>this._dragStart(e,t),update:(e,t)=>this._dragUpdate(t),end:(e,t)=>this._dragEnd(t)}),this.registerIncoming("drag",(e=>this._dragEventSeparator.handle(e))),this.registerIncoming("pointer-down",(e=>this._handlePointerDown(e))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((e=>{e.doubleTapTimeout=(0,p.xt)(e.doubleTapTimeout)}))}get hasPendingInputs(){for(const e of this._pointerState.values())if(null!=e.doubleTapTimeout)return!0;return!1}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=(0,p.xt)(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,t){if(!this._doubleTapDragReady||1!==e)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:n}=t,{center:o}=i;this._dragStartCenter=o;const s=Gn("begin",(0,we.tc)(0,0),i);this._doubleTapDrag.emit(s,void 0,n),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:i}=e,{center:n}=t,o=Gn("update",(0,we.tc)(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),t);this._doubleTapDrag.emit(o,void 0,i),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:i}=e,{center:n}=t,o=Gn("end",(0,we.tc)(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),t);this._doubleTapDrag.emit(o,void 0,i),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,i=Nn(t),n=this._pointerState.get(i),{pointerType:o}=t.native;if(n){const s="touch"===o?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(i),Fn(n.event.data,t)>s?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:i}=t.native,n=Nn(t),o="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,s=this._clock.setTimeout((()=>this._clearPointerDown(n)),o);this._pointerState.set(n,{event:e,doubleTapTimeout:s}),this.refreshHasPendingInputs()}}function Gn(e,t,i){const{button:n,buttons:o,pointer:s,pointers:a,pointerType:r,timestamp:l}=i;return{action:e,delta:t,button:n,buttons:o,pointer:s,pointers:a,pointerType:r,timestamp:l}}var Wn,Un=i(91417);class Bn extends He.l{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,i,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:n,pointers:jn(this._activePointerMap),pointer:t,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(e){const t=e.native.pointerId,i=$n(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,n);const o=Kn(n,qn(this._activePointerMap));n.initialAngle=o,n.lastAngle=o,this._updatePointerAngles(i)}_updatePointer(e){if(e&&null==e.x&&null==e.y)return;const t=e.native.pointerId,i=this._activePointerMap.get(t);i?i.event=e:this._addPointer(e)}_removePointer(e){const t=$n(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=$n(this._activePointerMap);this._activePointerMap.forEach((i=>{i.initialAngle=Kn(i,t)-e,i.lastAngle=Kn(i,t)-e}))}_emitEvent(e,t,i){const n=$n(this._activePointerMap);this._drag.emit(this._createPayload(e,t,n,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,i=(0,Un.l5)(e.timestamp);this._activePointerMap.get(t)&&(1===this._activePointerMap.size?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,(0,Un.l5)(e.timestamp))))}_handlePointerDrag(e){const t=e.data,i=t.currentEvent,n=(0,Un.l5)(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,n)):(this._addPointer(i),this._emitEvent("added",i,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&"touch"===this._pointerType&&1===this._activePointerMap.size}}function qn(e){const t=[];return e.forEach((e=>{t.push((0,we.tc)(e.event.x,e.event.y))})),function(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:(0,we.tc)()},0===e.length)return t;if(1===e.length)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(2===e.length){const[i,n]=e,[o,s]=[n.x-i.x,n.y-i.y];return t.radius=Math.sqrt(o*o+s*s)/2,t.center.x=(i.x+n.x)/2,t.center.y=(i.y+n.y)/2,t}let i=0,n=0;for(let v=0;v<e.length;v++)i+=e[v].x,n+=e[v].y;i/=e.length,n/=e.length;const o=e.map((e=>e.x-i)),s=e.map((e=>e.y-n));let a=0,r=0,l=0,h=0,c=0,d=0,p=0;for(let v=0;v<o.length;v++){const e=o[v],t=s[v],i=e*e,n=t*t;a+=i,r+=n,l+=e*t,h+=i*e,c+=n*t,d+=e*n,p+=t*i}const u=.5*(h+d),g=.5*(c+p),m=a*r-l*l,f=(u*r-g*l)/m,_=(a*g-l*u)/m,y=(0,we.tc)(f+i,_+n);return{radius:Math.sqrt(f*f+_*_+(a+r)/e.length),center:y}}(t)}function $n(e){const t=qn(e);let i=0;return e.forEach((e=>{let n=Kn(e,t),o=n-e.lastAngle;for(;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;n=e.lastAngle+o,e.lastAngle=n;const s=n-e.initialAngle;i+=s})),i/=e.size||1,{angle:i,radius:t.radius,center:t.center}}function jn(e){const t=new Map;return e.forEach(((e,i)=>t.set(i,e.event))),t}function Kn(e,t){const i=e.event,n=i.x-t.center.x,o=i.y-t.center.y;return Math.atan2(o,n)}!function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right",e[e.Back=3]="Back",e[e.Forward=4]="Forward",e[e.Undefined=-1]="Undefined"}(Wn||(Wn={}));class Xn extends He.l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ln,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:On,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zn,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fe.p;super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=o,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach((e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()})),super.onUninstall()}_handlePointerDown(e){const t=e.data,i=Nn(t);if(!this._pointerState.has(i)){const e={downButton:t.native.button,x:t.x,y:t.y,immediateDoubleClick:null};this._pointerState.set(i,e),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,i=Nn(t),n=this._pointerState.get(i);if(n&&n.downButton===t.native.button){const i=n.immediateDoubleClick,o="touch"===e.data.native.pointerType?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;i?(i.timeoutHandle.remove(),Fn(i,e.data)>o?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,i.modifiers),this._removeState(t))):Fn(n,e.data)>o?this._removeState(t):this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,t){const i="touch"===e.data.native.pointerType?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(e.data)),i)}}_removeState(e){const t=Nn(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}}class Yn extends He.l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rn,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:En,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:In,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Vn,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Fe.p;super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=t,this._movementUntilPenDrag=i,this._movementUntilTouchDrag=n,this._holdDelay=o,this._clock=s,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",(e=>this._handlePointerDown(e))),this.registerIncoming("pointer-up",(e=>this._handlePointerLoss(e,"pointer-up"))),this.registerIncoming("pointer-capture-lost",(e=>this._handlePointerLoss(e,"pointer-capture-lost"))),this.registerIncoming("pointer-cancel",(e=>this._handlePointerLoss(e,"pointer-cancel"))),this._moveHandle=this.registerIncoming("pointer-move",(e=>this._handlePointerMove(e))),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((e=>{e.holdTimeout=(0,p.xt)(e.holdTimeout)})),super.onUninstall()}_handlePointerDown(e){const t=e.data,i=t.native.pointerId;let n=null;0===this._pointerState.size&&(n=this._clock.setTimeout((()=>{const t=this._pointerState.get(i);if(t){if(!t.isDragging){const i=t.previousEvent;this._pointerHold.emit(i,void 0,e.modifiers),t.holdEmitted=!0}t.holdTimeout=null}}),this._holdDelay));const o={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,o),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const t=e.data,i=t.native.pointerId,n=this._pointerState.get(i);n&&(n.isDragging?this._pointerDrag.emit(Jn("update",n,t),void 0,n.modifiers):function(e,t){const i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)}(t,n.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),n.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const t=e.data,i=t.native.pointerId;this._pointerState.forEach((n=>{null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(Jn("start",n,t)):this._pointerDrag.emit(Jn("start",n,n.previousEvent),e.timestamp))}))}_handlePointerLoss(e,t){const i=e.data,n=i.native.pointerId,o=this._pointerState.get(n);o&&(null!=o.holdTimeout&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(Jn("end",o,"pointer-up"===t?i:o.previousEvent),void 0,o.modifiers):"pointer-up"===t&&o.downButton===i.native.button&&e.timestamp-o.startTimestamp<=this._maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(n),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause())}}function Jn(e,t,i){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:i}}class Qn extends He.l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ln,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:On,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zn,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fe.p;super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=o,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",(e=>this._handleImmediateClick(e))),this.registerIncoming("pointer-down",(e=>this._handlePointerDown(e)))}onUninstall(){this._pointerState.forEach((e=>e.doubleClickTimer=(0,p.xt)(e.doubleClickTimer)))}get hasPendingInputs(){for(const e of this._pointerState.values())if(null!=e.doubleClickTimer)return!0;return!1}_clearDoubleClickTimer(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimer=(0,p.xt)(i.doubleClickTimer),t&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);1===t.pointerDownCount&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const t=e.data,{pointerType:i}=t.native,n=function(e){const{pointerId:t,pointerType:i,button:n}=e.native;return"mouse"===i?`${t}:${n}`:`${i}`}(t);if(!this._pointerState.has(n))return void this._startClick(e);const o=this._pointerState.get(n),{data:s,modifiers:a}=o.event,r="touch"===i?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Fn(s,t)>r?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),2===o.pointerDownCount&&this._doubleClick.emit(s,void 0,a))}_handlePointerDown(e){const t=Nn(e.data),i=this._pointerState.get(t);i&&(i.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:i}}=t,n=Nn(t),o="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,s=this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(n)),o);this._pointerState.set(n,{event:e,doubleClickTimer:s,pointerDownCount:1}),this.refreshHasPendingInputs()}}const eo="Control",to={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},io={zoomIn:["=","+"],zoomOut:["-","_"]},no={clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]},oo=Symbol("handles");let so=class extends Z.A{initialize(){const e=()=>this.view?.ready;this.addHandles([(0,u.z7)((()=>!e()),(()=>this._disconnect())),(0,u.z7)(e,(()=>this._connect()))])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(oo),this._inputManager=(0,p.pR)(this._inputManager)}_connect(){const e=this.view.surface,t=new kn(e,this.view.input),i=[new Xn,new Yn,new Qn,new Bn(this.view.navigation),new Hn],n=new G.e({eventSource:t,recognizers:i}),o=new tn(this.view,["primary"]),s=new nn(this.view,["secondary"]);n.installHandlers("prevent-context-menu",[new Zn],G.o.INTERNAL),n.installHandlers("navigation",[new fn(this.view),new an(this.view),new mn(this.view),new Ji(this.view),new Ji(this.view,[eo]),o,new dn(this.view,to),new gn(this.view,io),new pn(this.view,no),s,new Qi(this.view,"touch")],G.o.INTERNAL),this.view.viewEvents.connect(n),this._source=t,this._inputManager=n,this.addHandles([(0,u.wB)((()=>this.view?.navigation?.browserTouchPanEnabled),(e=>{this._source&&(this._source.browserTouchPanningEnabled=!e)}),u.Vh),(0,u.wB)((()=>{const{actionMap:e}=this.view.navigation;return{panActions:Yi("pan",e),rotateActions:Yi("rotate",e)}}),(e=>{let{panActions:t,rotateActions:i}=e;o.pointerActions=t,s.pointerActions=i}),u.pc)],oo)}get test(){}};(0,n._)([(0,o.MZ)()],so.prototype,"view",void 0),(0,n._)([(0,o.MZ)()],so.prototype,"latestPointerType",null),(0,n._)([(0,o.MZ)()],so.prototype,"latestPointerLocation",null),(0,n._)([(0,o.MZ)()],so.prototype,"multiTouchActive",null),so=(0,n._)([(0,r.$)("esri.views.2d.input.MapViewInputManager")],so);const ao=so;let ro=class extends Z.A{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),null==this._timer&&(this._timer=setInterval((()=>{performance.now()-this._timestamp>=160&&this.clear()}),160))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};(0,n._)([(0,o.MZ)()],ro.prototype,"_timer",void 0),(0,n._)([(0,o.MZ)()],ro.prototype,"stationary",null),ro=(0,n._)([(0,r.$)("esri.views.2d.support.StationaryManager")],ro);const lo=e=>{let t=class extends e{constructor(){super(...arguments),this.fullOpacity=1,this.stateManager=new ji({constraints:new Bi({view:this})}),this.goToManager=new Ci({view:this}),this.stationaryManager=new ro,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new ki(this),this.inputManager=new ao({view:this}),this.viewEvents=new Be(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([(0,u.wB)((()=>this.viewpoint),(()=>this.stationaryManager.flip()),u.OH),this.on("resize",(e=>this.stateManager.resize(e.width,e.height)))])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(e){this.stateManager.extent=e}get state(){return this.stateManager.state}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}set animation(e){const t=this._get("animation");if(e===t)return;if(t&&t.stop(),e!==this.animationManager.animation&&this.animationManager.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e);const i=()=>{this.destroyed||e===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};e.when(i,i)}get constraints(){return this.stateManager?.constraints}set constraints(e){e.view=this;const t=this.stateManager.constraints;this.stateManager.constraints=e,t?.destroy()}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(e){this.stateManager.resizeAlign=e}get rotation(){return this.stateManager.rotation??0}set rotation(e){const{rotationEnabled:t}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=e,this.constraints.rotationEnabled=t}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(e){this.stateManager.viewpoint=e,this.frameTask.requestFrame()}on(e,t,i,n){return this.inputManager&&this.viewEvents.on(e,t,i,n)||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}goTo(e,t){return this.goToManager.goTo(e,t)}};return(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"animationManager",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"fullOpacity",void 0),(0,n._)([(0,o.MZ)()],t.prototype,"stateManager",void 0),(0,n._)([(0,o.MZ)()],t.prototype,"constraintsInfo",null),(0,n._)([(0,o.MZ)()],t.prototype,"extent",null),(0,n._)([(0,o.MZ)()],t.prototype,"goToManager",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"state",null),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"mapViewNavigation",void 0),(0,n._)([(0,o.MZ)()],t.prototype,"renderingOptions",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"interacting",null),(0,n._)([(0,o.MZ)()],t.prototype,"stationary",null),(0,n._)([(0,o.MZ)()],t.prototype,"animation",null),(0,n._)([(0,o.MZ)({type:Bi})],t.prototype,"constraints",null),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"inputManager",void 0),(0,n._)([(0,o.MZ)()],t.prototype,"padding",null),(0,n._)([(0,o.MZ)()],t.prototype,"resizeAlign",null),(0,n._)([(0,o.MZ)()],t.prototype,"rotation",null),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"viewEvents",void 0),(0,n._)([(0,o.MZ)({type:l.A})],t.prototype,"viewpoint",null),t=(0,n._)([(0,r.$)("esri.views.Viewport2DMixin")],t),t};var ho=i(12294);class co{constructor(e){this._view=e,this.viewpoint=new l.A({targetGeometry:new mi.A,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,t]=this._view.size;return Math.sqrt(e*e+t*t)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return(0,oi.ri)(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,t){t.pan=(0,ho.Io)(this.center,e.center);let i=Math.abs(e.rotation-this.rotation);i=i>=180?360-i:i,t.rotate=(0,Ne.kU)(i),t.sourceZoom=this.scale,t.targetZoom=e.scale}interpolate(e,t,i){const{pan:n,rotate:o,zoom:s,zoomOffset:a}=i,{center:r}=this;r.spatialReference=e.center.spatialReference,r.x=(0,Ne.Cc)(e.center.x,t.center.x,n),r.y=(0,Ne.Cc)(e.center.y,t.center.y,n),this.viewpoint.scale=(0,Ne.Cc)(e.scale,t.scale+a,s);let l=e.rotation;const h=t.rotation;Math.abs(h-l)>=180&&(l+=360*(l<h?1:-1)),this.viewpoint.rotation=(0,Ne.Cc)(l,h,o)}copyFrom(e){(0,oi.C)(this.viewpoint,e.viewpoint),this._view=e.view}}var po=i(61619);const uo=e=>e*e,go=e=>1-uo(1-e),mo=e=>e*e*e,fo=e=>1-mo(1-e),_o=e=>e*e*e*e,yo=e=>1-_o(1-e),vo=e=>e*e*e*e*e,wo=e=>1-vo(1-e),Mo=e=>1-Math.cos(e*Math.PI/2),bo=e=>1-Mo(1-e),xo=e=>2**(10*(e-1)),To=e=>1-xo(1-e),So=e=>-(Math.sqrt(1-e*e)-1),Ao=e=>1-So(1-e);function ko(e){const t=2*(e-Math.sqrt((e-1)*e)),i=t/2/e;return n=>n<i?e*n*n:t*n-t+1}function Po(e,t){return(i,n)=>i<t?t*e(i/t,n):1-e((1-i)/(1-t),n)*(1-t)}const Zo=Po(ko(1),1),Co=Po(ko(1),0),Ro=Po(ko(1),.5),Eo=Po(ko(2),1),Io=Po(ko(2),0),Vo=Po(ko(2),.5),Do=Po(ko(3),1),Lo=Po(ko(3),0),Oo=Po(ko(3),.5),zo=Po(ko(4),1),Fo=Po(ko(4),0),No=Po(ko(4),.5),Ho={linear:e=>e,"in-quad":uo,"out-quad":go,"in-out-quad":e=>e<.5?uo(2*e)/2:(go(2*(e-.5))+1)/2,"in-coast-quad":Zo,"out-coast-quad":Co,"in-out-coast-quad":Ro,"in-cubic":mo,"out-cubic":fo,"in-out-cubic":e=>e<.5?mo(2*e)/2:(fo(2*(e-.5))+1)/2,"in-coast-cubic":Eo,"out-coast-cubic":Io,"in-out-coast-cubic":Vo,"in-quart":_o,"out-quart":yo,"in-out-quart":e=>e<.5?_o(2*e)/2:(yo(2*(e-.5))+1)/2,"in-coast-quart":Do,"out-coast-quart":Lo,"in-out-coast-quart":Oo,"in-quint":vo,"out-quint":wo,"in-out-quint":e=>e<.5?vo(2*e)/2:(wo(2*(e-.5))+1)/2,"in-coast-quint":zo,"out-coast-quint":Fo,"in-out-coast-quint":No,"in-sine":Mo,"out-sine":bo,"in-out-sine":e=>e<.5?Mo(2*e)/2:(bo(2*(e-.5))+1)/2,"in-expo":xo,"out-expo":To,"in-out-expo":e=>e<.5?xo(2*e)/2:(To(2*(e-.5))+1)/2,"in-circ":So,"out-circ":Ao,"in-out-circ":e=>e<.5?So(2*e)/2:(Ao(2*(e-.5))+1)/2,ease:e=>po.Z0.ease(e),"ease-in":e=>po.Z0.easeIn(e),"ease-out":e=>po.Z0.easeOut(e),"ease-in-out":e=>po.Z0.easeInOut(e)};class Go{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}}const Wo={desiredScreenFlow:2,minDuration:(0,Un.l5)(500),maxDuration:(0,Un.l5)(8e3)},Uo={...Wo,maxDuration:(0,Un.l5)(4e3)};class Bo{constructor(e){this._createCamera=e,this.compared=new Go,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:Wo.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new Bo(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,t,i){this.source!==e&&this.source.copyFrom(e),this.target!==t&&this.target.copyFrom(t),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=i.desiredScreenFlow??Wo.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const t=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/t}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>(0,ai.FD)()}get hasFov(){return Math.abs(this.compared.fov)>(0,ai.FD)()}get hasRotate(){return this.compared.rotate>(0,ai.FD)()}}let qo=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce(((e,t)=>(0,Un.Kp)(e+t.time)),(0,Un.Kp)(0))}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),e*=this.time;let i=0,n=0;const o=this.definition,s=this.segments.reduce(((e,t)=>e||t.definition.hasZoom),!1);for(let a=0;a<this.segments.length;a++){const r=this.segments[a],l=r.definition;if(e<=r.time||a===this.segments.length-1){if(this.segmentInterpolateComponentsAt(r,0===r.time?0:e/r.time,t),o.hasPan&&!isNaN(t.pan)&&isFinite(o.compared.pan)?t.pan=(i+l.compared.pan*t.pan)/o.compared.pan:t.pan=1,o.hasRotate&&!isNaN(t.rotate)&&isFinite(o.compared.rotate)?t.rotate=(n+l.compared.rotate*t.rotate)/o.compared.rotate:t.rotate=1,s&&!isNaN(t.zoom)&&isFinite(l.compared.targetZoom)){const{sourceZoom:e,targetZoom:i}=l.compared,n=t.zoom*(i-e)+e,o=this.segments[0].definition.compared.sourceZoom,s=this.segments[this.segments.length-1].definition.compared.targetZoom,a=Math.abs(i-o)>Math.abs(e-o)?i:e;t.zoomOffset=a-s,t.zoom=(n-o)/(a-o)}else t.zoom=1;return t}e-=r.time,i+=l.compared.pan,n+=l.compared.rotate}}segmentInterpolateComponentsAt(e,t,i){e.interpolateComponentsAt(t,i)}};class $o{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,t=e.compared,i=t.sourceZoom,n=t.targetZoom;this._zoomSign=i>n?1:-1,this._panPixelsAtSource=t.pan*e.source.pixelsPerPanAtZoom(i);const o=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=t.rotate*o}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,t=this.definition.compared.targetZoom,{hasZoom:i,hasPan:n,hasRotate:o}=this.definition;let s=0,a=0;i&&(n&&(s=(t/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),o&&(a=this._zoomSign*(Math.log(e/t)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const r=this.definition.desiredPixelFlow;if(i&&n&&o){const e=s+a+s*a;this._zoomPixelFlow=s*a/e*r,this._panPixelFlow=a/e*r,this._rotatePixelFlow=s/e*r}else if(i&&n){const e=1+s;this._zoomPixelFlow=s/e*r,this._panPixelFlow=1/e*r}else if(i&&o){const e=1+a;this._zoomPixelFlow=a/e*r,this._rotatePixelFlow=1/e*r}else if(n&&o){const e=this._panPixelsAtSource/this._rotatePixels,t=1+e;this._panPixelFlow=e/t*r,this._rotatePixelFlow=1/t*r}else n?this._panPixelFlow=r:i?this._zoomPixelFlow=r:o&&(this._rotatePixelFlow=r);if(this._time=(0,Un.Kp)(Math.max(this.rotateTime,this.zoomTime,this.panTime)),this.fovTime>this._time){const e=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=e,this._panPixelFlow/=e,this._rotatePixelFlow/=e}}get rotateTime(){return this.definition.hasRotate?(0,Un.Kp)(this._rotatePixels/this._rotatePixelFlow):(0,Un.Kp)(0)}get zoomTime(){return this.definition.hasZoom?(0,Un.Kp)(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):(0,Un.Kp)(0)}get fovTime(){return this.definition.hasFov?(0,Un.Kp)(Math.abs(this.definition.compared.fov)/jo):(0,Un.Kp)(0)}get panTime(){if(!this.definition.hasPan)return(0,Un.Kp)(0);if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,t=e*this._panPixelsAtSource;return(0,Un.Kp)(Math.log(t*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow))}return(0,Un.Kp)(this._panPixelsAtSource/this._panPixelFlow)}_interpolateComponentsZoom(e){if(0===e||1===e)return e;if(this.definition.hasZoom){const t=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom;return(t*(t/i)**-e-t)/(i-t)}return e}_interpolateComponentsFov(e){if(0===e)return this.definition.segmentStart;if(1===e)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:t,segmentEnd:i}=this.definition;return t+e*(i-t)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(0===e||1===e)return e;if(this.definition.hasPan&&this.definition.hasZoom){const t=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(t*e*this._time)-1))/(t*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),t.zoom=this._interpolateComponentsZoom(e),t.pan=this._interpolateComponentsPan(e),t.rotate=this._interpolateComponentsRotate(e),t.zoomOffset=0,t.fov=this._interpolateComponentsFov(e)}}const jo=(0,Ne.kU)(45);function Ko(e,t,i){const n=t-e.compared.sourceZoom,o=e.halfWindowPanAtZoom(n);return-e.halfWindowSize*(i.ascensionFactor*Math.LN2*e.compared.pan+o)*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2*o)}function Xo(e,t,i){const n=1/t,o=Math.log(e.compared.sourceZoom*n),s=1/e.desiredPixelFlow,a=1/Math.LN2,r=t-e.compared.sourceZoom,l=1/r,h=(i.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(r))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*n*s*a*l*h-e.halfWindowSize*o*s*a*l+e.halfWindowSize*o*s*a*h/(r*r)}function Yo(e,t,i){const n=t-e.compared.sourceZoom,o=1/n,s=1/t,a=Math.log(e.compared.sourceZoom*s),r=(i.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(n))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*o*(-2*o*s*r+2*o*a+2*s-2*a*r/(n*n)-r/(t*t))/(e.desiredPixelFlow*Math.LN2)}function Jo(e,t){return-e.halfWindowSize*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2)}function Qo(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)}function es(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)}function ts(e,t,i){return e.halfWindowSize*(-e.halfWindowPanAtZoom(t)-i.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*e.halfWindowPanAtZoom(-t+e.compared.targetZoom))}function is(e,t,i){const n=Math.log(t/e.compared.targetZoom),o=1/e.desiredPixelFlow,s=1/Math.LN2,a=-t+e.compared.targetZoom,r=1/a,l=(-e.halfWindowPanAtZoom(t)-i.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return-e.halfWindowSize*n*o*s*r+e.halfWindowSize*n*o*s*l/(a*a)+e.halfWindowSize*o*s*r*l/t}function ns(e,t,i){const n=t-e.compared.targetZoom,o=1/n,s=1/t,a=Math.log(t/e.compared.targetZoom),r=(e.halfWindowPanAtZoom(t)+i.descensionFactor*Math.LN2*e.compared.pan-e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*o*(-2*o*s*r-2*o*a+2*s+2*a*r/(n*n)-r/(t*t))/(e.desiredPixelFlow*Math.LN2)}function os(e,t){return e.halfWindowSize*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2)}function ss(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)}function as(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)}function rs(e,t){let i=function(e,t){const i=Math.max(e.compared.sourceZoom,e.compared.targetZoom),n=e.source.zoomAtPixelsPerPan(e.desiredPixelFlow/e.compared.pan)/2;return n<i?null!=t.maximumDistance?i+(t.maximumDistance-i)/2:1.5*i:t.maximumDistance?Math.min(t.maximumDistance,n):n}(e,t);const n={ascensionFactor:null!=t.ascensionFactor?t.ascensionFactor:.5,descensionFactor:null!=t.descensionFactor?t.descensionFactor:.5},o=0===n.ascensionFactor,s=0===n.descensionFactor,a=o?Jo:Ko,r=o?Qo:Xo,l=o?es:Yo,h=s?os:ts,c=s?ss:is,d=s?as:ns,p=t=>a(e,t,n)+function(e,t,i){return-e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t))}(e,t,n)+h(e,t,n),u=t=>r(e,t,n)+function(e,t,i){return e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t))}(e,t,n)+c(e,t,n),g=t=>l(e,t,n)+function(e,t,i){return-2*e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t*t))}(e,t,n)+d(e,t,n);let m=p(i);const f=function(e){const t=e.compared.sourceZoom-e.compared.targetZoom;if(0===t)return e.compared.pan*e.halfWindowSize/(e.desiredPixelFlow*e.halfWindowPanAtZoom(e.compared.sourceZoom));const i=Math.LN2*e.compared.pan,n=t,o=e.halfWindowPanAtZoom(n),s=e.halfWindowSize*Math.log(e.compared.sourceZoom/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*o);return e.compared.sourceZoom<=e.compared.targetZoom?s*(i-o):s*(i+o)}(e);let _;const y=t.maximumIterations||20,v=null!=t.maximumDistance?t.maximumDistance:1/0;for(_=0;_<y;_++){const n=t.desiredSlope??1e-6;let o=u(i);Math.abs(o)>n&&(o+=n);const s=o/g(i);if(isNaN(s)||i>=v&&s<0){if(!isFinite(v))return null;i=v,m=p(i);break}if(i-=s,i<e.compared.sourceZoom||i<e.compared.targetZoom)return null;const a=p(i);if(Math.abs(a-m)/m<=.005)break;m=a}return m>.7*f||i<e.compared.sourceZoom||i<e.compared.targetZoom?null:i}class ls extends qo{constructor(e,t){super(),this._preallocSegments=[new $o,new $o,new $o],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,t)}update(e,t){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const i=t?.apex?rs(e,t.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,i?this._updateWithApex(i,t?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,t,i){e.interpolateComponentsAt(t,i),e===this._ascensionSegment?i.zoom=go(i.zoom):e===this._descensionSegment&&(i.zoom=uo(i.zoom))}_updateWithApex(e,t){const[i,n,o]=this._preallocSegments,s=t?.ascensionFactor??.5,a=Math.min(1-s,null!=t?.ascensionFactor&&null!=t.descensionFactor?t.descensionFactor:.5),r=1-s-a;i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*s,i.definition.compared.rotate=this.definition.compared.rotate*s,i.definition.segmentEnd=s,i.update(),this._ascensionSegment=i,this.segments.push(i),r>0&&(n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.copyFrom(this.definition),n.definition.compared.sourceZoom=e,n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*r,n.definition.compared.rotate=this.definition.compared.rotate*r,n.definition.segmentStart=i.definition.segmentEnd,n.definition.segmentEnd=i.definition.segmentEnd+r,n.update(),this.segments.push(n)),o.definition?o.definition.copyFrom(this.definition):o.definition=this.definition.clone(),o.definition.compared.sourceZoom=e,o.definition.compared.pan=this.definition.compared.pan*a,o.definition.compared.rotate=this.definition.compared.rotate*a,o.definition.segmentStart=s+r,o.update(),this._descensionSegment=o,this.segments.push(o)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}}const hs=new class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}};let cs=class{get time(){return this._time}get isLinear(){return 1===this.path.segments.length}constructor(e){this._time=(0,Un.l5)(0),this._easing=Ro,this.definition=new Bo(e),this.path=new ls}update(e,t,i){this.definition.update(e,t,i),this.path.update(this.definition,i),this._time=this._applyTimeSettings((0,Un.gr)(isFinite(this.path.time)?this.path.time:(0,Un.Kp)(0)),i),this._easing=i.easing??(this._time>=1e3?Ro:To)}cameraAt(e,t){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const i=this.path.interpolateComponentsAt(e,hs);t.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(e){const t=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(e,this._time)-t)/(i-t)}_applyTimeSettings(e,t){const i=null!=t.speedFactor?t.speedFactor:1,n=t.minDuration??Wo.minDuration/i,o=t.maxDuration??Wo.maxDuration/i;return null!=t.duration?(0,Un.l5)(t.duration):(0,Un.l5)(Math.min(Math.max(e/i,n),o))}};class ds{constructor(e){this._view=e,this._animation=new cs((()=>new co(this._view))),this._current=new co(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,oi.C)(this._current.viewpoint,e),(0,oi.C)(this._source.viewpoint,e),(0,oi.C)(this._target.viewpoint,t),this._animation.update(this._source,this._target,i)}applyRatio(e,t){this._animation.cameraAt(t,this._current),(0,oi.C)(e,this._current.viewpoint)}}let ps=class extends Z.A{constructor(e){super(e),this._animation=null,this._destinationViewState=new Ti,this.updateFunction=null,this.easing=Ho.ease,this.viewpoint=new l.A({targetGeometry:new mi.A,scale:0,rotation:0}),this._updateTask=(0,P.mg)({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new ds(e.view)}destroy(){this._updateTask=(0,p.xt)(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,t,i){this.stop();const n=this.viewpoint;(0,oi.C)(n,t);const o=e.target;this._transition.update(this.viewpoint,o,{apex:{maximumDistance:Math.min(64*Math.min(t.scale,o.scale),this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i?.duration,maxDuration:"auto"===i?.animationMode?(0,Un.l5)(1/0):i?.maxDuration??Uo.maxDuration,speedFactor:i?.speedFactor,easing:("string"==typeof i?.easing?Ho[i.easing]:i?.easing)||this.easing}),"auto"===i?.animationMode&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=o,function(e,t,i,n){if(null!=t?.duration)return!0;const{time:o,isLinear:s}=e,a=t?.speedFactor||1;if(o>(t?.maxDuration??Uo.maxDuration/a))return!1;if(s){const e=1.5,t=(0,ni.vt)(),s=(0,we.tc)(...n.toScreen(t,...i.center)),r=(0,we.tc)(...i.toScreen(t,...n.center)),l=null!=r&&r.x>-1*i.size[0]&&r.x<(e+.5)*i.size[0]&&r.y>-1*i.size[1]&&r.y<(e+.5)*i.size[1],h=null!=s&&s.x>-1*n.size[0]&&s.x<(e+.5)*n.size[0]&&s.y>-1*n.size[1]&&s.y<(e+.5)*n.size[1];if(o>2e3/a&&!l&&!h)return!1}return!0}(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,o,{duration:(0,Un.l5)(0)}));const s=()=>{this.animation===e&&this._updateTask&&("finished"===e.state&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const i=new Zi({target:e.clone()}),n=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==Zi.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const e=performance.now()-this._startTime,t=this._transition.duration,i=t>0?e/t:1,n=i>=1;this._transition.applyRatio(this.viewpoint,i),n&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};(0,n._)([(0,o.MZ)()],ps.prototype,"easing",void 0),(0,n._)([(0,o.MZ)()],ps.prototype,"view",void 0),(0,n._)([(0,o.MZ)()],ps.prototype,"viewpoint",void 0),ps=(0,n._)([(0,r.$)("esri.views.2d.AnimationManager")],ps);const us=ps;function gs(){return Promise.all([Promise.all([i.e(34660),i.e(52413)]).then(i.bind(i,22475)),Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(84402),i.e(83494),i.e(41438),i.e(17560),i.e(98013)]).then(i.bind(i,98013))])}const ms=()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(84402),i.e(83494),i.e(88577),i.e(76717)]).then(i.bind(i,76717)))),fs=()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(79788),i.e(35039),i.e(73347),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(39729),i.e(96220),i.e(26139)]).then(i.bind(i,10294)))),_s={"base-dynamic":()=>gs().then((()=>Promise.all([i.e(7847),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(26731),i.e(3070),i.e(13824)]).then(i.bind(i,17623)))),"base-tile":ms,"bing-maps":ms,catalog:()=>gs().then((()=>Promise.all([i.e(7847),i.e(58937),i.e(56548)]).then(i.bind(i,56548)))),"catalog-dynamic-group":()=>gs().then((()=>Promise.all([i.e(7847),i.e(58937),i.e(15270)]).then(i.bind(i,15270)))),"catalog-footprint":()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(79788),i.e(35039),i.e(73347),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(39729),i.e(96220),i.e(26139),i.e(73789)]).then(i.bind(i,73789)))),csv:fs,"geo-rss":()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(79788),i.e(35039),i.e(49176),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(78628)]).then(i.bind(i,68528)))),feature:fs,geojson:fs,parquet:fs,graphics:()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(89186)]).then(i.bind(i,89186)))),group:()=>gs().then((()=>Promise.all([i.e(7847),i.e(58937),i.e(85897)]).then(i.bind(i,85897)))),imagery:()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(93092),i.e(59844),i.e(3070),i.e(14084),i.e(9092)]).then(i.bind(i,9092)))),"imagery-tile":()=>gs().then((()=>Promise.all([i.e(7847),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(93092),i.e(59844),i.e(909),i.e(14084),i.e(21761)]).then(i.bind(i,86564)))),kml:()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(79788),i.e(35039),i.e(49176),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(59844),i.e(41438),i.e(83777),i.e(23944)]).then(i.bind(i,83380)))),"knowledge-graph":()=>gs().then((()=>Promise.all([i.e(7847),i.e(58937),i.e(11825)]).then(i.bind(i,11825)))),"link-chart":()=>gs().then((()=>Promise.all([i.e(7847),i.e(58937),i.e(11825)]).then(i.bind(i,11825)))),"knowledge-graph-sublayer":fs,"map-image":()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(3070),i.e(88577),i.e(18382)]).then(i.bind(i,18382)))),"map-notes":()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(46984)]).then(i.bind(i,46984)))),media:()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(79788),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(84402),i.e(83494),i.e(82029)]).then(i.bind(i,82029)))),"ogc-feature":()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(79788),i.e(35039),i.e(73347),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(39729),i.e(96220),i.e(26139),i.e(22048)]).then(i.bind(i,22048)))),"open-street-map":ms,"oriented-imagery":fs,route:()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(21297),i.e(46640)]).then(i.bind(i,24450)))),stream:()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(79788),i.e(35039),i.e(73347),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(39729),i.e(96220),i.e(26139),i.e(99386)]).then(i.bind(i,99386)))),"subtype-group":()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(79788),i.e(35039),i.e(73347),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(39729),i.e(96220),i.e(26139),i.e(258)]).then(i.bind(i,258)))),tile:ms,"vector-tile":()=>gs().then((()=>Promise.all([i.e(7847),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(82482),i.e(26174)]).then(i.bind(i,26174)))),video:()=>gs().then((()=>Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(43018)]).then(i.bind(i,43018)))),wcs:()=>gs().then((()=>Promise.all([i.e(7847),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(93092),i.e(59844),i.e(909),i.e(14084),i.e(21761)]).then(i.bind(i,86564)))),"web-tile":ms,wfs:fs,wms:()=>gs().then((()=>Promise.all([i.e(7847),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(26731),i.e(3070),i.e(38181)]).then(i.bind(i,55604)))),wmts:()=>gs().then((()=>Promise.all([i.e(7847),i.e(98618),i.e(58937),i.e(84797),i.e(34660),i.e(36201),i.e(26731),i.e(28299)]).then(i.bind(i,40490)))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};const ys=e=>null!=_s[e.type],vs=e=>{const t=_s[e.type];if(null==t)throw function(e){const t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",i=t.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new d.A(`${i}:view-not-supported`,`${t} is not supported in 2D`)}(e);return t(e)};var ws=i(40181),Ms=i(93453),bs=(i(15302),i(96345),i(15863)),xs=i(2413),Ts=i(9835),Ss=i(18798);const As={added:[],removed:[]},ks=new Set,Ps=new Ms.A(0,0,0,0);class Zs extends X.A{constructor(e){super(),this._tiles=new Map,this._index=(0,bs.r)(9,(0,s.A)("esri-csp-restrictions")?e=>({minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||0===(0,xs.VL)(e)||0===(0,xs.uJ)(e))return[];const t=function(e,t){const i=(0,oe.Vp)(t);if(!i)return null;const[n,o]=i.valid;return e[2]>o?[(0,xs.vt)([e[0],e[1],o,e[3]]),(0,xs.vt)([n,e[1],n+e[2]-o,e[3]])]:e[0]<n?[(0,xs.vt)([n,e[1],e[2],e[3]]),(0,xs.vt)([o-(n-e[0]),e[1],o,e[3]])]:null}(e,this.tileScheme.spatialReference);return null!=t?[...new Set([...this.boundsIntersections(t[0]),...this.boundsIntersections(t[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const t={added:[],removed:[]};for(const i of e.added)if(!this.has(i)){const e=new Ts.F(this.tileScheme,i);this._tiles.set(i,e),this._index.insert(e),t.added.push(e)}for(const i of e.removed)if(this.has(i)){const e=this.get(i);this._tiles.delete(i),this._index.remove(e),t.removed.push(e)}this.tiles.length=0,this._tiles.forEach((e=>this.tiles.push(e))),(t.added.length||t.removed.length)&&this.emit("update",t)}setViewState(e){const t=this.tileScheme.getTileCoverage(e,0);if(!t)return;const{spans:i,lodInfo:n}=t,{level:o}=n;if(i.length>0)for(const{row:s,colFrom:a,colTo:r}of i)for(let e=a;e<=r;e++){const t=Ps.set(o,s,n.normalizeCol(e),n.getWorldForColumn(e)).id;if(ks.add(t),!this.has(t)){const e=new Ts.F(this.tileScheme,t);this._tiles.set(t,e),this._index.insert(e),this.tiles.push(e),As.added.push(e)}}for(let s=this.tiles.length-1;s>=0;s--){const e=this.tiles[s];ks.has(e.id)||(this._tiles.delete(e.id),this.tiles.splice(s,1),this._index.remove(e),As.removed.push(e))}(As.added.length||As.removed.length)&&this.emit("update",As),Ss.A.pool.release(t),ks.clear(),As.added.length=0,As.removed.length=0}}var Cs=i(13692),Rs=i(43295),Es=i(37363),Is=i(39356);function Vs(e,t,i,n,o,s){return a=>{if(a instanceof Is.A){if(a.layer===e)s?.();else{const t=e.allLayerViews.find((e=>e.layer===a.layer));t&&o?.(t)}n(Ls(a))}else if("layer"in a&&"element"in a);else if("subtype-sublayer"===a.type){const t=e.allLayerViews.find((e=>e.layer===a.parent));t&&i(a,t)}else{const i=e.allLayerViews.find((e=>e.layer===a));i&&t(i)}}}function Ds(e,t){if(e)if((0,ct.xZ)(e))for(const i of e)if((0,ct.xZ)(i))for(const e of i)t(e);else t(i);else t(e)}function Ls(e){const t=e.getObjectId();return t?`${e.layer?.uid??e.sourceLayer?.uid??"MapView"}/${t}`:`"MapView/${e.uid}`}function Os(e,t){let{layer:i}=e;"subtype-group"===i?.type&&i.sublayers.forEach((e=>{t(e)}))}var zs=i(30068);const Fs={flipY:!0,premultipliedAlpha:!0};function Ns(e,t){const i=function(e,t,i,n){e.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let o=null;null!=e.width&&null!=e.height?o=[e.width,e.height]:null==e.width&&null!=e.height?o=[e.height,e.height]:null!=e.width&&null==e.height?o=[e.width,e.width]:null==e.width&&null==e.height&&(o=null);const s=i[0]-(n.left+n.right),a=i[1]-(n.top+n.bottom);let r,l,h=e.area||{x:0,y:0,width:s,height:a};if(o){const e=s/a,t=o[0]/o[1];if(t>e){const e=h.width/t;h={x:h.x,y:Math.round(h.y+(h.height-e)/2),width:h.width,height:Math.round(e)}}else{const e=h.height*t;h={x:Math.round(h.x+(h.width-e)/2),y:h.y,width:Math.round(e),height:h.height}}}else o=[h.width,h.height];return o[0]>h.width?(r=Math.min(o[0]/h.width,t),l=o[0]/h.width/r):(r=1,l=o[0]/h.width),{cropArea:{x:Math.round((h.x+n.left)*r),y:Math.round((h.y+n.top)*r),width:Math.round(h.width*r),height:Math.round(h.height*r)},outputScale:l,resolutionScale:r}}(t||{},function(e,t){return Math.min(4,(0,zs.getMaximumResolutionScale)(t,Math.min(4096,e.context.parameters.maxTextureSize)))}(e.stage,e.size),e.size,e.padding),n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(!e.layers)return;const i=[];return e.layers.forEach((e=>{const n=t.find((t=>t.layer.id===e.id));n?.container&&i.push(n.container)})),i}(t,e.allLayerViews);return e.stage.takeScreenshot(i,n,e.backgroundColor,t?.rotation)}var Hs=i(53249),Gs=i(9685);const Ws="esri-component";let Us=class extends Z.A{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(Ws),t&&t.classList.remove(Ws),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?"string"==typeof e||function(e){return e&&"nodeType"in e}(e)?(this._set("widget",null),(0,S.$)(e)):(function(e){return e&&"function"==typeof e.render}(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};(0,n._)([(0,o.MZ)()],Us.prototype,"id",null),(0,n._)([(0,o.MZ)()],Us.prototype,"node",null),(0,n._)([(0,m.w)("node")],Us.prototype,"castNode",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Us.prototype,"widget",void 0),Us=(0,n._)([(0,r.$)("esri.views.ui.Component")],Us);const Bs=Us;i(11265);var qs=i(91896),$s=i(76099),js=i(38042);const Ks={left:0,top:0,bottom:0,right:0},Xs={bottom:30,top:15,right:15,left:15},Ys="esri-ui",Js={ui:Ys,corner:`${Ys}-corner`,innerContainer:`${Ys}-inner-container`,manualContainer:`${Ys}-manual-container`,cornerContainer:`${Ys}-corner-container`,topLeft:`${Ys}-top-left`,topRight:`${Ys}-top-right`,bottomLeft:`${Ys}-bottom-left`,bottomRight:`${Ys}-bottom-right`};function Qs(e){return 0===e?"0":`${e}px`}function ea(e){const t="object"==typeof e&&null!==e&&Object.getPrototypeOf(e);return null!==t&&t!==Object.prototype||!("component"in e||"index"in e||"position"in e)?null:e}function ta(e,t){let{top:i,bottom:n,left:o,right:s}=t;e.style.top=i,e.style.bottom=n,e.style.left=o,e.style.right=s}let ia=class extends X.A.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=(0,js.JK)(),this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&ta(e,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&ta(e,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([(0,u.wB)((()=>[this.view?.padding,this.container]),this._applyViewPadding,u.Vh),(0,u.wB)((()=>this.padding),this._applyUIPadding,u.Vh),(0,u.wB)((()=>[this.container,this._locale]),(e=>{let[t,i]=e;t&&t.setAttribute("lang",i)}),u.Vh),(0,js.oQ)((e=>{this._locale=e}))])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const t=this._get("container");e!==t&&(e&&(e.classList.add(Js.ui),(0,qs.hY)(e),this._attachContainers(e)),t&&(t.classList.remove(Js.ui),ta(t,{top:"",bottom:"",left:"",right:""}),t.textContent=""),this._set("container",e))}get height(){const e=this.view?.height??0;if(0===e)return e;const t=this._getViewPadding(),{top:i,bottom:n}=t;return Math.max(e-i-n,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return"number"==typeof e?{bottom:e,top:e,right:e,left:e}:{...Xs,...e}}get width(){const e=this.view?.width??0;if(0===e)return e;const t=this._getViewPadding(),{left:i,right:n}=t;return Math.max(e-i-n,0)}add(e,t){let i,n,o;if(Array.isArray(e))return void e.forEach((e=>this.add(e,t)));const s=ea(e);s&&({index:i,position:t,component:e,key:n}=s),t&&"object"==typeof t&&({index:i,key:n,position:t,internal:o}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,i,n,o)}remove(e,t){if(!e)return;if(Array.isArray(e))return e.map((e=>this.remove(e,t)));const i=this._find(e);if(i){if(this._componentMap.has(i)&&this._componentMap.get(i)?.key!==t)return;const e=this._components.indexOf(i),n=i.node.parentNode;return n?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.splice(e,1)[0]}}empty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{removeInternal:!1};if(Array.isArray(e)){for(const i of e)this.empty(i,t);return}const i=this._positionNameToContainerLookup[e??"manual"],n=Array.prototype.slice.call(i.children).map((e=>this._findByNode(e))).filter((e=>null!=e&&(!this._componentMap.get(e)?.internal||t.removeInternal)));for(const o of n)this.remove(o)}move(e,t){if(Array.isArray(e)&&e.forEach((e=>this.move(e,t))),!e)return;let i;const n=ea(e)||ea(t);if(n&&(i=n.index,t=n.position,e=n.component||e),t&&!this._isValidPosition(t))return;const o=this.remove(e);o&&this.add(o,{position:t,index:i})}find(e){if(!e)return null;const t=this._findById(e);return t&&(t.widget||t.node)}getComponents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{includeInternal:!1};return e?Array.isArray(e)?e.flatMap((e=>this._getComponentsAtPosition(e,t))):this._getComponentsAtPosition(e,t):this._components.filter((e=>t.includeInternal||!this._componentMap.get(e)?.internal)).map((e=>{let{widget:t,node:i}=e;return t??i}))}getPosition(e){for(const t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,i,n,o){e instanceof Bs||(e=new Bs({node:e}));const{widget:s}=e;null!=s&&s instanceof Z.A&&s.addHandles((0,k.hA)((()=>{queueMicrotask((()=>this.remove(e)))})),this._removeWidgetHandleKey),this._place({component:e,position:t,index:i}),this._components.push(e),this._componentMap.set(e,{key:n,internal:o})}_find(e){return e?e instanceof Bs?this._findByComponent(e):"string"==typeof e?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){return this.view?.padding??Ks}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Js.innerContainer,Js.cornerContainer);const t=document.createElement("div");t.classList.add(Js.innerContainer,Js.manualContainer);const i=document.createElement("div");i.classList.add(Js.topLeft,Js.corner),e.appendChild(i);const n=document.createElement("div");n.classList.add(Js.topRight,Js.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(Js.bottomLeft,Js.corner),e.appendChild(o);const s=document.createElement("div");s.classList.add(Js.bottomRight,Js.corner),e.appendChild(s),this._innerContainer=e,this._manualContainer=t;const a=(0,$s.V8)();this._cornerNameToContainerLookup={"top-left":i,"top-right":n,"bottom-left":o,"bottom-right":s,"top-leading":a?n:i,"top-trailing":a?i:n,"bottom-leading":a?s:o,"bottom-trailing":a?o:s},this._positionNameToContainerLookup={manual:t,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const t=e.position??"manual",{component:i,index:n}=e,o=this._positionNameToContainerLookup[t],s=null!=n&&n>-1;if(function(e){return e&&!e._started&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}(i.widget)&&i.widget.startup(),!s)return void o.appendChild(i.node);const a=Array.from(o.children);if(0===n){const{firstChild:e}=o;return void(e?e.parentNode?.insertBefore(i.node,e):o.appendChild(i.node))}if(n>=a.length)return void o.appendChild(i.node);const r=a[n];r.parentNode?.insertBefore(i.node,r)}_toPixelPosition(e){return{top:Qs(e.top),left:Qs(e.left),right:Qs(e.right),bottom:Qs(e.bottom)}}_findByComponent(e){return this._components.find((t=>t===e))??null}_findById(e){return this._components.find((t=>{let{id:i}=t;return i===e}))??null}_findByNode(e){return this._components.find((t=>{let{node:i}=t;return i===e}))??null}_getComponentsAtPosition(e,t){const i=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(i.children).map((e=>this._findByNode(e))).filter(xe.Ru).filter((e=>t.includeInternal||!this._componentMap.get(e)?.internal)).map((e=>{let{widget:t,node:i}=e;return t??i}))}};(0,n._)([(0,o.MZ)()],ia.prototype,"_locale",void 0),(0,n._)([(0,o.MZ)()],ia.prototype,"container",null),(0,n._)([(0,o.MZ)()],ia.prototype,"height",null),(0,n._)([(0,o.MZ)({value:Xs})],ia.prototype,"padding",null),(0,n._)([(0,m.w)("padding")],ia.prototype,"castPadding",null),(0,n._)([(0,o.MZ)()],ia.prototype,"view",void 0),(0,n._)([(0,o.MZ)()],ia.prototype,"width",null),ia=(0,n._)([(0,r.$)("esri.views.ui.UI")],ia);const na=ia;var oa=i(25329),sa=i(45417);const aa=new Map;function ra(e,t){return e&&"copyright"in e&&(!t||"function"==typeof e.originOf&&"user"===e.originOf("copyright"))}function la(e,t,i){i&&t&&(e.find((e=>e.layerView===t&&e.text===i))||e.push({text:i,layerView:t}))}const ha=[];let ca=class extends Z.A{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new h.A,this.view=null,this._allLayerViewsChange=e=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const t=this.view?.allLayerViews;t&&(this.addHandles(t.map((e=>(0,u.wB)((()=>[e.suspended,e.layer?.attributionVisible]),(()=>this._updateAttributionItems())))).toArray(),"suspension"),t.forEach((e=>{"esri.views.3d.layers.Tiles3DLayerView3D"===e.declaredClass&&this.addHandles(e.on("visible-geometry-changed",(()=>this._updateAttributionItems())),"visible-geometry-changed")}))),e?.removed&&e.removed.forEach((e=>{this._pendingAttributions.delete(e),this._fetchedAttributionData.delete(e)})),this._updateAttributionItems()},this.addHandles([(0,u.on)((()=>this.view?.allLayerViews),"change",(e=>this._allLayerViewsChange(e)),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),(0,u.z7)((()=>!0===this.view?.stationary),(()=>this._updateAttributionItems()))])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,t=e?.allLayerViews;if(ha.length=0,!e||!t)return void this._clear();t.forEach((t=>{if(t.suspended||!t.layer?.attributionVisible)return;const i=t.layer;if(ra(i,"user"))return void la(ha,t,i.copyright);if(i.hasAttributionData){if(this._fetchedAttributionData.has(t)){const n=this._fetchedAttributionData.get(t);return void(n?la(ha,t,this._getDynamicAttribution(n,e,i)):ra(i)&&la(ha,t,i.copyright))}return void this._fetchAttributionData(t)}const n="portalItem"in i?i.portalItem?.accessInformation:void 0;la(ha,t,n||i.copyright)}));const i=t.find((e=>"integrated-mesh-3dtiles"===e.layer?.type));if(this.view&&i){const e=function(e){return aa.get(e)}(this.view);if(e){const t=e.getAttributionText();for(let e=0;e<t.length;++e)la(ha,i,t[e])}}(function(e,t){return e.length!==t.length||e.some(((e,i)=>e.text!==t[i].text))})(this.items,ha)&&(this.items.removeAll(),this.items.addMany(ha)),ha.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await(0,N.Ke)(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const i=t.ok?this._createContributionIndex(t.value,function(e){return"bing-maps"===e.type}(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,i)}this._updateAttributionItems()}_createContributionIndex(e,t){const i=e.contributors,n={};if(!i)return n;for(let o=0;o<i.length;o++){const e=i[o],s=e.coverageAreas;if(!s)return;for(const i of s){const s=i.bbox,a=i.zoomMin-(t&&i.zoomMin?1:0),r=i.zoomMax-(t&&i.zoomMax?1:0),l=new te.A({xmin:s[1],ymin:s[0],xmax:s[3],ymax:s[2],spatialReference:ne.A.WGS84}),h={extent:(0,sa.Gh)(l),attribution:e.attribution||"",score:null!=i.score?i.score:100,id:o};for(let e=a;e<=r;e++)n[e]??=[],n[e].push(h)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(e,t,i){const{extent:n,scale:o}=t;let s=i.tileInfo?.scaleToZoom(o)??0;if(s=Math.min(e.maxKey??0,Math.round(s)),!n||null==s||s<=-1)return"";const a=e[s],r=(0,sa.Cv)(n.center.clone().normalize(),ne.A.WebMercator),l=new Set;return a?a.filter((e=>{const t=e.id,i=!l.has(t)&&r&&e.extent&&(0,Vi.qz)(e.extent,r);return i&&l.add(t),i})).sort(((e,t)=>t.score-e.score||e.objectId-t.objectId)).map((e=>e.attribution)).join(", "):""}};(0,n._)([(0,o.MZ)({readOnly:!0,type:h.A})],ca.prototype,"items",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],ca.prototype,"state",null),(0,n._)([(0,o.MZ)()],ca.prototype,"view",void 0),ca=(0,n._)([(0,r.$)("esri.widgets.Attribution.AttributionViewModel")],ca);const da=ca;var pa=i(98108),ua=i(20459),ga=i(63582),ma=i(54761);const fa="esri-attribution",_a={base:fa,poweredBy:`${fa}__powered-by`,sources:`${fa}__sources`,open:`${fa}--open`,sourcesOpen:`${fa}__sources--open`,link:`${fa}__link`};let ya=class extends oa.A{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver((e=>e.forEach((e=>{let{target:t}=e;return this._checkSourceTextOverflow(t)})))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new da}initialize(){this.addHandles((0,u.on)((()=>this.viewModel?.items),"change",(()=>this.scheduleRender())))}destroy(){this._resizeObserver?.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((e,t)=>(e.includes(t.text)||e.push(t.text),e)),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[_a.open]:this._isOpen};return(0,ma.K)("div",{bind:this,class:this.classes(_a.base,pa.D.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return(0,ma.K)("div",{class:_a.poweredBy},"Powered by"," ",(0,ma.K)("a",{class:_a.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,i=t?0:void 0,{attributionText:n}=this,o={[_a.sourcesOpen]:e,[pa.D.interactive]:t};return(0,ma.K)("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(_a.sources,o),innerHTML:n,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:i,clientWidth:n,scrollWidth:o}=e,s=o>n,a=this._attributionTextOverflowed!==s;if(this._attributionTextOverflowed=s,a&&(t=!0),this._isOpen){const e=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,e&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};(0,n._)([(0,o.MZ)()],ya.prototype,"_isOpen",void 0),(0,n._)([(0,o.MZ)()],ya.prototype,"_isInteractive",null),(0,n._)([(0,o.MZ)()],ya.prototype,"_attributionTextOverflowed",void 0),(0,n._)([(0,o.MZ)()],ya.prototype,"_prevSourceNodeHeight",void 0),(0,n._)([(0,o.MZ)({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],ya.prototype,"attributionText",null),(0,n._)([(0,o.MZ)()],ya.prototype,"icon",null),(0,n._)([(0,o.MZ)()],ya.prototype,"itemDelimiter",void 0),(0,n._)([(0,o.MZ)()],ya.prototype,"label",null),(0,n._)([(0,o.MZ)(),(0,ga.G)("esri/widgets/Attribution/t9n/Attribution")],ya.prototype,"messages",void 0),(0,n._)([(0,o.MZ)()],ya.prototype,"view",null),(0,n._)([(0,o.MZ)({type:da})],ya.prototype,"viewModel",void 0),(0,n._)([(0,ua.$)()],ya.prototype,"_toggleState",null),ya=(0,n._)([(0,r.$)("esri.widgets.Attribution")],ya);const va=ya;var wa=i(54715);var Ma=i(79535);let ba=class extends((0,Ma.A)(Z.A)){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(u.Vh)}destroy(){this.view=null}get canShowNorth(){return function(e){return e?.spatialReference?.isWebMercator||e?.spatialReference?.isGeographic||!1}(this.view)}get state(){return!this.view?.ready||"2d"===this.view.type&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&("2d"===this.view?.type?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:(0,wa.s)()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){null!=e&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this._set("orientation",{x:0,y:0,z:t})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles("2d"===e.type?(0,u.wB)((()=>e?.rotation),this._updateForRotation,u.Vh):(0,u.wB)((()=>e?.camera),this._updateForCamera,u.Vh))}_watchForView(e){this.addHandles((0,u.wB)((()=>this.view),this._updateRotationWatcher,e))}};(0,n._)([(0,o.MZ)({readOnly:!0})],ba.prototype,"canShowNorth",null),(0,n._)([(0,o.MZ)({readOnly:!0})],ba.prototype,"orientation",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],ba.prototype,"state",null),(0,n._)([(0,o.MZ)()],ba.prototype,"view",void 0),ba=(0,n._)([(0,r.$)("esri.widgets.Compass.CompassViewModel")],ba);const xa=ba,Ta="esri-compass",Sa={base:Ta,iconContainer:`${Ta}__icon-container`};var Aa=i(94126);let ka=class extends oa.A{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new xa,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=e=>({transform:`rotateZ(${e.z}deg)`})}loadDependencies(){return(0,Aa.W)({button:()=>Promise.all([i.e(49408),i.e(43285),i.e(11823)]).then(i.bind(i,43285)),icon:()=>i.e(16702).then(i.bind(i,16702))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"rotation"===this.viewModel.state?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,{messages:i}=this;return(0,ma.K)("div",{class:this.classes(Sa.base,pa.D.widget)},(0,ma.K)("calcite-button",{class:pa.D.widgetButton,disabled:"disabled"===t,kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},(0,ma.K)("div",{"aria-hidden":"true",class:Sa.iconContainer,title:i.reset},(0,ma.K)("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};(0,n._)([(0,o.MZ)()],ka.prototype,"goToOverride",null),(0,n._)([(0,o.MZ)()],ka.prototype,"icon",null),(0,n._)([(0,o.MZ)()],ka.prototype,"label",null),(0,n._)([(0,o.MZ)(),(0,ga.G)("esri/widgets/Compass/t9n/Compass")],ka.prototype,"messages",void 0),(0,n._)([(0,o.MZ)()],ka.prototype,"view",null),(0,n._)([(0,o.MZ)({type:xa})],ka.prototype,"viewModel",void 0),ka=(0,n._)([(0,r.$)("esri.widgets.Compass")],ka);const Pa=ka,Za="esri-navigation-toggle",Ca=Za,Ra=`${Za}--horizontal`;let Ea=class extends Z.A{constructor(e){super(e),this._navigationMode="pan",this.view=null}initialize(){this.addHandles((0,u.z7)((()=>this.view?.navigation?.actionMap),(()=>this._updateNavigationActionMap())))}destroy(){this.view=null}get state(){return this.view?.ready&&"3d"===this.view?.type?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._updateNavigationActionMap()}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate")}_updateNavigationActionMap(){const e=this.view?.navigation?.actionMap;if(!e)return;const t="pan"===this._navigationMode;e.dragPrimary=t?"pan":"rotate",e.dragSecondary=t?"rotate":"pan"}};(0,n._)([(0,o.MZ)({readOnly:!0})],Ea.prototype,"state",null),(0,n._)([(0,o.MZ)()],Ea.prototype,"_navigationMode",void 0),(0,n._)([(0,o.MZ)()],Ea.prototype,"view",void 0),Ea=(0,n._)([(0,r.$)("esri.widgets.NavigationToggle.NavigationToggleViewModel")],Ea);const Ia=Ea;let Va=class extends oa.A{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new Ia,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const e="pan"===this.viewModel?.navigationMode?this._rotateButton:this._panButton;(0,$s.Z6)(e),this.toggle()}}loadDependencies(){return(0,Aa.W)({button:()=>Promise.all([i.e(49408),i.e(43285),i.e(11823)]).then(i.bind(i,43285))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){"horizontal"!==e&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e="disabled"===this.viewModel?.state,t="pan"===this.viewModel?.navigationMode,i=this.messages.toggle;return(0,ma.K)("div",{class:this.classes(Ca,pa.D.widget,{[Ra]:"horizontal"===this.layout})},(0,ma.K)("calcite-button",{afterCreate:e=>{this._panButton=e},appearance:t?"outline-fill":"solid",class:pa.D.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:t?void 0:-1,title:i}),(0,ma.K)("calcite-button",{afterCreate:e=>{this._rotateButton=e},appearance:t?"solid":"outline-fill",class:pa.D.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:t?-1:void 0,title:i}))}};(0,n._)([(0,o.MZ)()],Va.prototype,"icon",null),(0,n._)([(0,o.MZ)()],Va.prototype,"label",null),(0,n._)([(0,o.MZ)({value:"vertical"})],Va.prototype,"layout",null),(0,n._)([(0,o.MZ)(),(0,ga.G)("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Va.prototype,"messages",void 0),(0,n._)([(0,o.MZ)()],Va.prototype,"view",null),(0,n._)([(0,o.MZ)({type:Ia})],Va.prototype,"viewModel",void 0),Va=(0,n._)([(0,r.$)("esri.widgets.NavigationToggle")],Va);const Da=Va;let La=class extends Z.A{get canZoomIn(){const e=this.view?.ready;if(!e)return!1;const t=this.view?.constraints?.effectiveMaxScale;return 0===t||this._scale>t}get canZoomOut(){const{view:e}=this,t=e?.ready;if(!t)return!1;const i=e.constraints?.effectiveMinScale;return 0===i||this._scale<i}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};(0,n._)([(0,o.MZ)({readOnly:!0})],La.prototype,"canZoomIn",null),(0,n._)([(0,o.MZ)({readOnly:!0})],La.prototype,"canZoomOut",null),(0,n._)([(0,o.MZ)()],La.prototype,"view",void 0),(0,n._)([(0,o.MZ)()],La.prototype,"_scale",null),La=(0,n._)([(0,r.$)("esri.widgets.Zoom.ZoomConditions2D")],La);const Oa=La;let za=class extends Z.A{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};(0,n._)([(0,o.MZ)({readOnly:!0})],za.prototype,"canZoomIn",null),(0,n._)([(0,o.MZ)({readOnly:!0})],za.prototype,"canZoomOut",null),(0,n._)([(0,o.MZ)()],za.prototype,"view",void 0),za=(0,n._)([(0,r.$)("esri.widgets.Zoom.ZoomConditions3D")],za);const Fa=za;let Na=class extends Z.A{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return null!=this._zoomConditions&&this._zoomConditions.canZoomIn}get canZoomOut(){return null!=this._zoomConditions&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?"2d"===e.type?this._zoomConditions=new Oa({view:e}):"3d"===e.type&&(this._zoomConditions=new Fa({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&("2d"===e.type?e.mapViewNavigation.zoomIn():(0,H.QZ)(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&("2d"===e.type?e.mapViewNavigation.zoomOut():(0,H.QZ)(e.goTo({zoomFactor:.5})))}};(0,n._)([(0,o.MZ)()],Na.prototype,"_zoomConditions",void 0),(0,n._)([(0,o.MZ)()],Na.prototype,"canZoomIn",null),(0,n._)([(0,o.MZ)()],Na.prototype,"canZoomOut",null),(0,n._)([(0,o.MZ)({readOnly:!0})],Na.prototype,"state",null),(0,n._)([(0,o.MZ)()],Na.prototype,"view",null),Na=(0,n._)([(0,r.$)("esri.widgets.Zoom.ZoomViewModel")],Na);const Ha=Na,Ga="esri-zoom",Wa="esri-zoom--horizontal";let Ua=class extends oa.A{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new Ha,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return(0,Aa.W)({button:()=>Promise.all([i.e(49408),i.e(43285),i.e(11823)]).then(i.bind(i,43285))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){"horizontal"!==e&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[Wa]:"horizontal"===this.layout},{canZoomIn:t,canZoomOut:i}=this.viewModel,{zoomIn:n,zoomOut:o}=this.messages;return(0,ma.K)("div",{class:this.classes(Ga,pa.D.widget,e)},(0,ma.K)("calcite-button",{class:pa.D.widgetButton,disabled:!t,iconStart:"plus",kind:"neutral",label:n,onclick:this.zoomIn,title:n}),(0,ma.K)("calcite-button",{class:pa.D.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:o,onclick:this.zoomOut,title:o}))}};(0,n._)([(0,o.MZ)()],Ua.prototype,"icon",null),(0,n._)([(0,o.MZ)()],Ua.prototype,"label",null),(0,n._)([(0,o.MZ)({value:"vertical"})],Ua.prototype,"layout",null),(0,n._)([(0,o.MZ)(),(0,ga.G)("esri/widgets/Zoom/t9n/Zoom")],Ua.prototype,"messages",void 0),(0,n._)([(0,o.MZ)()],Ua.prototype,"view",null),(0,n._)([(0,o.MZ)({type:Ha})],Ua.prototype,"viewModel",void 0),Ua=(0,n._)([(0,r.$)("esri.widgets.Zoom")],Ua);const Ba=Ua;let qa=class extends na{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach((t=>{const i=this._find(t),n=i?.widget;(function(e){return void 0!==e?.view})(n)&&(n.view=e)}))},this._componentsWatcher=(e,t)=>{this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([(0,u.wB)((()=>this.components),this._componentsWatcher,u.Vh),(0,u.wB)((()=>this.view),this._updateViewAwareWidgets,u.Vh)])}_add(e,t,i,n,o){let s=e;if("string"==typeof e&&this._defaultPositionLookup[e]){if(this._find(e))return;s=this._createComponent(e)}super._add(s,t,i,n,o)}_removeComponents(e){e.forEach((e=>{const t=this._find(e);t&&(this.remove(t),t.destroy())}))}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(e){this.constructed&&e.forEach((e=>this.add(this._createComponent(e),this._defaultPositionLookup[e])))}_createComponent(e){const t=this._createWidget(e);return new Bs({id:e,node:t})}_createWidget(e){const t=this.view;switch(e){case"attribution":return new va({view:t});case"compass":return new Pa({view:t});case"navigation-toggle":return new Da({view:t});case"zoom":return new Ba({view:t})}}};(0,n._)([(0,o.MZ)()],qa.prototype,"components",void 0),qa=(0,n._)([(0,r.$)("esri.views.ui.DefaultUI")],qa);const $a=qa;let ja=class extends $a{constructor(e){super(e),this.components=["attribution","zoom"]}};(0,n._)([(0,o.MZ)()],ja.prototype,"components",void 0),ja=(0,n._)([(0,r.$)("esri.views.ui.2d.DefaultUI2D")],ja);const Ka=ja;var Xa=i(42052),Ya=i(9409);let Ja,Qa,er,tr,ir,nr,or;let sr=class extends(lo(T(B(F(ei))))){constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new c.A({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new Ft({actionMap:new Dt({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.floors=new h.A,this.grid=null,this.map=null,this.spatialReferenceLocked=!1,this.timeline=new Hs.K,this.type="2d",this.view2dType=null,this.ui=new Ka,this.test={takeScreenshot:async e=>async function(e,t){const i=await Ns(e,t);return(0,zs.encodeData)(i,Fs)}(this._getScreenshotView(e),e)},this.padding={top:0,right:0,bottom:0,left:0},(0,g.n_)()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=(0,p.pR)(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new Zs(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,t=this.spatialReference;return{lods:e?.spatialReference?.equals(t)?e.lods:null,spatialReference:t}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:t,center:i,viewpoint:n,extent:o}=this;let s=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!o&&(t?.effectiveLODs||(s=-1),(!i||0===e&&-1===s)&&(null==n?.targetGeometry||"extent"!==n.targetGeometry.type&&!n.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const t=e.targetGeometry,i=this.spatialReference;return(0,y.isLoadedOrLoadFor)(t.spatialReference,i)}get background(){return(0,Xa.r)(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get highlightOptions(){return(0,Es.a)(this)}set highlightOptions(e){(0,Es.o)(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resolution(){return this.stateManager.resolution??0}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||null===this.magnifier.position||!this._magnifierView?.updatingHandles.updating),t=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||!0===this.layerViewManager.updating||!0===this.labelManager.updating||!0===this.graphicsView.updating||this.allLayerViews.some((e=>!e.destroyed&&!("layerViews"in e)&&!0===e.updating))||e);if((0,s.A)("esri-2d-log-updating")){const i=this.allLayerViews.reduce(((e,t)=>({...e,[`${t.layer.id}(${t.layer.type})`]:!t.destroyed&&!("layerViews"in t)&&t.updating})),{});console.log(`Updating MapView: ${t}\n-> Null LayerViewManager: ${!this.layerViewManager}\n-> Null LabelManager: ${!this.labelManager}\n-> Null GraphicsView: ${!this.graphicsView}\n-> layerViewManager.updating: ${this.layerViewManager?.updating}\n-> labelManager.updating: ${this.labelManager?.updating}\n-> graphicsView.updating: ${this.graphicsView?.updating}\n-> allLayerViews: ${JSON.stringify(i)}\n-> updatingMagnifier: ${e}\n`)}return t}get visibleArea(){const e=this.stateManager.visibleArea;return e?new _.A({rings:[e.map((e=>[e[0],e[1]]))],spatialReference:this.spatialReference}):e}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(e,t){return async function(e,t,i){const n=(0,dt.FV)(t)?(0,dt.xB)(e,t):t;if(!e.ready||isNaN(n.x)||isNaN(n.y))return{screenPoint:n,results:[]};let o=new Set;const s=new Set;let a=!1,r=null,l=null;i?.include?Ds(i.include,Vs(e,(e=>{o.add(e),Os(e,(e=>s.add(e)))}),((e,t)=>{s.add(e),o.add(t)}),(e=>{r||(r=new Set),r.add(e)}),(e=>o.add(e)),(()=>a=!0))):(a=!0,o=new Set(e.allLayerViews),o.forEach((e=>{Os(e,(e=>s.add(e)))}))),i?.exclude&&Ds(i.exclude,Vs(e,(e=>{o.delete(e),Os(e,(e=>s.delete(e)))}),(e=>s.delete(e)),(e=>{l||(l=new Set),l.add(e)})));const h=e.toMap(n),c=e.allLayerViews.filter((t=>!t.suspended&&o.has(t)&&t.clips.every((t=>(0,Rs.O)(e,t,n,h))))).reverse();let d=[...a?e.graphicsView.hitTest(h).map((e=>({type:"graphic",graphic:e,layer:null,mapPoint:h}))):[],...await Promise.all(c.map((e=>e.hitTest(h,n))).toArray())].filter(xe.Ru).flat().filter(xe.Ru);return d=d.filter((e=>"graphic"!==e.type||"subtype-group"!==e.layer?.type||s.has(e.graphic.layer))),r&&(d=d.filter((e=>!("graphic"in e)||!e.graphic||r?.has(Ls(e.graphic))))),l&&(d=d.filter((e=>!("graphic"in e)||!e.graphic||!l?.has(Ls(e.graphic))))),{screenPoint:n,results:d}}(this,e,t)}async takeScreenshot(e){return async function(e,t){const i=await Ns(e,t),{format:n,quality:o}=(0,zs.getFormatAndQuality)(t?.format,t?.quality);return(0,zs.encode)(i,{format:n,quality:o},Fs)}(this._getScreenshotView(e),e)}toMap(e){if(!this.ready)return null;const t=(0,dt.FV)(e)?(0,dt.xB)(this,e):e;return this.stateManager.toMap(t)}toScreen(e,t){return this.stateManager.toScreen(e,t)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise((e=>{this.ready?e(this):this._resolveWhenReady.push(e)}))}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return(0,Xa.r)(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return(0,Xa.r)(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(e){return ys(e)}importLayerView(e){return vs(e)}pixelSizeAt(){return this.ready?this.resolution:(a.A.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const t=this.toMap(e),i=await this.hitTest(e),n=this.allLayerViews.toArray().filter((i=>i.clips.every((i=>(0,Rs.O)(this,i,e,t))))).reverse(),o=new globalThis.Map(n.map((e=>[e.layer.uid,e]))),s=[];let a=0,r=0;for(;a<i.results.length||r<n.length;){const e=i.results.at(a);if(e&&"graphic"!==e.type){++a;continue}const l=o.get((e?.layer??e?.graphic.layer)?.uid);if((!e||l)&&r<n.length&&n.at(r)!==l){const e=n.at(r);"fetchPopupFeaturesAtLocation"in e&&s.push({mapPoint:t,layerView:e}),++r}else e&&(s.push({graphic:e.graphic,layerView:l}),++a)}return{hits:s,location:t}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=function(e){const t=(0,Gs.C)();return t.available?"3d"===e&&t.majorPerformanceCaveat?new d.A("webgl:major-performance-caveat-detected",`Your WebGL implementation (${t.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):t.supportsHighPrecisionFragment?t.supportsVertexShaderSamplers?null:new d.A("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new d.A("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new d.A("webgl:required","WebGL2 is required but not supported.",(new Error).stack)}(this.type);if((0,s.A)("safari")&&(0,s.A)("safari")<9&&(e=new d.A("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:(0,s.A)("safari")})),null!=e)throw a.A.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return async function(){const[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:n,MapViewNavigation:o,MagnifierView2D:s,GridView2D:a,Stage:r}]=await Promise.all([Promise.all([i.e(34660),i.e(52413)]).then(i.bind(i,22475)),Promise.all([i.e(7847),i.e(97763),i.e(98618),i.e(84797),i.e(34660),i.e(36201),i.e(5169),i.e(60324),i.e(401),i.e(26731),i.e(68497),i.e(94750),i.e(86535),i.e(69679),i.e(8995),i.e(84402),i.e(83494),i.e(41438),i.e(17560),i.e(98013)]).then(i.bind(i,98013))]);Qa=e,er=t,tr=n,ir=o,nr=s,or=a,Ja=r}()}_getDefaultViewpoint(){const{constraints:e,initialExtent:t,map:i,padding:n,size:o}=this;if(!e)return null;const s=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),r=s?.viewpoint,h=r?.targetGeometry?.extent??t,c=h?.center,d=r?.rotation??0,p=r?.scale||h&&(0,oi.AU)(h,[o[0]-n.left-n.right,o[1]-n.top-n.bottom]),u=a.center??c,g=a.rotation??d,m=a.scale??p;return u&&m?new l.A({targetGeometry:u,scale:m,rotation:g}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const t=new Ja(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=t,this._magnifierView=new nr,this._magnifierView.magnifier=this.magnifier,this._gridView=new or;const i=new tr({view:this});this._set("labelManager",i);const n=new us({view:this});this._set("animationManager",n);const o=new ir({view:this,animationManager:n});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),t.on("webgl-error",(e=>this.fatalError=e.error)),(0,u.wB)((()=>this.stationary),(e=>t.stationary=e),u.pc),(0,u.wB)((()=>this.background),(e=>{t.backgroundColor=e?.color,this._magnifierView.backgroundColor=e?.color}),u.pc),(0,u.wB)((()=>this.magnifier),(e=>this._magnifierView.magnifier=e),u.pc),(0,u.wB)((()=>this.grid),(e=>this._gridView.grid=e),u.pc),(0,u.wB)((()=>this.renderingOptions),(e=>t.renderingOptions=e),u.pc),(0,u.wB)((()=>this.highlights.items.map((e=>({name:e.name,options:{fillColor:e.color,haloColor:e.haloColor,fillOpacity:e.fillOpacity,haloOpacity:e.haloOpacity,haloWidth:e.haloWidth,haloBlur:e.haloBlur}})))),(()=>{t.highlightGradient=(0,Cs.u4)(t.highlightGradient,this.highlights.items)}),u.pc),(0,u.wB)((()=>this.state.id),(()=>t.state=this.state),u.pc)],"map-view"),this._updateStageChildren();const s=this._resolveWhenReady;this._resolveWhenReady=[],s.forEach((e=>e(this))),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach((e=>{this.stage.addChild(e.container)}));const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new ws.A(v.A.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const t=new Qa({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new er(e)});this._set("graphicsView",t)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:t,padding:i,size:n,stage:o}=this;return{allLayerViews:t,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:i,size:n,stage:o}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const e of this.allLayerViews)e.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const e of this.allLayerViews)e.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};sr.type="2d",(0,n._)([(0,o.MZ)({constructOnly:!0})],sr.prototype,"deactivatedWebGLExtensions",void 0),(0,n._)([(0,o.MZ)({constructOnly:!0})],sr.prototype,"debugWebGLExtensions",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"featuresTilingScheme",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"graphicsTileStore",null),(0,n._)([(0,o.MZ)()],sr.prototype,"graphicsView",void 0),(0,n._)([(0,o.MZ)()],sr.prototype,"constraintsInfo",null),(0,n._)([(0,o.MZ)()],sr.prototype,"initialExtentRequired",null),(0,n._)([(0,o.MZ)()],sr.prototype,"labelManager",void 0),(0,n._)([(0,o.MZ)({type:Ft,nonNullable:!0})],sr.prototype,"navigation",void 0),(0,n._)([(0,o.MZ)({constructOnly:!0})],sr.prototype,"renderCanvas",void 0),(0,n._)([(0,o.MZ)()],sr.prototype,"renderingOptions",void 0),(0,n._)([(0,o.MZ)({constructOnly:!0})],sr.prototype,"supersampleScreenshotsEnabled",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"supportsGround",void 0),(0,n._)([(0,o.MZ)()],sr.prototype,"defaultsFromMapSettings",null),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"typeSpecificPreconditionsReady",null),(0,n._)([(0,o.MZ)({type:Ya.A})],sr.prototype,"background",null),(0,n._)([(0,o.MZ)()],sr.prototype,"center",null),(0,n._)([(0,o.MZ)({type:h.A})],sr.prototype,"floors",void 0),(0,n._)([(0,o.MZ)()],sr.prototype,"grid",void 0),(0,n._)([(0,o.MZ)({type:bt.A})],sr.prototype,"highlightOptions",null),(0,n._)([(0,o.MZ)()],sr.prototype,"map",void 0),(0,n._)([(0,o.MZ)()],sr.prototype,"padding",null),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"rendering",null),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"resolution",null),(0,n._)([(0,o.MZ)()],sr.prototype,"scale",null),(0,n._)([(0,o.MZ)({constructOnly:!0})],sr.prototype,"spatialReferenceLocked",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"tileInfo",null),(0,n._)([(0,o.MZ)({type:Hs.K,readOnly:!0})],sr.prototype,"timeline",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"type",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"updating",null),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"view2dType",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"visibleArea",null),(0,n._)([(0,o.MZ)()],sr.prototype,"zoom",null),(0,n._)([(0,o.MZ)({readOnly:!0})],sr.prototype,"navigating",null),(0,n._)([(0,o.MZ)(),(0,m.w)((e=>e instanceof $a?e:(0,f.PZ)(Ka,e)))],sr.prototype,"ui",void 0),sr=(0,n._)([(0,r.$)("esri.views.View2D")],sr);const ar=sr;let rr=class extends ar{constructor(e){super(e),this.view2dType="map"}};(0,n._)([(0,o.MZ)({readOnly:!0})],rr.prototype,"view2dType",void 0),rr=(0,n._)([(0,r.$)("esri.views.MapView")],rr);const lr=rr},1438:(e,t,i)=>{i.d(t,{O7:()=>A,Hr:()=>S,el:()=>T,mT:()=>k,XX:()=>w});var n=i(86560),o=i(50076),s=i(76460),a=i(65215),r=i(23701),l=i(73548),h=i(80963),c=i(45417),d=i(3825),p=i(19902),u=i(54994);var g=i(90534),m=i(71838);const f=()=>s.A.getLogger("esri.geometry.support.normalizeUtils");function _(e){return"polygon"===e[0].type}function y(e){return"polyline"===e[0].type}function v(e){const t=[];let i=0,n=0;for(let o=0;o<e.length;o++){const s=e[o];let a=null;for(let e=0;e<s.length;e++)a=s[e],t.push(a),0===e?(i=a[0],n=i):(i=Math.min(i,a[0]),n=Math.max(n,a[0]));a&&t.push([(i+n)/2,0])}return t}function w(e,t){if(!(e instanceof r.A||e instanceof a.A)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw f().error(e),new o.A(e)}const i=(0,l.r8)(e),n=[];for(const o of i){const e=[];n.push(e),e.push([o[0][0],o[0][1]]);for(let i=0;i<o.length-1;i++){const n=o[i][0],s=o[i][1],a=o[i+1][0],r=o[i+1][1],l=Math.sqrt((a-n)*(a-n)+(r-s)*(r-s)),h=(r-s)/l,c=(a-n)/l,d=l/t;if(d>1){for(let r=1;r<=d-1;r++){const i=r*t,o=c*i+n,a=h*i+s;e.push([o,a])}const i=(l+Math.floor(d-1)*t)/2,o=c*i+n,a=h*i+s;e.push([o,a])}e.push([a,r])}}return function(e){return"polygon"===e.type}(e)?new a.A({rings:n,spatialReference:e.spatialReference}):new r.A({paths:n,spatialReference:e.spatialReference})}function M(e,t,i){if(t){const t=w(e,1e6);e=(0,c.ci)(t,!0)}return i&&(e=(0,l.kS)(e,i)),e}function b(e,t,i){if(Array.isArray(e)){const n=e[0];if(n>t){const i=(0,l.kd)(n,t);e[0]=n+i*(-2*t)}else if(n<i){const t=(0,l.kd)(n,i);e[0]=n+t*(-2*i)}}else{const n=e.x;if(n>t){const i=(0,l.kd)(n,t);e=e.clone().offset(i*(-2*t),0)}else if(n<i){const t=(0,l.kd)(n,i);e=e.clone().offset(t*(-2*i),0)}}return e}function x(e,t){let i=-1;for(let n=0;n<t.cutIndexes.length;n++){const o=t.cutIndexes[n],s=t.geometries[n],a=(0,l.r8)(s);for(let e=0;e<a.length;e++){const t=a[e];t.some((i=>{if(i[0]<180)return!0;{let i=0;for(let e=0;e<t.length;e++){const n=t[e][0];i=n>i?n:i}i=Number(i.toFixed(9));const n=-360*(0,l.kd)(i,180);for(let o=0;o<t.length;o++){const t=s.getPoint(e,o);s.setPoint(e,o,t.clone().offset(n,0))}return!0}}))}if(o===i){if(_(e))for(const t of(0,l.r8)(s))e[o]=e[o].addRing(t);else if(y(e))for(const t of(0,l.r8)(s))e[o]=e[o].addPath(t)}else i=o,e[o]=s}return e}async function T(e,t,i){if(!Array.isArray(e))return T([e],t);t&&"string"!=typeof t&&f().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const o="string"==typeof t?t:t?.url??n.A.geometryServiceUrl;let s,_,y,v,w,S,A,k,P=0;const Z=[],C=[];for(const n of e)if(null!=n)if(s||(s=n.spatialReference,_=(0,h.Vp)(s),y=s.isWebMercator,S=y?102100:4326,v=l.j7[S].maxX,w=l.j7[S].minX,A=l.j7[S].plus180Line,k=l.j7[S].minus180Line),_)if("mesh"===n.type)C.push(n);else if("point"===n.type)C.push(b(n.clone(),v,w));else if("multipoint"===n.type){const e=n.clone();e.points=e.points.map((e=>b(e,v,w))),C.push(e)}else if("extent"===n.type){const e=n.clone()._normalize(!1,!1,_);C.push(e.rings?new a.A(e):e)}else if(n.extent){const e=n.extent,t=(0,l.kd)(e.xmin,w)*(2*v);let i=0===t?n.clone():(0,l.kS)(n.clone(),t);e.offset(t,0);let{xmin:o,xmax:s}=e;o=Number(o.toFixed(9)),s=Number(s.toFixed(9)),e.intersects(A)&&s!==v?(P=s>P?s:P,i=M(i,y),Z.push(i),C.push("cut")):e.intersects(k)&&o!==w?(P=s*(2*v)>P?s*(2*v):P,i=M(i,y,360),Z.push(i),C.push("cut")):C.push(i)}else C.push(n.clone());else C.push(n);else C.push(n);let R=(0,l.kd)(P,v),E=-90;const I=R,V=new r.A;for(;R>0;){const e=360*R-180;V.addPath([[e,E],[e,-1*E]]),E*=-1,R--}if(Z.length>0&&I>0){const t=x(Z,await async function(e,t,i,n){const o=(0,u.Dl)(e),s=t[0].spatialReference,a={...n,responseType:"json",query:{...o.query,f:"json",sr:(0,h.YX)(s),target:JSON.stringify({geometryType:(0,p.$B)(t[0]),geometries:t}),cutter:JSON.stringify(i)}},r=await(0,d.A)(o.path+"/cut",a),{cutIndexes:l,geometries:c=[]}=r.data;return{cutIndexes:l,geometries:c.map((e=>{const t=(0,p.rS)(e);return t.spatialReference=s,t}))}}(o,Z,V,i)),n=[],s=[];for(let i=0;i<C.length;i++){const o=C[i];if("cut"!==o)s.push(o);else{const o=t.shift(),a=e[i];null!=a&&"polygon"===a.type&&a.rings&&a.rings.length>1&&o.rings.length>=a.rings.length?(n.push(o),s.push("simplify")):s.push(y?(0,c.Gh)(o):o)}}if(!n.length)return s;const a=await async function(e,t,i){const n="string"==typeof e?(0,g.An)(e):e,o=t[0].spatialReference,s=(0,p.$B)(t[0]),a={...i,query:{...n.query,f:"json",sr:(0,h.YX)(o),geometries:JSON.stringify((0,m.X)(t))}},{data:r}=await(0,d.A)(n.path+"/simplify",a);return(0,m.V)(r.geometries,s,o)}(o,n,i),r=[];for(let e=0;e<s.length;e++){const t=s[e];"simplify"!==t?r.push(t):r.push(y?(0,c.Gh)(a.shift()):a.shift())}return r}const D=[];for(let n=0;n<C.length;n++){const e=C[n];if("cut"!==e)D.push(e);else{const e=Z.shift();D.push(!0===y?(0,c.Gh)(e):e)}}return D}function S(e){if(!e)return null;const t=e.extent;if(!t)return null;const i=e.spatialReference&&(0,h.Vp)(e.spatialReference);if(!i)return t;const[n,o]=i.valid,s=2*o,{width:a}=t;let r,{xmin:l,xmax:c}=t;if([l,c]=[c,l],"extent"===e.type||0===a||a<=o||a>s||l<n||c>o)return t;switch(e.type){case"polygon":if(!(e.rings.length>1))return t;r=v(e.rings);break;case"polyline":if(!(e.paths.length>1))return t;r=v(e.paths);break;case"multipoint":r=e.points}const d=t.clone();for(let h=0;h<r.length;h++){let e=r[h][0];e<0?(e+=o,c=Math.max(e,c)):(e-=o,l=Math.min(e,l))}return d.xmin=l,d.xmax=c,d.width<a?(d.xmin-=o,d.xmax-=o,d):t}function A(e,t,i){const n=(0,h.Vp)(i);if(null==n)return e;const[o,s]=n.valid,a=2*s;let r=0,l=0;t>s?r=Math.ceil(Math.abs(t-s)/a):t<o&&(r=-Math.ceil(Math.abs(t-o)/a)),e>s?l=Math.ceil(Math.abs(e-s)/a):e<o&&(l=-Math.ceil(Math.abs(e-o)/a));let c=e+(r-l)*a;const d=c-t;return d>s?c-=a:d<o&&(c+=a),c}function k(e,t){const i=(0,h.Vp)(t);if(i){const[t,n]=i.valid,o=n-t;if(e<t)for(;e<t;)e+=o;if(e>n)for(;e>n;)e-=o}return e}},1723:(e,t,i)=>{i.d(t,{Ps:()=>l,Tv:()=>d,Zs:()=>s,cD:()=>c,d2:()=>h,fT:()=>o,lH:()=>u,mA:()=>a,n4:()=>p,xc:()=>r});var n=i(69539);const o=new n.A("cyan"),s=1,a=.25,r=new n.A("black"),l=.4,h=.2,c=.25,d="default",p="temporary",u=new n.A("yellow")},9685:(e,t,i)=>{i.d(t,{C:()=>s});var n=i(78614);let o;function s(){return o??=function(){const e=new a,t=function(e){if("undefined"==typeof WebGL2RenderingContext)return null;const t=document.createElement("canvas");if(!t)return null;let i=t.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(null==i&&(i=t.getContext("webgl2"),null!=i&&(e.majorPerformanceCaveat=!0)),null==i)return i;e.available=!0,e.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),e.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const n=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return n&&(e.supportsHighPrecisionFragment=n.precision>0),i}(e);return null==t||(e.supportsColorBufferFloat=null!==t.getExtension("EXT_color_buffer_float"),e.supportsColorBufferFloatBlend=null!==t.getExtension("EXT_float_blend"),e.supportsColorBufferHalfFloat=e.supportsColorBufferFloat||null!==t.getExtension("EXT_color_buffer_half_float"),e.unmaskedRenderer=(0,n.Z)(t,{debugRendererInfo:!0})?.getUnmaskedRendererWebGL()??"unknown"),e}(),o}class a{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}}},13692:(e,t,i)=>{i.d(t,{H_:()=>M,u4:()=>b,Oq:()=>T,lB:()=>x,eh:()=>w});var n=i(18690),o=i(94643),s=i(45802),a=i(85632),r=i(76460),l=i(5095),h=i(45180),c=i(30363),d=i(93345),p=i(80895),u=i(96673);const g=()=>r.A.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");const m=[0,0,0,0];class f{constructor(){this.type="single",this._highlightOptions=new c.A,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*h.Ci),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,t){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,l.CR),t.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<l.U5)-1,activeGradient:this}]}_updateGradientTexture(e){const t=function(e){return`${e.color};${e.haloColor};${e.haloOpacity};${e.fillOpacity};${e.haloWidth};${e.haloBlur}`}(this._highlightOptions);if(t===this._optionsShadeTexKey)return;this._optionsShadeTexKey=t,function(e,t){t.fillColor[0]=e.color.r/255,t.fillColor[1]=e.color.g/255,t.fillColor[2]=e.color.b/255,t.fillColor[3]=e.color.a,e.haloColor?(t.outlineColor[0]=e.haloColor.r/255,t.outlineColor[1]=e.haloColor.g/255,t.outlineColor[2]=e.haloColor.b/255,t.outlineColor[3]=e.haloColor.a):(t.outlineColor[0]=t.fillColor[0],t.outlineColor[1]=t.fillColor[1],t.outlineColor[2]=t.fillColor[2],t.outlineColor[3]=t.fillColor[3]),t.fillColor[3]*=e.fillOpacity,t.outlineColor[3]*=e.haloOpacity,t.fillColor[0]*=t.fillColor[3],t.fillColor[1]*=t.fillColor[3],t.fillColor[2]*=t.fillColor[3],t.outlineColor[0]*=t.outlineColor[3],t.outlineColor[1]*=t.outlineColor[3],t.outlineColor[2]*=t.outlineColor[3],t.outlineWidth=(1-e.haloBlur)*e.haloWidth,t.outerHaloWidth=e.haloBlur*e.haloWidth/2,t.innerHaloWidth=e.haloBlur*e.haloWidth/2,t.outlinePosition=0}(this._highlightOptions,this._convertedHighlightOptions);const i=this._convertedHighlightOptions,n=i.outlinePosition-i.outlineWidth/2-i.outerHaloWidth,o=i.outlinePosition-i.outlineWidth/2,s=i.outlinePosition+i.outlineWidth/2,a=i.outlinePosition+i.outlineWidth/2+i.innerHaloWidth,r=Math.sqrt(Math.PI/2)*h.aY,l=Math.abs(n)>r?Math.round(10*(Math.abs(n)-r))/10:0,c=Math.abs(a)>r?Math.round(10*(Math.abs(a)-r))/10:0;let f;l&&!c?g().error("The outer rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!l&&c?g().error("The inner rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):l&&c&&g().error("The highlight is "+Math.max(l,c)+"px away from the edge of the feature; consider reducing some width values.");const _=[void 0,void 0,void 0,void 0];function y(e,t,i){_[0]=(1-i)*e[0]+i*t[0],_[1]=(1-i)*e[1]+i*t[1],_[2]=(1-i)*e[2]+i*t[2],_[3]=(1-i)*e[3]+i*t[3]}const{_texelData:v}=this;for(let d=0;d<h.Ci;++d)f=n+d/(h.Ci-1)*(a-n),f<n?(_[0]=0,_[1]=0,_[2]=0,_[3]=0):f<o?y(m,i.outlineColor,(f-n)/(o-n)):f<s?[_[0],_[1],_[2],_[3]]=i.outlineColor:f<a?y(i.outlineColor,i.fillColor,(f-s)/(a-s)):[_[0],_[1],_[2],_[3]]=i.fillColor,v[4*d]=255*_[0],v[4*d+1]=255*_[1],v[4*d+2]=255*_[2],v[4*d+3]=255*_[3];if(this._minMaxDistance[0]=n,this._minMaxDistance[1]=a,!this._shadeTex){const t=new u.R;t.wrapMode=d.pF.CLAMP_TO_EDGE,t.width=h.Ci,t.height=1,this._shadeTex=new p.g(e,t)}this._shadeTex.updateData(0,0,0,h.Ci,1,this._texelData)}}class _{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let t=0;t<e.length;t++)this.gradients[t]||(this.gradients[t]=new f),this.gradients[t].setHighlightOptions(e[t]);for(let t=e.length+1;t<this.gradients.length;t++)this.gradients[t].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const t=[];for(let i=0;i<this.gradients.length;i++){const n=this.gradients[i];t.push({activeReasons:e,activeGradient:n}),e<<=1}return t}}var y=i(63584);const v=new s.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function w(e){return v.toJSON(e)}function M(e){const{bandCount:t,attributeTable:i,colormap:n,pixelType:o}=e.raster.rasterInfo;return 1===t&&(null!=i||null!=n||"u8"===o||"s8"===o)}function b(e,t){return null==t?(e?.destroy(),null):("single"===e?.type&&Array.isArray(t)&&(e.destroy(),e=null),"multi"!==e?.type||Array.isArray(t)||(e.destroy(),e=null),e||(e=Array.isArray(t)?new _:new f),Array.isArray(t)?"multi"===e.type&&e.setHighlightOptions(t):"single"===e.type&&e.setHighlightOptions(t),e)}function x(e,t,i,n){const{painter:o,highlightGradient:s}=e,{highlight:a}=o.effects;if(!s)return;const r=e.passOptions,l=s.getReasonsWithGradients();for(let h=0;h<l.length;h++){const s={...e,passOptions:{type:"highlight",activeGradient:null!=n?l[n].activeGradient:l[h].activeGradient,activeReasons:l[h].activeReasons,stepType:"burn",highlightAll:t}};if(a.bind(s),i(s),h<l.length-1){let o=0;for(let e=h+1;e<l.length;e++)o|=l[e].activeReasons;i({...e,passOptions:{type:"highlight",activeGradient:null!=n?l[n].activeGradient:l[h].activeGradient,activeReasons:o,stepType:"clear",highlightAll:t}})}const r={...e,passOptions:{type:"highlight",activeGradient:null!=n?l[n].activeGradient:l[h].activeGradient,activeReasons:l[h].activeReasons,stepType:"draw",highlightAll:t}};o.setPipelineState((0,y.Qu)(e)),o.updatePipelineState(e.context),a.draw(r),a.unbind()}e.passOptions=r}function T(e){if(!e)return[];let t=(0,a.DU)(e)?[e]:o.A.isCollection(e)?e.toArray():Array.isArray(e)?e:[];return t=t?.filter(n.Ru),0===(t?.length??0)?[]:t}},16770:(e,t,i)=>{i.d(t,{M5:()=>u,eV:()=>d,xR:()=>c});var n=i(3825),o=i(50076),s=i(50346),a=i(90534),r=i(59056);let l=null,h=!0;function c(e,t,i){if(!e||!t)throw new Error("Cannot construct image data without dimensions");if(h)try{return new ImageData(e,t)}catch(n){h=!1}return p(e,t,i)}function d(e,t,i,n){if(!t||!i)throw new Error("Cannot construct image data without dimensions");if(h)try{return new ImageData(e,t,i)}catch(l){h=!1}const o=p(t,i,n);return o.data.set(e,0),o}function p(e,t,i){return i||(l||(l=document.createElement("canvas"),l.width=1,l.height=1),i=l),i.getContext("2d").createImageData(e,t)}async function u(e,t){const{arrayBuffer:l,mediaType:c}=await async function(e,t){const i=(0,a.r$)(e);if(i?.isBase64)return{arrayBuffer:(0,r.M)(i.data),mediaType:i.mediaType};const o=await(0,n.A)(e,{responseType:"array-buffer",...t});return{arrayBuffer:o.data,mediaType:o.getHeader?.("Content-Type")??""}}(e,t),d="image/png"===c;if("image/gif"===c){const{isAnimatedGIF:e,parseGif:n}=await i.e(3078).then(i.bind(i,3078));if(e(l))return n(l,t)}if(d){const{isAnimatedPNG:e,parseApng:n}=await i.e(56588).then(i.bind(i,56588));if(e(l))return n(l,t)}return async function(e,t){const i=window.URL.createObjectURL(e);try{const{data:e}=await(0,n.A)(i,{...t,responseType:"image"});return e}catch(h){if(!(0,s.zf)(h))throw new o.A("invalid-image",`Could not fetch requested image at ${i}`);throw h}finally{window.URL.revokeObjectURL(i)}}(new Blob([l],{type:c}),t)}},17555:(e,t,i)=>{i.d(t,{O:()=>o});var n=i(86560);const o=()=>n.A.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches},28632:(e,t,i)=>{i.d(t,{$0:()=>j,AU:()=>S,C:()=>Z,FT:()=>H,GL:()=>z,Hn:()=>D,Ji:()=>B,RG:()=>F,UR:()=>X,WK:()=>Y,XR:()=>q,Z7:()=>R,aA:()=>te,b:()=>E,b8:()=>I,cp:()=>N,hV:()=>G,iB:()=>C,nr:()=>U,qV:()=>J,ri:()=>L,s5:()=>W,tj:()=>$,vt:()=>P});var n=i(16036),o=i(94643),s=i(15941),a=i(31633),r=i(53494),l=i(94967),h=i(99809),c=i(19555),d=i(72745),p=i(76797),u=i(89189),g=i(19247),m=i(9624),f=i(13312),_=i(1438),y=i(80963);const v=96,w=39.37,M=180/Math.PI;function b(e){return e.wkid?e:e.spatialReference||f.A.WGS84}function x(e,t){return t.type?(0,c.hZ)(e,t.x,t.y):(0,c.C)(e,t)}function T(e){return(0,a.GA)(e)}function S(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.width,o=e.height;if(0!==i){const t=(0,s.kU)(i),a=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t));n=e.width*a+e.height*r,o=e.width*r+e.height*a}const a=Math.max(1,t[0]),r=Math.max(1,t[1]);return Math.max(n/a,o/r)*function(e){return(0,y.fn)(e)?T(e)*w*v:1}(e.spatialReference)}async function A(e,t,i,n){let s,a;if(!e)return null;if(Array.isArray(e)&&!e.length)return null;if(o.A.isCollection(e)&&(e=e.toArray()),Array.isArray(e)&&e.length&&"object"==typeof e[0]){const o=e.every((e=>"attributes"in e)),s=e.some((e=>!e.geometry));let a=e;if(o&&s&&t&&t.allLayerViews){const i=new Map;for(const t of e){const e=t.layer,n=i.get(e)||[],o=t.attributes[e.objectIdField];null!=o&&n.push(o),i.set(e,n)}const n=[];i.forEach(((e,i)=>{const o=t.allLayerViews?.find((e=>e.layer.id===i.id));if(o&&"queryFeatures"in o){const t=i.createQuery();t.objectIds=e,t.returnGeometry=!0,n.push(o.queryFeatures(t))}}));const o=await Promise.all(n),s=[];for(const e of o)if(e&&e.features&&e.features.length)for(const t of e.features)null!=t.geometry&&s.push(t.geometry);a=s}for(const e of a)n=await A(e,t,i,n);return n}if(Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1])s=new g.A(e);else if(e instanceof u.A)s=e;else if("geometry"in e)if(e.geometry)s=e.geometry;else if(e.layer){const i=e.layer,n=t.allLayerViews?.find((e=>e.layer.id===i.id));if(n&&"queryFeatures"in n){const t=i.createQuery();t.objectIds=[e.attributes[i.objectIdField]],t.returnGeometry=!0;const o=await n.queryFeatures(t);s=o?.features?.[0]?.geometry}}if(null==s)return null;switch(s.type){case"point":a=new p.A({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":a=(0,_.Hr)(s);break;default:a=s.extent}if(!a)return null;(0,m.isLoaded)()||(0,m.canProjectWithoutEngine)(a.spatialReference,i)||await(0,m.load)();const r=(0,m.project)(a,i);if(!r)return null;if(n){const e=r.center,t=e.clone();t.x=(0,_.O7)(e.x,n.center.x,i),t.x!==e.x&&r.centerAt(t),n=n.union(r)}else n=r;return n}function k(e,t){const i=b(e);return(0,y.aI)(i,t)||i.imageCoordinateSystem||t.imageCoordinateSystem?e:(0,m.project)(e,t)}async function P(e,t){if(!e||!t)return new n.A({targetGeometry:new g.A,scale:0,rotation:0});let i=t.spatialReference;const{constraints:o,padding:s,viewpoint:a,size:r}=t,l=[s?r[0]-s.left-s.right:r[0],s?r[1]-s.top-s.bottom:r[1]];let h=null;e instanceof n.A?h=e:e.viewpoint?h=e.viewpoint:e.target&&"esri.Viewpoint"===e.target.declaredClass&&(h=e.target);let c=null;h?.targetGeometry?c=h.targetGeometry:e instanceof p.A?c=e:e instanceof u.A?c=await A(e,t,i):e&&(c=await A(e.center,t,i)||await A(e.target,t,i)||await A(e,t,i)),!c&&a?.targetGeometry?c=a.targetGeometry:!c&&t.extent&&(c=t.extent),i||(i=b(t.spatialReference||t.extent||c)),(0,m.isLoaded)()||(0,y.aI)(c.spatialReference,i)||(0,m.canProjectWithoutEngine)(c.spatialReference,i)||await(0,m.load)();const d=k(c,i),f="center"in d?d.center:d;!1!==t.pickClosestTarget&&"point"===f.type&&"point"===a.targetGeometry?.type&&(f.x=(0,_.O7)(f.x,a.targetGeometry.x,f.spatialReference));let v=0;h?v=h.rotation:e.hasOwnProperty("rotation")?v=e.rotation:a&&(v=a.rotation);let w=0;w=null!=h?.targetGeometry&&"point"===h.targetGeometry.type?h.scale:"scale"in e&&e.scale?e.scale:"zoom"in e&&-1!==e.zoom&&o&&o.effectiveLODs?o.zoomToScale(e.zoom):Array.isArray(c)||"point"===c.type||"extent"===c.type&&0===c.width&&0===c.height?a.scale:S(k(c.extent,i),l,v);const M=function(e){if(e&&(!Array.isArray(e)||"number"!=typeof e[0])&&("object"==typeof e||Array.isArray(e)&&"object"==typeof e[0])){if("layer"in e&&null!=e.layer?.minScale&&null!=e.layer.maxScale){const t=e.layer;return{min:t.minScale,max:t.maxScale}}if(Array.isArray(e)&&e.length&&e.every((e=>"layer"in e))){let t=0,i=0;for(const n of e){const e=n.layer;e?.minScale&&e.maxScale&&(t=e.minScale<t?e.minScale:t,i=e.maxScale>i?e.maxScale:i)}return t&&i?{min:t,max:i}:null}}}(e.target??e);M&&(M.min&&M.min<w?w=M.min:M.max&&M.max>w&&(w=M.max));let x=new n.A({targetGeometry:f,scale:w,rotation:v});return o&&(x=o.fit(x),o.constrainByGeometry(x),o.rotationEnabled||(x.rotation=a.rotation)),x}function Z(e,t){const i=e.targetGeometry,n=t.targetGeometry;return i.x=n.x,i.y=n.y,i.spatialReference=n.spatialReference,e.scale=t.scale,e.rotation=t.rotation,e}function C(e,t,i){return i?(0,c.hZ)(e,.5*(t[0]-i.right+i.left),.5*(t[1]-i.bottom+i.top)):(0,c.hs)(e,t,.5)}const R=function(){const e=(0,d.vt)();return function(t,i,n){const o=i.targetGeometry;x(e,o);const s=.5*D(i);return t.xmin=e[0]-s*n[0],t.ymin=e[1]-s*n[1],t.xmax=e[0]+s*n[0],t.ymax=e[1]+s*n[1],t.spatialReference=o.spatialReference,t}}();function E(e,t,i,n,o){return B(e,t,i.center),e.scale=S(i,n),o?.constraints?.constrain(e),e}const I=function(){const e=(0,d.vt)();return function(t,i,n){return(0,c.jb)(t,function(e,t){return(0,c.hs)(e,t,.5)}(t,i),C(e,i,n))}}(),V=function(){const e=(0,h.vt)(),t=(0,d.vt)();return function(i,n,o,s){const a=D(n),r=O(n);return(0,c.hZ)(t,a,a),(0,l.CV)(e,t),(0,l.e$)(e,e,r),(0,l.Tl)(e,e,I(t,o,s)),(0,l.Tl)(e,e,[0,s.top-s.bottom]),(0,c.hZ)(i,e[4],e[5])}}();function D(e){return e.scale*L(e.targetGeometry?.spatialReference)}function L(e){return(0,y.fn)(e)?1/(T(e)*w*v):1}function O(e){return(0,r.DF)(e.rotation)||0}const z=function(){const e=(0,d.vt)(),t=(0,d.vt)(),i=(0,d.vt)();return function(n,o,s,a,r,h){return(0,c.ze)(e,o),(0,c.hs)(t,s,.5*h),(0,c.hZ)(i,1/a*h,-1/a*h),(0,l.kN)(n,t),r&&(0,l.e$)(n,n,r),(0,l.hs)(n,n,i),(0,l.Tl)(n,n,e),n}}(),F=function(){const e=(0,d.vt)();return function(t,i,n,o){const s=D(i),a=O(i);return x(e,i.targetGeometry),z(t,e,n,s,a,o)}}(),N=function(){const e=(0,d.vt)();return function(t,i,n,o){const s=D(i);return x(e,i.targetGeometry),z(t,e,n,s,0,o)}}();function H(e){const t=(0,y.Vp)(e);return t?t.valid[1]-t.valid[0]:0}function G(e,t){return Math.round(H(e)/t)}const W=function(){const e=(0,d.vt)(),t=(0,d.vt)(),i=[0,0,0];return function(n,o,s){(0,c.Re)(e,n,o),(0,c.S8)(e,e),(0,c.Re)(t,n,s),(0,c.S8)(t,t),(0,c.$A)(i,e,t);let a=Math.acos((0,c.Om)(e,t)/((0,c.Bw)(e)*(0,c.Bw)(t)))*M;return i[2]<0&&(a=-a),isNaN(a)&&(a=0),a}}(),U=function(){const e=(0,d.vt)();return function(t,i,n,o){const s=t.targetGeometry;return Z(t,i),V(e,i,n,o),s.x+=e[0],s.y+=e[1],t}}(),B=function(e,t,i){Z(e,t);const n=e.targetGeometry;return n.x=i.x,n.y=i.y,n.spatialReference=i.spatialReference,e},q=function(){const e=(0,d.vt)();return function(t,i,n,o,s){s||(s="center"),(0,c.jb)(e,n,o),(0,c.hs)(e,e,.5);const a=e[0],r=e[1];switch(s){case"center":(0,c.hZ)(e,0,0);break;case"left":(0,c.hZ)(e,-a,0);break;case"top":(0,c.hZ)(e,0,r);break;case"right":(0,c.hZ)(e,a,0);break;case"bottom":(0,c.hZ)(e,0,-r);break;case"top-left":(0,c.hZ)(e,-a,r);break;case"bottom-left":(0,c.hZ)(e,-a,-r);break;case"top-right":(0,c.hZ)(e,a,r);break;case"bottom-right":(0,c.hZ)(e,a,-r)}return te(t,i,e),t}}();function $(e,t,i){return Z(e,t),e.rotation+=i,e}function j(e,t,i){return Z(e,t),e.rotation=i,e}const K=function(){const e=(0,d.vt)();return function(t,i,n,o,s){return Z(t,i),isNaN(n)||0===n||(Q(e,o,i,s),t.scale=i.scale*n,ee(e,e,t,s),te(t,t,(0,c.hZ)(e,e[0]-o[0],o[1]-e[1]))),t}}();function X(e,t,i){return Z(e,t),e.scale=i,e}const Y=function(){const e=(0,d.vt)();return function(t,i,n,o,s,a){return Z(t,i),isNaN(n)||0===n||(Q(e,s,i,a),t.scale=i.scale*n,t.rotation+=o,ee(e,e,t,a),te(t,t,(0,c.hZ)(e,e[0]-s[0],s[1]-e[1]))),t}}(),J=function(){const e=(0,d.vt)(),t=(0,d.vt)();return function(i,n,o,s,a,r,l){return I(t,r,l),(0,c.WQ)(e,a,t),s?Y(i,n,o,s,e,r):K(i,n,o,e,r)}}(),Q=function(){const e=(0,h.vt)();return function(t,i,n,o){return(0,c.l0)(t,i,function(e,t,i,n){return F(e,t,i,n),(0,l.B8)(e,e)}(e,n,o,1))}}(),ee=function(){const e=(0,h.vt)();return function(t,i,n,o){return(0,c.l0)(t,i,F(e,n,o,1))}}(),te=function(){const e=(0,d.vt)(),t=(0,h.vt)();return function(i,n,o){Z(i,n);const s=D(n),a=i.targetGeometry;return(0,l.$0)(t,O(n)),(0,l.hs)(t,t,(0,d.fA)(s,s)),(0,c.l0)(e,o,t),a.x+=e[0],a.y+=e[1],i}}()},30068:(e,t,i)=>{i.r(t),i.d(t,{completeUserSettings:()=>l,createEmptyImageData:()=>o.xR,encode:()=>c,encodeData:()=>d,getFormatAndQuality:()=>f,getMaximumResolutionScale:()=>_,resampleHermite:()=>y,screenshotSuperSampleSettings:()=>v,toDataUrl:()=>m,toRenderSettings:()=>h});i(81806);var n=i(15941),o=i(16770);const s=2048,a=1.5,r=8;function l(e,t){const{format:i,quality:o,rotation:s,disableDecorations:a}=e||{},r=w(e,t.padding),l=function(e,t){const i={x:0,y:0,width:t.width,height:t.height};if(e?.area){null!=e.area.x&&(i.x=Math.floor(e.area.x)),null!=e.area.y&&(i.y=Math.floor(e.area.y));const n=null!=e.area.width?Math.floor(e.area.width):null,o=null!=e.area.height?Math.floor(e.area.height):null;if(i.width=t.width-i.x,i.height=t.height-i.y,null!=n&&null!=o)i.width=Math.min(i.width,n),i.height=Math.min(i.height,o);else if(null==n&&null!=o){const e=Math.min(i.width,n);i.height=e/i.width*i.height,i.width=e}else if(null!=n&&null==o){const e=Math.min(i.height,o);i.width=e/i.height*i.width,i.height=e}}return function(e,t){const i=Math.floor(Math.max(e.x,0)),n=Math.floor(Math.max(e.y,0)),o={x:i,y:n,width:Math.floor(Math.min(e.width,t.width-i)),height:Math.floor(Math.min(e.height,t.height-n))},s=o.width/o.height,a=e.width/e.height;if(a===s)return o;if(a>s){const e=Math.floor(o.width/a),t=o.height-e;return{x:o.x,y:Math.floor(o.y+t/2),width:o.width,height:e}}const r=Math.floor(o.height*a),l=o.width-r;return{x:Math.floor(o.x+l/2),y:o.y,width:r,height:o.height}}(function(e,t){if(null==t?.width||null==t.height)return e;const i=t.width/t.height,n=e.width/e.height;if(n===i)return e;if(n<i){const t=Math.floor(e.height*i);return e.x-=(t-e.width)/2,e.width=t,e}const o=Math.floor(e.width/i);return e.y-=(o-e.height)/2,e.height=o,e}(i,e),t)}(e,{width:t.width-r.left-r.right,height:t.height-r.top-r.bottom}),{width:h,height:c}=function(e,t){if(!e)return t;const i=e.width,n=e.height;if(null!=i&&null!=n)return{width:Math.floor(i),height:Math.floor(n)};if(null==i&&null==n)return t;const o=t.width/t.height;return null==n?{width:Math.floor(i),height:Math.floor(i/o)}:{width:Math.floor(n*o),height:Math.floor(n)}}(e,l),d=M(i),p=T[d];return{format:d,quality:(0,n.qE)(null!=o?o:p,0,100),area:l,width:h,height:c,rotation:s,disableDecorations:!!a,ignoreBackground:!!e?.ignoreBackground,ignorePadding:!!e?.ignorePadding}}function h(e,t){const i=l(e,t),n=i.area,o=i.width/n.width,s=w(i,t.padding),a=s.left+s.right,r=s.top+s.bottom,h=t.width-a,c=t.height-r,d=Math.floor(h*o+a),p=Math.floor(c*o+r),u=e?.layers??[],g=i.ignoreBackground,m=i.ignorePadding;return{framebufferWidth:d,framebufferHeight:p,region:{x:Math.floor(n.x*o)+s.left,y:Math.floor(n.y*o)+s.top,width:i.width,height:i.height},format:i.format,quality:i.quality,rotation:i.rotation,pixelRatio:o,layers:u,disableDecorations:i.disableDecorations,ignoreBackground:g,ignorePadding:m,objectAndLayerIdColor:!1}}function c(e,t,i){const{ctx:n,canvas:o}=p(e,i),s=n.getImageData(0,0,e.width,e.height),a=m(o,t);return u(o),{dataUrl:a,data:s}}function d(e,t){const{ctx:i,canvas:n}=p(e,t),o=i.getImageData(0,0,e.width,e.height);return u(n),o}function p(e,t){const i=(null==g&&(g=document.createElement("canvas")),g);t.premultipliedAlpha&&function(e){const t=e.data,i=t.length;for(let n=0;n<i;n+=4){const e=t[n+3];if(255!==e&&e>0){const i=255/e;t[n]=t[n]*i,t[n+1]=t[n+1]*i,t[n+2]=t[n+2]*i}}}(e),i.width=e.width,i.height=e.height;const n=i.getContext("2d",{willReadFrequently:!0});return n.putImageData(e,0,0),t.flipY&&function(e){e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore()}(n),{ctx:n,canvas:i}}function u(e){e.width=0,e.height=0}let g=null;function m(e,t){const i=b[t.format],n=t.quality/100;return e.toDataURL(i,n)}function f(e,t){const i=M(e),o=T[i];return{format:i,quality:(0,n.qE)(null!=t?t:o,0,100)}}function _(e,t){return t/Math.max(e[0],e[1])}function y(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.width-n,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e.height-o,r=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const{data:l}=e,{width:h,height:c,data:d}=t,p=s/h,u=a/c,g=Math.ceil(p/2),m=Math.ceil(u/2),f=e.width;for(let _=0;_<c;_++)for(let e=0;e<h;e++){const t=4*(e+(r?c-_-1:_)*h);let s=0,a=0,y=0,v=0,w=0,M=0;const b=(_+.5)*u;for(let r=Math.floor(_*u);r<(_+1)*u;r++){const t=Math.abs(b-(r+.5))/m,h=(e+.5)*p,c=t*t;for(let d=Math.floor(e*p);d<(e+1)*p;d++){const e=Math.abs(h-(d+.5))/g,t=Math.sqrt(c+e*e);if(t>=1)continue;let p=2*t*t*t-3*t*t+1;const u=4*(n+d+(o+r)*f);M+=p*l[u+3],a+=p,!i&&l[u+3]<255&&(p=p*l[u+3]/255),y+=p*l[u],v+=p*l[u+1],w+=p*l[u+2],s+=p}}d[t]=y/s,d[t+1]=v/s,d[t+2]=w/s,d[t+3]=M/a}return t}function v(e,t,i){if(!t)return e;const{framebufferWidth:n,framebufferHeight:o,pixelRatio:l,region:h}=e,c=w(e,i),d=c.left+c.right,p=c.top+c.bottom,u=n-d,g=o-p,m=Math.min(r,Math.min((s-d)/u,(s-p)/g));return m<a?e:{...e,framebufferWidth:Math.round(u*m)+d,framebufferHeight:Math.round(g*m)+p,pixelRatio:l*m,resample:{region:{x:Math.round((h.x-c.left)*m)+c.left,y:Math.round((h.y-c.top)*m)+c.top,width:Math.round(h.width*m),height:Math.round(h.height*m)},width:n,height:o}}}function w(e,t){return!t||e?.ignorePadding?S:t}function M(e){switch(e){case"png":case"jpg":case"jpeg":return e;default:return x}}const b={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},x="png",T={png:100,jpg:98,jpeg:98},S={top:0,right:0,bottom:0,left:0}},30363:(e,t,i)=>{i.d(t,{A:()=>d});var n,o=i(35143),s=i(69539),a=i(91967),r=i(46053),l=(i(81806),i(76460),i(47249),i(85842)),h=i(1723);let c=n=class extends a.A{constructor(e){super(e),this.name=h.Tv,this.color=h.fT.clone(),this.haloColor=null,this.haloOpacity=h.Zs,this.fillOpacity=h.mA,this.shadowColor=h.xc.clone(),this.shadowOpacity=h.Ps,this.shadowDifference=h.d2,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(e){return this.color.equals(e.color)&&(this.haloColor||this.color).equals(e.haloColor||e.color)&&this.haloOpacity===e.haloOpacity&&this.fillOpacity===e.fillOpacity&&this.haloWidth===e.haloWidth&&this.haloBlur===e.haloBlur&&this.shadowColor.equals(e.shadowColor)&&this.shadowOpacity===e.shadowOpacity&&this.shadowDifference===e.shadowDifference}clone(){return new n({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(e){this.color=e.color.clone(),this.haloColor=e.haloColor?.clone(),this.haloOpacity=e.haloOpacity,this.fillOpacity=e.fillOpacity,this.shadowColor=e.shadowColor.clone(),this.shadowDifference=e.shadowDifference,this.shadowOpacity=e.shadowOpacity,this.haloBlur=e.haloBlur,this.haloWidth=e.haloWidth}};(0,o._)([(0,r.MZ)({type:String,constructOnly:!0,nonNullable:!0})],c.prototype,"name",void 0),(0,o._)([(0,r.MZ)({type:s.A,nonNullable:!0})],c.prototype,"color",void 0),(0,o._)([(0,r.MZ)({type:s.A})],c.prototype,"haloColor",void 0),(0,o._)([(0,r.MZ)({nonNullable:!0})],c.prototype,"haloOpacity",void 0),(0,o._)([(0,r.MZ)({nonNullable:!0})],c.prototype,"fillOpacity",void 0),(0,o._)([(0,r.MZ)({type:s.A,nonNullable:!0})],c.prototype,"shadowColor",void 0),(0,o._)([(0,r.MZ)({nonNullable:!0})],c.prototype,"shadowOpacity",void 0),(0,o._)([(0,r.MZ)({nonNullable:!0})],c.prototype,"shadowDifference",void 0),(0,o._)([(0,r.MZ)({nonNullable:!0})],c.prototype,"haloWidth",void 0),(0,o._)([(0,r.MZ)({nonNullable:!0})],c.prototype,"haloBlur",void 0),c=n=(0,o._)([(0,l.$)("esri.views.support.HighlightOptions")],c);const d=c},37363:(e,t,i)=>{i.d(t,{a:()=>s,o:()=>a});var n=i(94643),o=i(30363);function s(e){if(!e.highlights)return null;const t=e.highlights.findIndex((e=>"default"===e.name));return-1===t?null:e.highlights.items[t]}function a(e,t){if(!e.highlights){if(!t)return;e.highlights=new n.A([new o.A])}const i=e.highlights.findIndex((e=>"default"===e.name));t?e.highlights.items[i].assignFrom(t):(e.highlights.removeAt(i),0===e.highlights.length&&(e.highlights=null))}},43295:(e,t,i)=>{i.d(t,{O:()=>a,p:()=>s});var n=i(11352);const o=e=>parseFloat(e)/100;function s(e,t,i){const n="string"==typeof e.left?o(e.left)*t:e.left,s="string"==typeof e.right?o(e.right)*t:e.right,a="string"==typeof e.top?o(e.top)*i:e.top,r="string"==typeof e.bottom?o(e.bottom)*i:e.bottom,l=a;return{xmin:n,xmax:Math.max(t-s,n),ymin:l,ymax:Math.max(i-r,a)}}function a(e,t,i,o){switch(t.type){case"rect":{const{width:n,height:o}=e,{xmin:a,xmax:r,ymin:l,ymax:h}=s(t,n,o),{x:c,y:d}=i;return c>a&&c<r&&d>l&&d<h}case"path":return 0===t.path.length||!Array.isArray(t.path[0][0])||(0,n.t1)(t.path,[i.x,i.y]);case"geometry":return null==t.geometry||("polygon"===t.geometry.type?(0,n.m3)(t.geometry,o):(0,n.qz)(t.geometry,o))}}},45180:(e,t,i)=>{i.d(t,{Ci:()=>a,HQ:()=>o,XK:()=>s,aY:()=>n});const n=1,o=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a=256},47700:(e,t,i)=>{i.d(t,{Hu:()=>r,jI:()=>g,zy:()=>c});i(81806);var n,o=i(50076),s=i(91605),a=i(13096);function r(e,t,i){const a=c(e),r=t,h=l(a,r,i);if(a){const t=s.A.deriveUnitFromSR(a,e.spatialReference).heightUnit;if(!i&&t!==a.heightUnit){const e=new o.A("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${t})`,{horizontalUnit:t});return new o.A("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:a,error:e})}}if(!function(e){return"heightModelInfo"in e&&null!=e.heightModelInfo||null!=e.spatialReference||!u(e)}(e)||h===n.Unsupported)return new o.A("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:a});switch(h){case n.Units:{const e=a?.heightUnit||"unknown",t=r?.heightUnit||"unknown",i=new o.A("layerview:incompatible-height-unit",`The vertical units of the layer (${e}) must match the vertical units of the scene (${t})`,{layerUnit:e,sceneUnit:t});return new o.A("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:a,sceneHeightModelInfo:r,error:i})}case n.HeightModel:{const e=a?.heightModel||"unknown",t=r?.heightModel||"unknown",i=new o.A("layerview:incompatible-height-model",`The height model of the layer (${e}) must match the height model of the scene (${t})`,{layerHeightModel:e,sceneHeightModel:t});return new o.A("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:a,sceneHeightModelInfo:r,error:i})}case n.CRS:{const e=a?.vertCRS||"unknown",t=r?.vertCRS||"unknown",i=new o.A("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${e}) must match the vertical datum of the scene (${t})`,{layerDatum:e,sceneDatum:t});return new o.A("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:a,sceneHeightModelInfo:r,error:i})}}return null}function l(e,t,i){if(!h(e)||!h(t))return n.Unsupported;if(null==e||null==t)return n.Ok;if(!i&&e.heightUnit!==t.heightUnit)return n.Units;if(e.heightModel!==t.heightModel)return n.HeightModel;switch(e.heightModel){case"gravity-related-height":return n.Ok;case"ellipsoidal":return e.vertCRS===t.vertCRS?n.Ok:n.CRS;default:return n.Unsupported}}function h(e){return null==e||null!=e.heightModel&&null!=e.heightUnit}function c(e){if("integrated-mesh-3dtiles"===e.type)return null;const t=e.url?(0,a.qg)(e.url):void 0,i=e.spatialReference?.vcsWkid;return(null!=i||null==t||"ImageServer"!==t.serverType)&&d(e)&&e.heightModelInfo?e.heightModelInfo:u(e)?s.A.deriveUnitFromSR(f,e.spatialReference):null}function d(e){return"heightModelInfo"in e}function p(e){if("unknown"===e.type||!("capabilities"in e))return!1;switch(e.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function u(e){return p(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):m(e)}function g(e){return null!=e.layers||m(e)||p(e)||d(e)}function m(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}!function(e){e[e.Ok=0]="Ok",e[e.Units=1]="Units",e[e.HeightModel=2]="HeightModel",e[e.CRS=3]="CRS",e[e.Unsupported=4]="Unsupported"}(n||(n={}));const f=new s.A({heightModel:"gravity-related-height"})},53249:(e,t,i)=>{i.d(t,{K:()=>n});class n{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),(e=>e.includes("Brush"))(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}}},54715:(e,t,i)=>{i.d(t,{s:()=>s});var n=i(81806),o=i(91417);function s(){const e=(0,n.A)("mapview-essential-goto-duration");return null==e?e:(0,o.l5)(e)}},61196:(e,t,i)=>{function n(e,t,i,n,s){o(e,t,i||0,n||e.length-1,s||a)}function o(e,t,i,n,a){for(;n>i;){if(n-i>600){var r=n-i+1,l=t-i+1,h=Math.log(r),c=.5*Math.exp(2*h/3),d=.5*Math.sqrt(h*c*(r-c)/r)*(l-r/2<0?-1:1);o(e,t,Math.max(i,Math.floor(t-l*c/r+d)),Math.min(n,Math.floor(t+(r-l)*c/r+d)),a)}var p=e[t],u=i,g=n;for(s(e,i,t),a(e[n],p)>0&&s(e,i,n);u<g;){for(s(e,u,g),u++,g--;a(e[u],p)<0;)u++;for(;a(e[g],p)>0;)g--}0===a(e[i],p)?s(e,i,g):s(e,++g,n),g<=t&&(i=g+1),t<=g&&(n=g-1)}}function s(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function a(e,t){return e<t?-1:e>t?1:0}i.d(t,{q:()=>n})},61551:(e,t,i)=>{var n,o,s,a,r,l,h,c,d;i.d(t,{Be:()=>r,Gn:()=>s,RI:()=>h,S5:()=>o,ch:()=>c,uC:()=>d}),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT",e[e.LABEL=4]="LABEL"}(n||(n={})),function(e){e[e.NONE=0]="NONE",e[e.MAP=1]="MAP",e[e.LABEL=2]="LABEL",e[e.LABEL_ALPHA=4]="LABEL_ALPHA",e[e.HITTEST=8]="HITTEST",e[e.HIGHLIGHT=16]="HIGHLIGHT",e[e.CLIP=32]="CLIP",e[e.DEBUG=64]="DEBUG",e[e.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(o||(o={})),function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"}(s||(s={})),function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(a||(a={})),function(e){e[e.SPRITE=0]="SPRITE",e[e.GLYPH=1]="GLYPH"}(r||(r={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SIMPLE=1]="SIMPLE",e[e.DOT_DENSITY=2]="DOT_DENSITY",e[e.OUTLINE_FILL=3]="OUTLINE_FILL",e[e.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",e[e.HEATMAP=5]="HEATMAP",e[e.PIE_CHART=6]="PIE_CHART"}(l||(l={})),function(e){e[e.All=0]="All",e[e.Highlight=1]="Highlight",e[e.InsideEffect=2]="InsideEffect",e[e.OutsideEffect=3]="OutsideEffect"}(h||(h={})),function(e){e[e.BATCHING=0]="BATCHING",e[e.STRICT_ORDER=1]="STRICT_ORDER",e[e.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT"}(c||(c={})),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT"}(d||(d={}))},61619:(e,t,i)=>{function n(e,t,i,n){const o=3*e,s=3*(i-e)-o,a=1-o-s,r=3*t,l=3*(n-t)-r,h=1-r-l;function c(e){return((a*e+s)*e+o)*e}function d(e){return(3*a*e+2*s)*e+o}return function(e){return function(e){return((h*e+l)*e+r)*e}(function(e,t){let i,n,o,s,a,r;for(o=e,r=0;r<8;r++){if(s=c(o)-e,Math.abs(s)<t)return o;if(a=d(o),Math.abs(a)<1e-6)break;o-=s/a}if(i=0,n=1,o=e,o<i)return i;if(o>n)return n;for(;i<n;){if(s=c(o),Math.abs(s-e)<t)return o;e>s?i=o:n=o,o=.5*(n-i)+i}return o}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-6))}}i.d(t,{Z0:()=>o,gb:()=>n});const o={};o.ease=n(.25,.1,.25,1),o.linear=n(0,0,1,1),o.easeIn=o["ease-in"]=n(.42,0,1,1),o.easeOut=o["ease-out"]=n(0,0,.58,1),o.easeInOut=o["ease-in-out"]=n(.42,0,.58,1)},63584:(e,t,i)=>{i.d(t,{Eq:()=>p,L4:()=>c,Pr:()=>v,QA:()=>f,Qu:()=>y,dJ:()=>d,r3:()=>m,vT:()=>_});var n=i(31633),o=i(5095),s=i(61551),a=i(93345);const r={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:e=>e.stencilRef,compare:a.MT.EQUAL,mask:255,op:{fail:a.eA.KEEP,zFail:a.eA.KEEP,zPass:a.eA.REPLACE}}}},l={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},h={...r,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function c(e,t){let{pixelRatio:i,state:o,displayLevel:s,requiredLevel:a}=e;const r=1/2**(s-t.key.level),l=1/2**(a-t.key.level);return{displayMat3:o.displayMat3,displayViewMat3:o.displayViewMat3,displayViewScreenMat3:t.transforms.displayViewScreenMat3,viewMat3:o.viewMat3,tileMat3:t.transforms.tileMat3,displayZoomFactor:r,requiredZoomFactor:l,tileOffset:[t.x,t.y],currentScale:o.scale,currentZoom:s,metersPerSRUnit:(0,n.GA)(o.spatialReference),rotation:o.rotation,pixelRatio:i}}function d(e){return"highlight"===e.passOptions?.type}function p(e){return"hittest"===e.passOptions?.type}function u(e){if(!p(e))return null;const{position:t,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:o}=e.passOptions;return{position:t,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:o}}function g(e){if(!d(e))return null;const{activeReasons:t,highlightAll:i}=e.passOptions;return{activeReasons:t,highlightAll:i?1:0}}function m(e,t,i){const n={};for(const o in i)i[o]instanceof Function?n[o]=i[o](e,t):n[o]=i[o];return n}function f(e,t){const{attributeView:i,context:n}=e;return{storage:i.getUniforms(n),view:c(e,t),hittestRequest:u(e),highlight:g(e)}}function _(e){return{inside:e.selection===s.RI.InsideEffect,outside:e.selection===s.RI.OutsideEffect}}function y(e){return p(e)?l:d(e)&&"clear"===e.passOptions.stepType?h:r}function v(e){const{row:t,col:i}=e.key,n=i*o.CQ,s=t*o.CQ;return{tileOffsetFromLocalOrigin:[n%o.YV,s%o.YV],maxIntsToLocalOrigin:[Math.floor(n/o.YV),Math.floor(s/o.YV)]}}},64921:(e,t,i)=>{var n;i.d(t,{w:()=>n}),function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"}(n||(n={}))},73548:(e,t,i)=>{i.d(t,{j7:()=>a,kS:()=>l,kd:()=>r,r8:()=>h});var n=i(23701),o=i(13312),s=i(19902);const a={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new n.A({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:o.A.WebMercator}),minus180Line:new n.A({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:o.A.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new n.A({paths:[[[180,-180],[180,180]]],spatialReference:o.A.WGS84}),minus180Line:new n.A({paths:[[[-180,-180],[-180,180]]],spatialReference:o.A.WGS84})}};function r(e,t){return Math.ceil((e-t)/(2*t))}function l(e,t){const i=h(e);for(const n of i)for(const e of n)e[0]+=t;return e}function h(e){return(0,s.Bi)(e)?e.rings:e.paths}},78614:(e,t,i)=>{function n(e,t){const i=t.debugRendererInfo&&e.getExtension("WEBGL_debug_renderer_info");return i?{getUnmaskedRendererWebGL:()=>e.getParameter(i.UNMASKED_RENDERER_WEBGL)}:null}i.d(t,{Z:()=>n})},79535:(e,t,i)=>{i.d(t,{A:()=>r});var n=i(35143),o=i(30726),s=i(46053),a=(i(81806),i(76460),i(47249),i(85842));const r=e=>{let t=class extends e{constructor(){super(...arguments),this.goToOverride=null,this.view=null}callGoTo(e){const{view:t}=this;return(0,o.Lw)(t),this.goToOverride?this.goToOverride(t,e):t.goTo(e.target,e.options)}};return(0,n._)([(0,s.MZ)()],t.prototype,"goToOverride",void 0),(0,n._)([(0,s.MZ)()],t.prototype,"view",void 0),t=(0,n._)([(0,a.$)("esri.widgets.support.GoTo")],t),t}},85827:(e,t,i)=>{function n(){const e=new Float32Array(9);return e[0]=1,e[4]=1,e[8]=1,e}function o(e){const t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}i.d(t,{o8:()=>o,vt:()=>n});Object.freeze(Object.defineProperty({__proto__:null,clone:o,create:n,createView:function(e,t){return new Float32Array(e,t,9)},fromValues:function(e,t,i,n,o,s,a,r,l){const h=new Float32Array(9);return h[0]=e,h[1]=t,h[2]=i,h[3]=n,h[4]=o,h[5]=s,h[6]=a,h[7]=r,h[8]=l,h}},Symbol.toStringTag,{value:"Module"}))},91896:(e,t,i)=>{i.d(t,{fJ:()=>s,g4:()=>o,hY:()=>a});const n="calcite-mode-";function o(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"").startsWith("dark")}function s(){return`${n}${o()?"dark":"light"}`}function a(e){r(e),e.classList.add(s())}function r(e){Array.from(e.classList).forEach((t=>{t.startsWith(n)&&e.classList.remove(t)}))}}}]);
//# sourceMappingURL=59453.f870429a.chunk.js.map